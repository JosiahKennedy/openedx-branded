;(function(factory){if(typeof define==='function'&&define.amd){define('backbone.route-filter',['backbone','underscore'],factory);}else if(typeof exports==='object'){module.exports=factory(require('backbone'),require('underscore'));}else{factory(window.Backbone,window._);}})(function(Backbone,_){var extend=Backbone.Router.extend;Backbone.Router.extend=function(){var child=extend.apply(this,arguments),childProto=child.prototype,parentProto=this.prototype;_.each(['before','after'],function(filter){_.defaults(childProto[filter],parentProto[filter]);});return child;};_.extend(Backbone.Router.prototype,{route:function(route,name,callback){if(!_.isRegExp(route))route=this._routeToRegExp(route);if(_.isFunction(name)){callback=name;name='';}
if(!callback)callback=this[name];var router=this;Backbone.history.route(route,function(fragment){var args=router._extractParameters(route,fragment);runFilters(router,router.before,fragment,args,function(){if(router.execute(callback,args,name)!==false){router.trigger.apply(router,['route:'+name].concat(args));router.trigger('route',name,args);Backbone.history.trigger('route',router,name,args);runFilters(router,router.after,fragment,args,_.identity);}});});return this;}});function runFilters(router,filters,fragment,args,callback){var chain=_.filter(filters,function(callback,filter){filter=_.isRegExp(filter)?filter:router._routeToRegExp(filter);return filter.test(fragment);});run(chain,router,fragment,args,callback);}
function run(chain,router,fragment,args,callback){if(!chain.length){callback.call(router);return;}
var current=chain[0],tail=_.tail(chain),next=function(){run(tail,router,fragment,args,callback);};if(_.isString(current)){current=router[current];}
if(current.length===3){current.apply(router,[fragment,args,next]);}else{if(current.apply(router,[fragment,args])!==false){next();}}}});(function(root,factory){if(typeof define==='function'&&define.amd){define('backbone.super',['underscore','backbone'],function(_,Backbone){factory(_,Backbone);});}else if(typeof exports!=='undefined'&&typeof require==='function'){var _=require('underscore'),Backbone=require('backbone');factory(_,Backbone);}else{factory(root._,root.Backbone);}}(this,function factory(_,Backbone){Backbone.Model.extend=Backbone.Collection.extend=Backbone.Router.extend=Backbone.View.extend=function(protoProps,classProps){var child=inherits(this,protoProps,classProps);child.extend=this.extend;return child;};var unImplementedSuper=function(method){throw"Super does not implement this method: "+method;};var fnTest=/\b_super\b/;var makeWrapper=function(parentProto,name,fn){var wrapper=function(){var tmp=this._super;this._super=parentProto[name]||unImplementedSuper(name);var ret;try{ret=fn.apply(this,arguments);}finally{this._super=tmp;}
return ret;};for(var prop in fn){wrapper[prop]=fn[prop];delete fn[prop];}
return wrapper;};var ctor=function(){},inherits=function(parent,protoProps,staticProps){var child,parentProto=parent.prototype;if(protoProps&&protoProps.hasOwnProperty('constructor')){child=protoProps.constructor;}else{child=function(){return parent.apply(this,arguments);};}
_.extend(child,parent,staticProps);ctor.prototype=parentProto;child.prototype=new ctor();if(protoProps){_.extend(child.prototype,protoProps);for(var name in protoProps){if(typeof protoProps[name]=="function"&&fnTest.test(protoProps[name])){child.prototype[name]=makeWrapper(parentProto,name,protoProps[name]);}}}
if(staticProps)_.extend(child,staticProps);child.prototype.constructor=child;child.__super__=parentProto;return child;};return inherits;}));define('routers/page_router',['backbone','backbone.route-filter','backbone.super'],function(Backbone){'use strict';return Backbone.Router.extend({currentView:null,root:'/',routes:{'*path':'notFound'},before:{'*any':'clearView'},initialize:function(options){this.$el=options.$el;},start:function(){Backbone.history.start({pushState:true,root:this.root});return this;},clearView:function(){if(this.currentView){this.currentView.remove();this.currentView=null;}
return this;},notFound:function(path){alert(path+' is invalid.');}});});define('collections/paginated_collection',['backbone'],function(Backbone){'use strict';return Backbone.Collection.extend({parse:function(response){if(response.next){this.url=response.next;this.fetch({remove:false});}
return response.results;}});});(function(root,factory){if(typeof define==='function'&&define.amd){define('backbone.relational',['exports','backbone','underscore'],factory);}
else if(typeof exports!=='undefined'){factory(exports,require('backbone'),require('underscore'));}
else{factory(root,root.Backbone,root._);}}(this,function(exports,Backbone,_){"use strict";Backbone.Relational={showWarnings:true};Backbone.Semaphore={_permitsAvailable:null,_permitsUsed:0,acquire:function(){if(this._permitsAvailable&&this._permitsUsed>=this._permitsAvailable){throw new Error('Max permits acquired');}
else{this._permitsUsed++;}},release:function(){if(this._permitsUsed===0){throw new Error('All permits released');}
else{this._permitsUsed--;}},isLocked:function(){return this._permitsUsed>0;},setAvailablePermits:function(amount){if(this._permitsUsed>amount){throw new Error('Available permits cannot be less than used permits');}
this._permitsAvailable=amount;}};Backbone.BlockingQueue=function(){this._queue=[];};_.extend(Backbone.BlockingQueue.prototype,Backbone.Semaphore,{_queue:null,add:function(func){if(this.isBlocked()){this._queue.push(func);}
else{func();}},process:function(){var queue=this._queue;this._queue=[];while(queue&&queue.length){queue.shift()();}},block:function(){this.acquire();},unblock:function(){this.release();if(!this.isBlocked()){this.process();}},isBlocked:function(){return this.isLocked();}});Backbone.Relational.eventQueue=new Backbone.BlockingQueue();Backbone.Store=function(){this._collections=[];this._reverseRelations=[];this._orphanRelations=[];this._subModels=[];this._modelScopes=[exports];};_.extend(Backbone.Store.prototype,Backbone.Events,{initializeRelation:function(model,relation,options){var type=!_.isString(relation.type)?relation.type:Backbone[relation.type]||this.getObjectByName(relation.type);if(type&&type.prototype instanceof Backbone.Relation){var rel=new type(model,relation,options);}
else{Backbone.Relational.showWarnings&&typeof console!=='undefined'&&console.warn('Relation=%o; missing or invalid relation type!',relation);}},addModelScope:function(scope){this._modelScopes.push(scope);},removeModelScope:function(scope){this._modelScopes=_.without(this._modelScopes,scope);},addSubModels:function(subModelTypes,superModelType){this._subModels.push({'superModelType':superModelType,'subModels':subModelTypes});},setupSuperModel:function(modelType){_.find(this._subModels,function(subModelDef){return _.filter(subModelDef.subModels||[],function(subModelTypeName,typeValue){var subModelType=this.getObjectByName(subModelTypeName);if(modelType===subModelType){subModelDef.superModelType._subModels[typeValue]=modelType;modelType._superModel=subModelDef.superModelType;modelType._subModelTypeValue=typeValue;modelType._subModelTypeAttribute=subModelDef.superModelType.prototype.subModelTypeAttribute;return true;}},this).length;},this);},addReverseRelation:function(relation){var exists=_.any(this._reverseRelations,function(rel){return _.all(relation||[],function(val,key){return val===rel[key];});});if(!exists&&relation.model&&relation.type){this._reverseRelations.push(relation);this._addRelation(relation.model,relation);this.retroFitRelation(relation);}},addOrphanRelation:function(relation){var exists=_.any(this._orphanRelations,function(rel){return _.all(relation||[],function(val,key){return val===rel[key];});});if(!exists&&relation.model&&relation.type){this._orphanRelations.push(relation);}},processOrphanRelations:function(){_.each(this._orphanRelations.slice(0),function(rel){var relatedModel=Backbone.Relational.store.getObjectByName(rel.relatedModel);if(relatedModel){this.initializeRelation(null,rel);this._orphanRelations=_.without(this._orphanRelations,rel);}},this);},_addRelation:function(type,relation){if(!type.prototype.relations){type.prototype.relations=[];}
type.prototype.relations.push(relation);_.each(type._subModels||[],function(subModel){this._addRelation(subModel,relation);},this);},retroFitRelation:function(relation){var coll=this.getCollection(relation.model,false);coll&&coll.each(function(model){if(!(model instanceof relation.model)){return;}
var rel=new relation.type(model,relation);},this);},getCollection:function(type,create){if(type instanceof Backbone.RelationalModel){type=type.constructor;}
var rootModel=type;while(rootModel._superModel){rootModel=rootModel._superModel;}
var coll=_.find(this._collections,function(item){return item.model===rootModel;});if(!coll&&create!==false){coll=this._createCollection(rootModel);}
return coll;},getObjectByName:function(name){var parts=name.split('.'),type=null;_.find(this._modelScopes,function(scope){type=_.reduce(parts||[],function(memo,val){return memo?memo[val]:undefined;},scope);if(type&&type!==scope){return true;}},this);return type;},_createCollection:function(type){var coll;if(type instanceof Backbone.RelationalModel){type=type.constructor;}
if(type.prototype instanceof Backbone.RelationalModel){coll=new Backbone.Collection();coll.model=type;this._collections.push(coll);}
return coll;},resolveIdForItem:function(type,item){var id=_.isString(item)||_.isNumber(item)?item:null;if(id===null){if(item instanceof Backbone.RelationalModel){id=item.id;}
else if(_.isObject(item)){id=item[type.prototype.idAttribute];}}
if(!id&&id!==0){id=null;}
return id;},find:function(type,item){var id=this.resolveIdForItem(type,item),coll=this.getCollection(type);if(coll){var obj=coll.get(id);if(obj instanceof type){return obj;}}
return null;},register:function(model){var coll=this.getCollection(model);if(coll){var modelColl=model.collection;coll.add(model);model.collection=modelColl;}},checkId:function(model,id){var coll=this.getCollection(model),duplicate=coll&&coll.get(id);if(duplicate&&model!==duplicate){if(Backbone.Relational.showWarnings&&typeof console!=='undefined'){console.warn('Duplicate id! Old RelationalModel=%o, new RelationalModel=%o',duplicate,model);}
throw new Error("Cannot instantiate more than one Backbone.RelationalModel with the same id per type!");}},update:function(model){var coll=this.getCollection(model);if(!coll.contains(model)){this.register(model);}
coll._onModelEvent('change:'+model.idAttribute,model,coll);model.trigger('relational:change:id',model,coll);},unregister:function(type){var coll,models;if(type instanceof Backbone.Model){coll=this.getCollection(type);models=[type];}
else if(type instanceof Backbone.Collection){coll=this.getCollection(type.model);models=_.clone(type.models);}
else{coll=this.getCollection(type);models=_.clone(coll.models);}
_.each(models,function(model){this.stopListening(model);_.invoke(model.getRelations(),'stopListening');},this);if(_.contains(this._collections,type)){coll.reset([]);}
else{_.each(models,function(model){if(coll.get(model)){coll.remove(model);}
else{coll.trigger('relational:remove',model,coll);}},this);}},reset:function(){this.stopListening();_.each(this._collections,function(coll){this.unregister(coll);},this);this._collections=[];this._subModels=[];this._modelScopes=[exports];}});Backbone.Relational.store=new Backbone.Store();Backbone.Relation=function(instance,options,opts){this.instance=instance;options=_.isObject(options)?options:{};this.reverseRelation=_.defaults(options.reverseRelation||{},this.options.reverseRelation);this.options=_.defaults(options,this.options,Backbone.Relation.prototype.options);this.reverseRelation.type=!_.isString(this.reverseRelation.type)?this.reverseRelation.type:Backbone[this.reverseRelation.type]||Backbone.Relational.store.getObjectByName(this.reverseRelation.type);this.key=this.options.key;this.keySource=this.options.keySource||this.key;this.keyDestination=this.options.keyDestination||this.keySource||this.key;this.model=this.options.model||this.instance.constructor;this.relatedModel=this.options.relatedModel;if(_.isUndefined(this.relatedModel)){this.relatedModel=this.model;}
if(_.isFunction(this.relatedModel)&&!(this.relatedModel.prototype instanceof Backbone.RelationalModel)){this.relatedModel=_.result(this,'relatedModel');}
if(_.isString(this.relatedModel)){this.relatedModel=Backbone.Relational.store.getObjectByName(this.relatedModel);}
if(!this.checkPreconditions()){return;}
if(!this.options.isAutoRelation&&this.reverseRelation.type&&this.reverseRelation.key){Backbone.Relational.store.addReverseRelation(_.defaults({isAutoRelation:true,model:this.relatedModel,relatedModel:this.model,reverseRelation:this.options},this.reverseRelation));}
if(instance){var contentKey=this.keySource;if(contentKey!==this.key&&_.isObject(this.instance.get(this.key))){contentKey=this.key;}
this.setKeyContents(this.instance.get(contentKey));this.relatedCollection=Backbone.Relational.store.getCollection(this.relatedModel);if(this.keySource!==this.key){delete this.instance.attributes[this.keySource];}
this.instance._relations[this.key]=this;this.initialize(opts);if(this.options.autoFetch){this.instance.getAsync(this.key,_.isObject(this.options.autoFetch)?this.options.autoFetch:{});}
this.listenTo(this.instance,'destroy',this.destroy).listenTo(this.relatedCollection,'relational:add relational:change:id',this.tryAddRelated).listenTo(this.relatedCollection,'relational:remove',this.removeRelated);}};Backbone.Relation.extend=Backbone.Model.extend;_.extend(Backbone.Relation.prototype,Backbone.Events,Backbone.Semaphore,{options:{createModels:true,includeInJSON:true,isAutoRelation:false,autoFetch:false,parse:false},instance:null,key:null,keyContents:null,relatedModel:null,relatedCollection:null,reverseRelation:null,related:null,checkPreconditions:function(){var i=this.instance,k=this.key,m=this.model,rm=this.relatedModel,warn=Backbone.Relational.showWarnings&&typeof console!=='undefined';if(!m||!k||!rm){warn&&console.warn('Relation=%o: missing model, key or relatedModel (%o, %o, %o).',this,m,k,rm);return false;}
if(!(m.prototype instanceof Backbone.RelationalModel)){warn&&console.warn('Relation=%o: model does not inherit from Backbone.RelationalModel (%o).',this,i);return false;}
if(!(rm.prototype instanceof Backbone.RelationalModel)){warn&&console.warn('Relation=%o: relatedModel does not inherit from Backbone.RelationalModel (%o).',this,rm);return false;}
if(this instanceof Backbone.HasMany&&this.reverseRelation.type===Backbone.HasMany){warn&&console.warn('Relation=%o: relation is a HasMany, and the reverseRelation is HasMany as well.',this);return false;}
if(i&&_.keys(i._relations).length){var existing=_.find(i._relations,function(rel){return rel.key===k;},this);if(existing){warn&&console.warn('Cannot create relation=%o on %o for model=%o: already taken by relation=%o.',this,k,i,existing);return false;}}
return true;},setRelated:function(related){this.related=related;this.instance.attributes[this.key]=related;},_isReverseRelation:function(relation){return relation.instance instanceof this.relatedModel&&this.reverseRelation.key===relation.key&&this.key===relation.reverseRelation.key;},getReverseRelations:function(model){var reverseRelations=[];var models=!_.isUndefined(model)?[model]:this.related&&(this.related.models||[this.related]),relations=null,relation=null;for(var i=0;i<(models||[]).length;i++){relations=models[i].getRelations()||[];for(var j=0;j<relations.length;j++){relation=relations[j];if(this._isReverseRelation(relation)){reverseRelations.push(relation);}}}
return reverseRelations;},destroy:function(){this.stopListening();if(this instanceof Backbone.HasOne){this.setRelated(null);}
else if(this instanceof Backbone.HasMany){this.setRelated(this._prepareCollection());}
_.each(this.getReverseRelations(),function(relation){relation.removeRelated(this.instance);},this);}});Backbone.HasOne=Backbone.Relation.extend({options:{reverseRelation:{type:'HasMany'}},initialize:function(opts){this.listenTo(this.instance,'relational:change:'+this.key,this.onChange);var related=this.findRelated(opts);this.setRelated(related);_.each(this.getReverseRelations(),function(relation){relation.addRelated(this.instance,opts);},this);},findRelated:function(options){var related=null;options=_.defaults({parse:this.options.parse},options);if(this.keyContents instanceof this.relatedModel){related=this.keyContents;}
else if(this.keyContents||this.keyContents===0){var opts=_.defaults({create:this.options.createModels},options);related=this.relatedModel.findOrCreate(this.keyContents,opts);}
if(related){this.keyId=null;}
return related;},setKeyContents:function(keyContents){this.keyContents=keyContents;this.keyId=Backbone.Relational.store.resolveIdForItem(this.relatedModel,this.keyContents);},onChange:function(model,attr,options){if(this.isLocked()){return;}
this.acquire();options=options?_.clone(options):{};var changed=_.isUndefined(options.__related),oldRelated=changed?this.related:options.__related;if(changed){this.setKeyContents(attr);var related=this.findRelated(options);this.setRelated(related);}
if(oldRelated&&this.related!==oldRelated){_.each(this.getReverseRelations(oldRelated),function(relation){relation.removeRelated(this.instance,null,options);},this);}
_.each(this.getReverseRelations(),function(relation){relation.addRelated(this.instance,options);},this);if(!options.silent&&this.related!==oldRelated){var dit=this;this.changed=true;Backbone.Relational.eventQueue.add(function(){dit.instance.trigger('change:'+dit.key,dit.instance,dit.related,options,true);dit.changed=false;});}
this.release();},tryAddRelated:function(model,coll,options){if((this.keyId||this.keyId===0)&&model.id===this.keyId){this.addRelated(model,options);this.keyId=null;}},addRelated:function(model,options){var dit=this;model.queue(function(){if(model!==dit.related){var oldRelated=dit.related||null;dit.setRelated(model);dit.onChange(dit.instance,model,_.defaults({__related:oldRelated},options));}});},removeRelated:function(model,coll,options){if(!this.related){return;}
if(model===this.related){var oldRelated=this.related||null;this.setRelated(null);this.onChange(this.instance,model,_.defaults({__related:oldRelated},options));}}});Backbone.HasMany=Backbone.Relation.extend({collectionType:null,options:{reverseRelation:{type:'HasOne'},collectionType:Backbone.Collection,collectionKey:true,collectionOptions:{}},initialize:function(opts){this.listenTo(this.instance,'relational:change:'+this.key,this.onChange);this.collectionType=this.options.collectionType;if(_.isFunction(this.collectionType)&&this.collectionType!==Backbone.Collection&&!(this.collectionType.prototype instanceof Backbone.Collection)){this.collectionType=_.result(this,'collectionType');}
if(_.isString(this.collectionType)){this.collectionType=Backbone.Relational.store.getObjectByName(this.collectionType);}
if(this.collectionType!==Backbone.Collection&&!(this.collectionType.prototype instanceof Backbone.Collection)){throw new Error('`collectionType` must inherit from Backbone.Collection');}
var related=this.findRelated(opts);this.setRelated(related);},_prepareCollection:function(collection){if(this.related){this.stopListening(this.related);}
if(!collection||!(collection instanceof Backbone.Collection)){var options=_.isFunction(this.options.collectionOptions)?this.options.collectionOptions(this.instance):this.options.collectionOptions;collection=new this.collectionType(null,options);}
collection.model=this.relatedModel;if(this.options.collectionKey){var key=this.options.collectionKey===true?this.options.reverseRelation.key:this.options.collectionKey;if(collection[key]&&collection[key]!==this.instance){if(Backbone.Relational.showWarnings&&typeof console!=='undefined'){console.warn('Relation=%o; collectionKey=%s already exists on collection=%o',this,key,this.options.collectionKey);}}
else if(key){collection[key]=this.instance;}}
this.listenTo(collection,'relational:add',this.handleAddition).listenTo(collection,'relational:remove',this.handleRemoval).listenTo(collection,'relational:reset',this.handleReset);return collection;},findRelated:function(options){var related=null;options=_.defaults({parse:this.options.parse},options);if(this.keyContents instanceof Backbone.Collection){this._prepareCollection(this.keyContents);related=this.keyContents;}
else{var toAdd=[];_.each(this.keyContents,function(attributes){var model=null;if(attributes instanceof this.relatedModel){model=attributes;}
else{model=this.relatedModel.findOrCreate(attributes,_.extend({merge:true},options,{create:this.options.createModels}));}
model&&toAdd.push(model);},this);if(this.related instanceof Backbone.Collection){related=this.related;}
else{related=this._prepareCollection();}
related.set(toAdd,_.defaults({merge:false,parse:false},options));}
this.keyIds=_.difference(this.keyIds,_.pluck(related.models,'id'));return related;},setKeyContents:function(keyContents){this.keyContents=keyContents instanceof Backbone.Collection?keyContents:null;this.keyIds=[];if(!this.keyContents&&(keyContents||keyContents===0)){this.keyContents=_.isArray(keyContents)?keyContents:[keyContents];_.each(this.keyContents,function(item){var itemId=Backbone.Relational.store.resolveIdForItem(this.relatedModel,item);if(itemId||itemId===0){this.keyIds.push(itemId);}},this);}},onChange:function(model,attr,options){options=options?_.clone(options):{};this.setKeyContents(attr);this.changed=false;var related=this.findRelated(options);this.setRelated(related);if(!options.silent){var dit=this;Backbone.Relational.eventQueue.add(function(){if(dit.changed){dit.instance.trigger('change:'+dit.key,dit.instance,dit.related,options,true);dit.changed=false;}});}},handleAddition:function(model,coll,options){options=options?_.clone(options):{};this.changed=true;_.each(this.getReverseRelations(model),function(relation){relation.addRelated(this.instance,options);},this);var dit=this;!options.silent&&Backbone.Relational.eventQueue.add(function(){dit.instance.trigger('add:'+dit.key,model,dit.related,options);});},handleRemoval:function(model,coll,options){options=options?_.clone(options):{};this.changed=true;_.each(this.getReverseRelations(model),function(relation){relation.removeRelated(this.instance,null,options);},this);var dit=this;!options.silent&&Backbone.Relational.eventQueue.add(function(){dit.instance.trigger('remove:'+dit.key,model,dit.related,options);});},handleReset:function(coll,options){var dit=this;options=options?_.clone(options):{};!options.silent&&Backbone.Relational.eventQueue.add(function(){dit.instance.trigger('reset:'+dit.key,dit.related,options);});},tryAddRelated:function(model,coll,options){var item=_.contains(this.keyIds,model.id);if(item){this.addRelated(model,options);this.keyIds=_.without(this.keyIds,model.id);}},addRelated:function(model,options){var dit=this;model.queue(function(){if(dit.related&&!dit.related.get(model)){dit.related.add(model,_.defaults({parse:false},options));}});},removeRelated:function(model,coll,options){if(this.related.get(model)){this.related.remove(model,options);}}});Backbone.RelationalModel=Backbone.Model.extend({relations:null,_relations:null,_isInitialized:false,_deferProcessing:false,_queue:null,_attributeChangeFired:false,subModelTypeAttribute:'type',subModelTypes:null,constructor:function(attributes,options){if(options&&options.collection){var dit=this,collection=this.collection=options.collection;delete options.collection;this._deferProcessing=true;var processQueue=function(model){if(model===dit){dit._deferProcessing=false;dit.processQueue();collection.off('relational:add',processQueue);}};collection.on('relational:add',processQueue);_.defer(function(){processQueue(dit);});}
Backbone.Relational.store.processOrphanRelations();Backbone.Relational.store.listenTo(this,'relational:unregister',Backbone.Relational.store.unregister);this._queue=new Backbone.BlockingQueue();this._queue.block();Backbone.Relational.eventQueue.block();try{Backbone.Model.apply(this,arguments);}
finally{Backbone.Relational.eventQueue.unblock();}},trigger:function(eventName){if(eventName.length>5&&eventName.indexOf('change')===0){var dit=this,args=arguments;if(!Backbone.Relational.eventQueue.isLocked()){Backbone.Model.prototype.trigger.apply(dit,args);}
else{Backbone.Relational.eventQueue.add(function(){var changed=true;if(eventName==='change'){changed=dit.hasChanged()||dit._attributeChangeFired;dit._attributeChangeFired=false;}
else{var attr=eventName.slice(7),rel=dit.getRelation(attr);if(rel){changed=(args[4]===true);if(changed){dit.changed[attr]=args[2];}
else if(!rel.changed){delete dit.changed[attr];}}
else if(changed){dit._attributeChangeFired=true;}}
changed&&Backbone.Model.prototype.trigger.apply(dit,args);});}}
else if(eventName==='destroy'){Backbone.Model.prototype.trigger.apply(this,arguments);Backbone.Relational.store.unregister(this);}
else{Backbone.Model.prototype.trigger.apply(this,arguments);}
return this;},initializeRelations:function(options){this.acquire();this._relations={};_.each(this.relations||[],function(rel){Backbone.Relational.store.initializeRelation(this,rel,options);},this);this._isInitialized=true;this.release();this.processQueue();},updateRelations:function(changedAttrs,options){if(this._isInitialized&&!this.isLocked()){_.each(this._relations,function(rel){if(!changedAttrs||(rel.keySource in changedAttrs||rel.key in changedAttrs)){var value=this.attributes[rel.keySource]||this.attributes[rel.key],attr=changedAttrs&&(changedAttrs[rel.keySource]||changedAttrs[rel.key]);if(rel.related!==value||(value===null&&attr===null)){this.trigger('relational:change:'+rel.key,this,value,options||{});}}
if(rel.keySource!==rel.key){delete this.attributes[rel.keySource];}},this);}},queue:function(func){this._queue.add(func);},processQueue:function(){if(this._isInitialized&&!this._deferProcessing&&this._queue.isBlocked()){this._queue.unblock();}},getRelation:function(attr){return this._relations[attr];},getRelations:function(){return _.values(this._relations);},getIdsToFetch:function(attr,refresh){var rel=attr instanceof Backbone.Relation?attr:this.getRelation(attr),ids=rel?(rel.keyIds&&rel.keyIds.slice(0))||((rel.keyId||rel.keyId===0)?[rel.keyId]:[]):[];if(refresh){var models=rel.related&&(rel.related.models||[rel.related]);_.each(models,function(model){if(model.id||model.id===0){ids.push(model.id);}});}
return ids;},getAsync:function(attr,options){options=_.extend({add:true,remove:false,refresh:false},options);var dit=this,requests=[],rel=this.getRelation(attr),idsToFetch=rel&&this.getIdsToFetch(rel,options.refresh),coll=rel.related instanceof Backbone.Collection?rel.related:rel.relatedCollection;if(idsToFetch&&idsToFetch.length){var models=[],createdModels=[],setUrl,createModels=function(){models=_.map(idsToFetch,function(id){var model=rel.relatedModel.findModel(id);if(!model){var attrs={};attrs[rel.relatedModel.prototype.idAttribute]=id;model=rel.relatedModel.findOrCreate(attrs,options);createdModels.push(model);}
return model;},this);};if(coll instanceof Backbone.Collection&&_.isFunction(coll.url)){var defaultUrl=coll.url();setUrl=coll.url(idsToFetch);if(setUrl===defaultUrl){createModels();setUrl=coll.url(models);if(setUrl===defaultUrl){setUrl=null;}}}
if(setUrl){var opts=_.defaults({error:function(){_.each(createdModels,function(model){model.trigger('destroy',model,model.collection,options);});options.error&&options.error.apply(models,arguments);},url:setUrl},options);requests=[coll.fetch(opts)];}
else{if(!models.length){createModels();}
requests=_.map(models,function(model){var opts=_.defaults({error:function(){if(_.contains(createdModels,model)){model.trigger('destroy',model,model.collection,options);}
options.error&&options.error.apply(models,arguments);}},options);return model.fetch(opts);},this);}}
return $.when.apply(null,requests).then(function(){return Backbone.Model.prototype.get.call(dit,attr);});},set:function(key,value,options){Backbone.Relational.eventQueue.block();var attributes,result;if(_.isObject(key)||key==null){attributes=key;options=value;}
else{attributes={};attributes[key]=value;}
try{var id=this.id,newId=attributes&&this.idAttribute in attributes&&attributes[this.idAttribute];Backbone.Relational.store.checkId(this,newId);result=Backbone.Model.prototype.set.apply(this,arguments);if(!this._isInitialized&&!this.isLocked()){this.constructor.initializeModelHierarchy();if(newId||newId===0){Backbone.Relational.store.register(this);}
this.initializeRelations(options);}
else if(newId&&newId!==id){Backbone.Relational.store.update(this);}
if(attributes){this.updateRelations(attributes,options);}}
finally{Backbone.Relational.eventQueue.unblock();}
return result;},clone:function(){var attributes=_.clone(this.attributes);if(!_.isUndefined(attributes[this.idAttribute])){attributes[this.idAttribute]=null;}
_.each(this.getRelations(),function(rel){delete attributes[rel.key];});return new this.constructor(attributes);},toJSON:function(options){if(this.isLocked()){return this.id;}
this.acquire();var json=Backbone.Model.prototype.toJSON.call(this,options);if(this.constructor._superModel&&!(this.constructor._subModelTypeAttribute in json)){json[this.constructor._subModelTypeAttribute]=this.constructor._subModelTypeValue;}
_.each(this._relations,function(rel){var related=json[rel.key],includeInJSON=rel.options.includeInJSON,value=null;if(includeInJSON===true){if(related&&_.isFunction(related.toJSON)){value=related.toJSON(options);}}
else if(_.isString(includeInJSON)){if(related instanceof Backbone.Collection){value=related.pluck(includeInJSON);}
else if(related instanceof Backbone.Model){value=related.get(includeInJSON);}
if(includeInJSON===rel.relatedModel.prototype.idAttribute){if(rel instanceof Backbone.HasMany){value=value.concat(rel.keyIds);}
else if(rel instanceof Backbone.HasOne){value=value||rel.keyId;if(!value&&!_.isObject(rel.keyContents)){value=rel.keyContents||null;}}}}
else if(_.isArray(includeInJSON)){if(related instanceof Backbone.Collection){value=[];related.each(function(model){var curJson={};_.each(includeInJSON,function(key){curJson[key]=model.get(key);});value.push(curJson);});}
else if(related instanceof Backbone.Model){value={};_.each(includeInJSON,function(key){value[key]=related.get(key);});}}
else{delete json[rel.key];}
if(value===null&&options&&options.wait){value=related;}
if(includeInJSON){json[rel.keyDestination]=value;}
if(rel.keyDestination!==rel.key){delete json[rel.key];}});this.release();return json;}},{setup:function(superModel){this.prototype.relations=(this.prototype.relations||[]).slice(0);this._subModels={};this._superModel=null;if(this.prototype.hasOwnProperty('subModelTypes')){Backbone.Relational.store.addSubModels(this.prototype.subModelTypes,this);}
else{this.prototype.subModelTypes=null;}
_.each(this.prototype.relations||[],function(rel){if(!rel.model){rel.model=this;}
if(rel.reverseRelation&&rel.model===this){var preInitialize=true;if(_.isString(rel.relatedModel)){var relatedModel=Backbone.Relational.store.getObjectByName(rel.relatedModel);preInitialize=relatedModel&&(relatedModel.prototype instanceof Backbone.RelationalModel);}
if(preInitialize){Backbone.Relational.store.initializeRelation(null,rel);}
else if(_.isString(rel.relatedModel)){Backbone.Relational.store.addOrphanRelation(rel);}}},this);return this;},build:function(attributes,options){this.initializeModelHierarchy();var model=this._findSubModelType(this,attributes)||this;return new model(attributes,options);},_findSubModelType:function(type,attributes){if(type._subModels&&type.prototype.subModelTypeAttribute in attributes){var subModelTypeAttribute=attributes[type.prototype.subModelTypeAttribute];var subModelType=type._subModels[subModelTypeAttribute];if(subModelType){return subModelType;}
else{for(subModelTypeAttribute in type._subModels){subModelType=this._findSubModelType(type._subModels[subModelTypeAttribute],attributes);if(subModelType){return subModelType;}}}}
return null;},initializeModelHierarchy:function(){this.inheritRelations();if(this.prototype.subModelTypes){var resolvedSubModels=_.keys(this._subModels);var unresolvedSubModels=_.omit(this.prototype.subModelTypes,resolvedSubModels);_.each(unresolvedSubModels,function(subModelTypeName){var subModelType=Backbone.Relational.store.getObjectByName(subModelTypeName);subModelType&&subModelType.initializeModelHierarchy();});}},inheritRelations:function(){if(!_.isUndefined(this._superModel)&&!_.isNull(this._superModel)){return;}
Backbone.Relational.store.setupSuperModel(this);if(this._superModel){this._superModel.inheritRelations();if(this._superModel.prototype.relations){var inheritedRelations=_.filter(this._superModel.prototype.relations||[],function(superRel){return!_.any(this.prototype.relations||[],function(rel){return superRel.relatedModel===rel.relatedModel&&superRel.key===rel.key;},this);},this);this.prototype.relations=inheritedRelations.concat(this.prototype.relations);}}
else{this._superModel=false;}},findOrCreate:function(attributes,options){options||(options={});var parsedAttributes=(_.isObject(attributes)&&options.parse&&this.prototype.parse)?this.prototype.parse(_.clone(attributes)):attributes;var model=this.findModel(parsedAttributes);if(_.isObject(attributes)){if(model&&options.merge!==false){delete options.collection;delete options.url;model.set(parsedAttributes,options);}
else if(!model&&options.create!==false){model=this.build(parsedAttributes,_.defaults({parse:false},options));}}
return model;},find:function(attributes,options){options||(options={});options.create=false;return this.findOrCreate(attributes,options);},findModel:function(attributes){return Backbone.Relational.store.find(this,attributes);}});_.extend(Backbone.RelationalModel.prototype,Backbone.Semaphore);Backbone.Collection.prototype.__prepareModel=Backbone.Collection.prototype._prepareModel;Backbone.Collection.prototype._prepareModel=function(attrs,options){var model;if(attrs instanceof Backbone.Model){if(!attrs.collection){attrs.collection=this;}
model=attrs;}
else{options=options?_.clone(options):{};options.collection=this;if(typeof this.model.findOrCreate!=='undefined'){model=this.model.findOrCreate(attrs,options);}
else{model=new this.model(attrs,options);}
if(model&&model.validationError){this.trigger('invalid',this,attrs,options);model=false;}}
return model;};var set=Backbone.Collection.prototype.__set=Backbone.Collection.prototype.set;Backbone.Collection.prototype.set=function(models,options){if(!(this.model.prototype instanceof Backbone.RelationalModel)){return set.call(this,models,options);}
if(options&&options.parse){models=this.parse(models,options);}
var singular=!_.isArray(models),newModels=[],toAdd=[],model=null;models=singular?(models?[models]:[]):_.clone(models);for(var i=0;i<models.length;i++){model=models[i];if(!(model instanceof Backbone.Model)){model=Backbone.Collection.prototype._prepareModel.call(this,model,options);}
if(model){toAdd.push(model);if(!(this.get(model)||this.get(model.cid))){newModels.push(model);}
else if(model.id!==null&&model.id!==undefined){this._byId[model.id]=model;}}}
toAdd=singular?(toAdd.length?toAdd[0]:null):toAdd;var result=set.call(this,toAdd,_.defaults({merge:false,parse:false},options));for(i=0;i<newModels.length;i++){model=newModels[i];if(this.get(model)||this.get(model.cid)){this.trigger('relational:add',model,this,options);}}
return result;};var remove=Backbone.Collection.prototype.__remove=Backbone.Collection.prototype.remove;Backbone.Collection.prototype.remove=function(models,options){if(!(this.model.prototype instanceof Backbone.RelationalModel)){return remove.call(this,models,options);}
var singular=!_.isArray(models),toRemove=[];models=singular?(models?[models]:[]):_.clone(models);options||(options={});_.each(models,function(model){model=this.get(model)||(model&&this.get(model.cid));model&&toRemove.push(model);},this);var result=remove.call(this,singular?(toRemove.length?toRemove[0]:null):toRemove,options);_.each(toRemove,function(model){this.trigger('relational:remove',model,this,options);},this);return result;};var reset=Backbone.Collection.prototype.__reset=Backbone.Collection.prototype.reset;Backbone.Collection.prototype.reset=function(models,options){options=_.extend({merge:true},options);var result=reset.call(this,models,options);if(this.model.prototype instanceof Backbone.RelationalModel){this.trigger('relational:reset',this,options);}
return result;};var sort=Backbone.Collection.prototype.__sort=Backbone.Collection.prototype.sort;Backbone.Collection.prototype.sort=function(options){var result=sort.call(this,options);if(this.model.prototype instanceof Backbone.RelationalModel){this.trigger('relational:reset',this,options);}
return result;};var trigger=Backbone.Collection.prototype.__trigger=Backbone.Collection.prototype.trigger;Backbone.Collection.prototype.trigger=function(eventName){if(!(this.model.prototype instanceof Backbone.RelationalModel)){return trigger.apply(this,arguments);}
if(eventName==='add'||eventName==='remove'||eventName==='reset'||eventName==='sort'){var dit=this,args=arguments;if(_.isObject(args[3])){args=_.toArray(args);args[3]=_.clone(args[3]);}
Backbone.Relational.eventQueue.add(function(){trigger.apply(dit,args);});}
else{trigger.apply(this,arguments);}
return this;};Backbone.RelationalModel.extend=function(protoProps,classProps){var child=Backbone.Model.extend.call(this,protoProps,classProps);child.setup(this);return child;};}));/*!
 * JavaScript Cookie v2.1.4
 * https://github.com/js-cookie/js-cookie
 *
 * Copyright 2006, 2015 Klaus Hartl & Fagner Brack
 * Released under the MIT license
 */;(function(factory){var registeredInModuleLoader=false;if(typeof define==='function'&&define.amd){define('js-cookie',factory);registeredInModuleLoader=true;}
if(typeof exports==='object'){module.exports=factory();registeredInModuleLoader=true;}
if(!registeredInModuleLoader){var OldCookies=window.Cookies;var api=window.Cookies=factory();api.noConflict=function(){window.Cookies=OldCookies;return api;};}}(function(){function extend(){var i=0;var result={};for(;i<arguments.length;i++){var attributes=arguments[i];for(var key in attributes){result[key]=attributes[key];}}
return result;}
function init(converter){function api(key,value,attributes){var result;if(typeof document==='undefined'){return;}
if(arguments.length>1){attributes=extend({path:'/'},api.defaults,attributes);if(typeof attributes.expires==='number'){var expires=new Date();expires.setMilliseconds(expires.getMilliseconds()+attributes.expires*864e+5);attributes.expires=expires;}
attributes.expires=attributes.expires?attributes.expires.toUTCString():'';try{result=JSON.stringify(value);if(/^[\{\[]/.test(result)){value=result;}}catch(e){}
if(!converter.write){value=encodeURIComponent(String(value)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent);}else{value=converter.write(value,key);}
key=encodeURIComponent(String(key));key=key.replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent);key=key.replace(/[\(\)]/g,escape);var stringifiedAttributes='';for(var attributeName in attributes){if(!attributes[attributeName]){continue;}
stringifiedAttributes+='; '+attributeName;if(attributes[attributeName]===true){continue;}
stringifiedAttributes+='='+attributes[attributeName];}
return(document.cookie=key+'='+value+stringifiedAttributes);}
if(!key){result={};}
var cookies=document.cookie?document.cookie.split('; '):[];var rdecode=/(%[0-9A-Z]{2})+/g;var i=0;for(;i<cookies.length;i++){var parts=cookies[i].split('=');var cookie=parts.slice(1).join('=');if(cookie.charAt(0)==='"'){cookie=cookie.slice(1,-1);}
try{var name=parts[0].replace(rdecode,decodeURIComponent);cookie=converter.read?converter.read(cookie,name):converter(cookie,name)||cookie.replace(rdecode,decodeURIComponent);if(this.json){try{cookie=JSON.parse(cookie);}catch(e){}}
if(key===name){result=cookie;break;}
if(!key){result[name]=cookie;}}catch(e){}}
return result;}
api.set=api;api.get=function(key){return api.call(api,key);};api.getJSON=function(){return api.apply({json:true},[].slice.call(arguments));};api.defaults={};api.remove=function(key,attributes){api(key,'',extend(attributes,{expires:-1}));};api.withConverter=init;return api;}
return init(function(){});}));define('collections/product_collection',['backbone','underscore','utils/utils','backbone.super'],function(Backbone,_,Utils){'use strict';return Backbone.Collection.extend({initialize:function(models,options){if(options){this.course=options.course;}},isValid:function(){return Utils.areModelsValid(this.models);},set:function(models,options){_.each(models,function(model){if(_.isObject(model)){model.course=this.course;}},this);this._super(models,options);}});});define('models/product_model',['backbone','backbone.relational','backbone.validation','moment','underscore','utils/utils'],function(Backbone,BackboneRelational,BackboneValidation,moment,_,Utils){'use strict';_.extend(Backbone.Model.prototype,Backbone.Validation.mixin);return Backbone.RelationalModel.extend({urlRoot:'/api/v2/products/',nestedAttributes:['certificate_type','course_key','id_verification_required','credit_provider','credit_hours'],parse:function(response){_.each(response.attribute_values,function(data){this.nestedAttributes.push(data.name);response[data.name]=data.value;},this);delete response.attribute_values;response.expires=Utils.stripTimezone(response.expires);return response;},toJSON:function(){var data=_.clone(this.attributes);data.attribute_values=[];_.each(_.uniq(this.nestedAttributes),function(attribute){if(this.has(attribute)){data.attribute_values.push({name:attribute,value:this.get(attribute)});}
delete data[attribute];},this);data.expires=Utils.restoreTimezone(data.expires);return data;}});});define('models/course_seats/course_seat',['underscore','moment','models/product_model'],function(_,moment,Product){'use strict';return Product.extend({defaults:{certificate_type:null,expires:null,id_verification_required:null,price:0,credit_provider:null,credit_hours:null,product_class:'Seat'},course:null,validation:{price:{required:true,pattern:'number',msg:gettext('All course seats must have a price.')},product_class:{oneOf:['Seat']},expires:function(value){var verificationDeadline,course=this.course||this.get('course');if(!course||!course.get('id')){return undefined;}
if(_.isEmpty(value)){if(this.getSeatType()==='verified'){return gettext('Verified seats must have an upgrade deadline.');}
return undefined;}
verificationDeadline=course.get('verification_deadline');if(verificationDeadline&&!moment(value).isBefore(verificationDeadline)){return gettext('The upgrade deadline must occur BEFORE the verification deadline.');}
return undefined;},title:{required:false,pattern:'productName'}},getSeatType:function(){var certificateType=this.get('certificate_type');switch(certificateType){case'credit':case'honor':case'verified':return certificateType;case'professional':case'no-id-professional':return'professional';default:return'audit';}},getSeatTypeDisplayName:function(){switch(this.get('certificate_type')){case'verified':return gettext('Verified');case'credit':return gettext('Credit');case'professional':case'no-id-professional':return gettext('Professional');case'honor':return gettext('Honor');default:return gettext('Audit');}},getCertificateDisplayName:function(){switch(this.get('certificate_type')){case'verified':case'credit':return gettext('Verified Certificate');case'professional':case'no-id-professional':return gettext('Professional Certificate');case'honor':return gettext('Honor Certificate');default:return'('+gettext('No Certificate')+')';}}});});define('models/course_seats/audit_seat',['underscore','models/course_seats/course_seat'],function(_,CourseSeat){'use strict';return CourseSeat.extend({defaults:_.extend({},CourseSeat.prototype.defaults,{certificate_type:null,id_verification_required:false,price:0})},{seatType:'audit'});});define('models/course_seats/honor_seat',['underscore','models/course_seats/course_seat'],function(_,CourseSeat){'use strict';return CourseSeat.extend({defaults:_.extend({},CourseSeat.prototype.defaults,{certificate_type:'honor',id_verification_required:false,price:0})},{seatType:'honor'});});define('models/course_seats/professional_seat',['underscore','models/course_seats/course_seat'],function(_,CourseSeat){'use strict';return CourseSeat.extend({defaults:_.extend({},CourseSeat.prototype.defaults,{certificate_type:'professional',id_verification_required:false,price:1000})},{seatType:'professional'});});define('models/course_seats/verified_seat',['underscore','models/course_seats/course_seat'],function(_,CourseSeat){'use strict';return CourseSeat.extend({defaults:_.extend({},CourseSeat.prototype.defaults,{certificate_type:'verified',id_verification_required:true,price:100})},{seatType:'verified'});});define('ecommerce',[],function(){'use strict';return{coupons:{},credit:{}};});define('models/course_seats/credit_seat',['underscore','models/course_seats/course_seat','ecommerce'],function(_,CourseSeat,ecommerce){'use strict';return CourseSeat.extend({defaults:_.extend({},CourseSeat.prototype.defaults,{certificate_type:'credit',id_verification_required:true,price:0,credit_provider:null,credit_hours:null}),validation:_.extend({},CourseSeat.prototype.validation,{credit_provider:function(value){if(!value){return gettext('All credit seats must have a credit provider.');}
if(!ecommerce.credit.providers.findWhere({id:value})){return gettext('Please select a valid credit provider.');}
return undefined;},credit_hours:{required:true,pattern:'number',min:0,msg:gettext('All credit seats must designate a number of credit hours.')}})},{seatType:'credit'});});define('utils/course_utils',['underscore','models/course_seats/audit_seat','models/course_seats/course_seat','models/course_seats/honor_seat','models/course_seats/professional_seat','models/course_seats/verified_seat','models/course_seats/credit_seat'],function(_,AuditSeat,CourseSeat,HonorSeat,ProfessionalSeat,VerifiedSeat,CreditSeat){'use strict';return{seatSortObj:_.invert(_.object(_.pairs(['audit','honor','verified','no-id-professional','professional','credit']))),getSeatModelMap:_.memoize(function(){return _.indexBy([AuditSeat,HonorSeat,ProfessionalSeat,VerifiedSeat,CreditSeat],'seatType');}),getCourseSeatModel:function(seatType){return this.getSeatModelMap()[seatType]||CourseSeat;},orderSeatsForDisplay:function(seats){return _.sortBy(seats,function(seat){return this.seatSortObj[seat.getSeatType()];},this);},orderSeatTypesForDisplay:function(seatTypes){return _.sortBy(seatTypes,function(seatType){return this.seatSortObj[seatType];},this);},filterSeats:function(seats,seatType){return _.groupBy(seats,function(seat){if(seat.getSeatType()===seatType){return'filtered';}
return'residual';});}};});define('utils/validation_patterns',['backbone','backbone.validation','underscore'],function(Backbone,BackboneValidation,_){'use strict';_.extend(Backbone.Validation.patterns,{courseId:/[^/+]+(\/|\+)[^/+]+(\/|\+)[^/]+/});_.extend(Backbone.Validation.messages,{courseId:gettext('The course ID is invalid.')});_.extend(Backbone.Validation.patterns,{productName:/^((?!&\w+;|<\/*\w+>).)*$/});_.extend(Backbone.Validation.messages,{productName:gettext('The product name cannot contain HTML.')});});define('models/course_model',['backbone','backbone.relational','backbone.super','backbone.validation','jquery','js-cookie','moment','underscore','collections/product_collection','models/course_seats/course_seat','utils/course_utils','utils/utils','utils/validation_patterns'],function(Backbone,BackboneRelational,BackboneSuper,BackboneValidation,$,Cookies,moment,_,ProductCollection,CourseSeat,CourseUtils,Utils){'use strict';_.extend(Backbone.Model.prototype,Backbone.Validation.mixin);return Backbone.RelationalModel.extend({urlRoot:'/api/v2/courses/',defaults:{id:null,name:null,type:null,verification_deadline:null,honor_mode:null},validation:{id:{required:true,pattern:'courseId'},name:{required:true,pattern:'productName'},type:{required:true,msg:gettext('You must select a course type.')},honor_mode:{required:function(){return this.includeHonorMode();},msg:gettext('You must choose if an honor seat should be created.')},verification_deadline:function(value){var invalid;if(_.isEmpty(value)){return undefined;}
invalid=_.some(this.seats(),function(seat){var expires=seat.get('expires');return expires&&moment(value).isBefore(expires);});if(invalid){return gettext('The verification deadline must occur AFTER the upgrade deadline.');}
return undefined;},products:function(value){if(!_.isArray(value)&&!value.isValid()){return gettext('Product validation failed.');}
return undefined;}},labels:{id:gettext('Course ID'),name:gettext('Course Name'),type:gettext('Course Type'),verification_deadline:gettext('Verification Deadline'),honor_mode:gettext('Include Honor Seat')},relations:[{collectionType:ProductCollection,type:Backbone.HasMany,key:'products',relatedModel:CourseSeat,includeInJSON:false,parse:true,collectionOptions:function(model){return{course:model};}}],validCourseTypeSeatMapping:{audit:['audit','honor'],verified:['audit','verified','honor'],professional:['professional'],credit:['audit','verified','credit','honor']},activeCourseTypeSeatMapping:{audit:['audit'],verified:['audit','verified'],professional:['professional'],credit:['audit','verified','credit']},creatableSeatTypes:['audit','honor','verified','professional','credit'],initialize:function(){this.get('products').on('change:id_verification_required',this.triggerIdVerified,this);this.on('sync',this.prepareProducts,this);this.on('sync',this.honorModeInit,this);},parse:function(response){var responseReassigned=this._super(response);responseReassigned.verification_deadline=Utils.stripTimezone(responseReassigned.verification_deadline);return responseReassigned;},toJSON:function(){var data=this._super();data.verification_deadline=Utils.restoreTimezone(data.verification_deadline);return data;},triggerIdVerified:function(){this.trigger('change:id_verification_required',this.isIdVerified());},honorModeInit:function(){var honorSeat;if(this.seats().length>0){honorSeat=_.find(this.seats(),function(seat){return seat.attributes.certificate_type==='honor';});this.set('honor_mode',!!honorSeat);}},prepareProducts:function(){var products,parents,seats;products=this.get('products');parents=products.where({structure:'parent'});products.remove(parents);seats=products.where({product_class:'Seat'});products.reset(seats);},seats:function(){return this.get('products').filter(function(product){return(product instanceof CourseSeat)&&product.get('structure')!=='parent'&&product.get('product_class')==='Seat';});},getOrCreateSeats:function(seatType){var seatClass,seats=_.filter(this.seats(),function(product){return product.getSeatType()===seatType;}),seat;if(_.isEmpty(seats)&&_.contains(this.creatableSeatTypes,seatType)){seatClass=CourseUtils.getCourseSeatModel(seatType);seat=new seatClass({course:this});this.get('products').add(seat);seats.push(seat);}
return seats;},isIdVerified:function(){return Boolean(_.find(this.getCleanProducts(),function(seat){return seat.get('id_verification_required');},this));},includeHonorMode:function(){return this.get('type')&&this.get('type')!=='professional';},validSeatTypes:function(){return _.result(this.validCourseTypeSeatMapping,this.get('type'),[]);},activeSeatTypes:function(){return _.result(this.activeCourseTypeSeatMapping,this.get('type'),[]);},getCleanProducts:function(){return this.seats().filter(function(seat){return _.contains(this.validSeatTypes(),seat.getSeatType());},this);},save:function(attributes,options){var verificationDeadline,honorMode,honorSeatClass,honorSeat,products,auditSeat,data={id:this.get('id'),name:this.get('name'),verification_deadline:null};if(this.includeHonorMode()){honorMode=this.get('honor_mode');if(honorMode){honorSeatClass=CourseUtils.getCourseSeatModel('honor');honorSeat=new honorSeatClass({course:this});products=this.get('products');auditSeat=products.where({certificate_type:null});products.remove(auditSeat);products.add(honorSeat);}}
data.products=_.map(this.getCleanProducts(),function(product){return product.toJSON();},this);if(this.isIdVerified()){verificationDeadline=this.get('verification_deadline');if(verificationDeadline){data.verification_deadline=moment.utc(verificationDeadline).format();}}
_.defaults(options||(options={}),{type:'POST',url:'/api/v2/publication/',headers:{'X-CSRFToken':Cookies.get('ecommerce_csrftoken')},contentType:'application/json'});options.data=JSON.stringify(data);return this._super(null,options);}});});define('collections/course_collection',['collections/paginated_collection','models/course_model'],function(PaginatedCollection,Course){'use strict';return PaginatedCollection.extend({model:Course,url:'/api/v2/courses/'});});!function(e){if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define('underscore.string',e);else{var f;"undefined"!=typeof window?f=window:"undefined"!=typeof global?f=global:"undefined"!=typeof self&&(f=self),f.s=e()}}(function(){var define,module,exports;return(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(_dereq_,module,exports){var trim=_dereq_('./trim');var decap=_dereq_('./decapitalize');module.exports=function camelize(str,decapitalize){str=trim(str).replace(/[-_\s]+(.)?/g,function(match,c){return c?c.toUpperCase():"";});if(decapitalize===true){return decap(str);}else{return str;}};},{"./decapitalize":9,"./trim":61}],2:[function(_dereq_,module,exports){var makeString=_dereq_('./helper/makeString');module.exports=function capitalize(str,lowercaseRest){str=makeString(str);var remainingChars=!lowercaseRest?str.slice(1):str.slice(1).toLowerCase();return str.charAt(0).toUpperCase()+remainingChars;};},{"./helper/makeString":20}],3:[function(_dereq_,module,exports){var makeString=_dereq_('./helper/makeString');module.exports=function chars(str){return makeString(str).split('');};},{"./helper/makeString":20}],4:[function(_dereq_,module,exports){module.exports=function chop(str,step){if(str==null)return[];str=String(str);step=~~step;return step>0?str.match(new RegExp('.{1,'+step+'}','g')):[str];};},{}],5:[function(_dereq_,module,exports){var capitalize=_dereq_('./capitalize');var camelize=_dereq_('./camelize');var makeString=_dereq_('./helper/makeString');module.exports=function classify(str){str=makeString(str);return capitalize(camelize(str.replace(/[\W_]/g,' ')).replace(/\s/g,''));};},{"./camelize":1,"./capitalize":2,"./helper/makeString":20}],6:[function(_dereq_,module,exports){var trim=_dereq_('./trim');module.exports=function clean(str){return trim(str).replace(/\s+/g,' ');};},{"./trim":61}],7:[function(_dereq_,module,exports){var makeString=_dereq_('./helper/makeString');module.exports=function(str,substr){str=makeString(str);substr=makeString(substr);if(str.length===0||substr.length===0)return 0;return str.split(substr).length-1;};},{"./helper/makeString":20}],8:[function(_dereq_,module,exports){var trim=_dereq_('./trim');module.exports=function dasherize(str){return trim(str).replace(/([A-Z])/g,'-$1').replace(/[-_\s]+/g,'-').toLowerCase();};},{"./trim":61}],9:[function(_dereq_,module,exports){var makeString=_dereq_('./helper/makeString');module.exports=function decapitalize(str){str=makeString(str);return str.charAt(0).toLowerCase()+str.slice(1);};},{"./helper/makeString":20}],10:[function(_dereq_,module,exports){var makeString=_dereq_('./helper/makeString');function getIndent(str){var matches=str.match(/^[\s\\t]*/gm);var indent=matches[0].length;for(var i=1;i<matches.length;i++){indent=Math.min(matches[i].length,indent);}
return indent;}
module.exports=function dedent(str,pattern){str=makeString(str);var indent=getIndent(str);var reg;if(indent===0)return str;if(typeof pattern==='string'){reg=new RegExp('^'+pattern,'gm');}else{reg=new RegExp('^[ \\t]{'+indent+'}','gm');}
return str.replace(reg,'');};},{"./helper/makeString":20}],11:[function(_dereq_,module,exports){var makeString=_dereq_('./helper/makeString');var toPositive=_dereq_('./helper/toPositive');module.exports=function endsWith(str,ends,position){str=makeString(str);ends=''+ends;if(typeof position=='undefined'){position=str.length-ends.length;}else{position=Math.min(toPositive(position),str.length)-ends.length;}
return position>=0&&str.indexOf(ends,position)===position;};},{"./helper/makeString":20,"./helper/toPositive":22}],12:[function(_dereq_,module,exports){var makeString=_dereq_('./helper/makeString');var escapeChars=_dereq_('./helper/escapeChars');var reversedEscapeChars={};var regexString="[";for(var key in escapeChars){regexString+=key;}
regexString+="]";var regex=new RegExp(regexString,'g');module.exports=function escapeHTML(str){return makeString(str).replace(regex,function(m){return'&'+escapeChars[m]+';';});};},{"./helper/escapeChars":17,"./helper/makeString":20}],13:[function(_dereq_,module,exports){module.exports=function(){var result={};for(var prop in this){if(!this.hasOwnProperty(prop)||prop.match(/^(?:include|contains|reverse|join)$/))continue;result[prop]=this[prop];}
return result;};},{}],14:[function(_dereq_,module,exports){function s(value){if(!(this instanceof s))return new s(value);this._wrapped=value;}
s.VERSION='3.1.1';s.isBlank=_dereq_('./isBlank');s.stripTags=_dereq_('./stripTags');s.capitalize=_dereq_('./capitalize');s.decapitalize=_dereq_('./decapitalize');s.chop=_dereq_('./chop');s.trim=_dereq_('./trim');s.clean=_dereq_('./clean');s.count=_dereq_('./count');s.chars=_dereq_('./chars');s.swapCase=_dereq_('./swapCase');s.escapeHTML=_dereq_('./escapeHTML');s.unescapeHTML=_dereq_('./unescapeHTML');s.splice=_dereq_('./splice');s.insert=_dereq_('./insert');s.replaceAll=_dereq_('./replaceAll');s.include=_dereq_('./include');s.join=_dereq_('./join');s.lines=_dereq_('./lines');s.dedent=_dereq_('./dedent');s.reverse=_dereq_('./reverse');s.startsWith=_dereq_('./startsWith');s.endsWith=_dereq_('./endsWith');s.pred=_dereq_('./pred');s.succ=_dereq_('./succ');s.titleize=_dereq_('./titleize');s.camelize=_dereq_('./camelize');s.underscored=_dereq_('./underscored');s.dasherize=_dereq_('./dasherize');s.classify=_dereq_('./classify');s.humanize=_dereq_('./humanize');s.ltrim=_dereq_('./ltrim');s.rtrim=_dereq_('./rtrim');s.truncate=_dereq_('./truncate');s.prune=_dereq_('./prune');s.words=_dereq_('./words');s.pad=_dereq_('./pad');s.lpad=_dereq_('./lpad');s.rpad=_dereq_('./rpad');s.lrpad=_dereq_('./lrpad');s.sprintf=_dereq_('./sprintf');s.vsprintf=_dereq_('./vsprintf');s.toNumber=_dereq_('./toNumber');s.numberFormat=_dereq_('./numberFormat');s.strRight=_dereq_('./strRight');s.strRightBack=_dereq_('./strRightBack');s.strLeft=_dereq_('./strLeft');s.strLeftBack=_dereq_('./strLeftBack');s.toSentence=_dereq_('./toSentence');s.toSentenceSerial=_dereq_('./toSentenceSerial');s.slugify=_dereq_('./slugify');s.surround=_dereq_('./surround');s.quote=_dereq_('./quote');s.unquote=_dereq_('./unquote');s.repeat=_dereq_('./repeat');s.naturalCmp=_dereq_('./naturalCmp');s.levenshtein=_dereq_('./levenshtein');s.toBoolean=_dereq_('./toBoolean');s.exports=_dereq_('./exports');s.escapeRegExp=_dereq_('./helper/escapeRegExp');s.strip=s.trim;s.lstrip=s.ltrim;s.rstrip=s.rtrim;s.center=s.lrpad;s.rjust=s.lpad;s.ljust=s.rpad;s.contains=s.include;s.q=s.quote;s.toBool=s.toBoolean;s.camelcase=s.camelize;s.prototype={value:function value(){return this._wrapped;}};function fn2method(key,fn){if(typeof fn!=="function")return;s.prototype[key]=function(){var args=[this._wrapped].concat(Array.prototype.slice.call(arguments));var res=fn.apply(null,args);return typeof res==='string'?new s(res):res;};}
for(var key in s)fn2method(key,s[key]);fn2method("tap",function tap(string,fn){return fn(string);});function prototype2method(methodName){fn2method(methodName,function(context){var args=Array.prototype.slice.call(arguments,1);return String.prototype[methodName].apply(context,args);});}
var prototypeMethods=["toUpperCase","toLowerCase","split","replace","slice","substring","substr","concat"];for(var key in prototypeMethods)prototype2method(prototypeMethods[key]);module.exports=s;},{"./camelize":1,"./capitalize":2,"./chars":3,"./chop":4,"./classify":5,"./clean":6,"./count":7,"./dasherize":8,"./decapitalize":9,"./dedent":10,"./endsWith":11,"./escapeHTML":12,"./exports":13,"./helper/escapeRegExp":18,"./humanize":23,"./include":24,"./insert":25,"./isBlank":26,"./join":27,"./levenshtein":28,"./lines":29,"./lpad":30,"./lrpad":31,"./ltrim":32,"./naturalCmp":33,"./numberFormat":34,"./pad":35,"./pred":36,"./prune":37,"./quote":38,"./repeat":39,"./replaceAll":40,"./reverse":41,"./rpad":42,"./rtrim":43,"./slugify":44,"./splice":45,"./sprintf":46,"./startsWith":47,"./strLeft":48,"./strLeftBack":49,"./strRight":50,"./strRightBack":51,"./stripTags":52,"./succ":53,"./surround":54,"./swapCase":55,"./titleize":56,"./toBoolean":57,"./toNumber":58,"./toSentence":59,"./toSentenceSerial":60,"./trim":61,"./truncate":62,"./underscored":63,"./unescapeHTML":64,"./unquote":65,"./vsprintf":66,"./words":67}],15:[function(_dereq_,module,exports){var makeString=_dereq_('./makeString');module.exports=function adjacent(str,direction){str=makeString(str);if(str.length===0){return'';}
return str.slice(0,-1)+String.fromCharCode(str.charCodeAt(str.length-1)+direction);};},{"./makeString":20}],16:[function(_dereq_,module,exports){var escapeRegExp=_dereq_('./escapeRegExp');module.exports=function defaultToWhiteSpace(characters){if(characters==null)
return'\\s';else if(characters.source)
return characters.source;else
return'['+escapeRegExp(characters)+']';};},{"./escapeRegExp":18}],17:[function(_dereq_,module,exports){var escapeChars={'':'cent','':'pound','':'yen','':'euro','':'copy','':'reg','<':'lt','>':'gt','"':'quot','&':'amp',"'":'#39'};module.exports=escapeChars;},{}],18:[function(_dereq_,module,exports){var makeString=_dereq_('./makeString');module.exports=function escapeRegExp(str){return makeString(str).replace(/([.*+?^=!:${}()|[\]\/\\])/g,'\\$1');};},{"./makeString":20}],19:[function(_dereq_,module,exports){var htmlEntities={nbsp:' ',cent:'',pound:'',yen:'',euro:'',copy:'',reg:'',lt:'<',gt:'>',quot:'"',amp:'&',apos:"'"};module.exports=htmlEntities;},{}],20:[function(_dereq_,module,exports){module.exports=function makeString(object){if(object==null)return'';return''+object;};},{}],21:[function(_dereq_,module,exports){module.exports=function strRepeat(str,qty){if(qty<1)return'';var result='';while(qty>0){if(qty&1)result+=str;qty>>=1,str+=str;}
return result;};},{}],22:[function(_dereq_,module,exports){module.exports=function toPositive(number){return number<0?0:(+number||0);};},{}],23:[function(_dereq_,module,exports){var capitalize=_dereq_('./capitalize');var underscored=_dereq_('./underscored');var trim=_dereq_('./trim');module.exports=function humanize(str){return capitalize(trim(underscored(str).replace(/_id$/,'').replace(/_/g,' ')));};},{"./capitalize":2,"./trim":61,"./underscored":63}],24:[function(_dereq_,module,exports){var makeString=_dereq_('./helper/makeString');module.exports=function include(str,needle){if(needle==='')return true;return makeString(str).indexOf(needle)!==-1;};},{"./helper/makeString":20}],25:[function(_dereq_,module,exports){var splice=_dereq_('./splice');module.exports=function insert(str,i,substr){return splice(str,i,0,substr);};},{"./splice":45}],26:[function(_dereq_,module,exports){var makeString=_dereq_('./helper/makeString');module.exports=function isBlank(str){return(/^\s*$/).test(makeString(str));};},{"./helper/makeString":20}],27:[function(_dereq_,module,exports){var makeString=_dereq_('./helper/makeString');var slice=[].slice;module.exports=function join(){var args=slice.call(arguments),separator=args.shift();return args.join(makeString(separator));};},{"./helper/makeString":20}],28:[function(_dereq_,module,exports){var makeString=_dereq_('./helper/makeString');module.exports=function levenshtein(str1,str2){'use strict';str1=makeString(str1);str2=makeString(str2);if(str1===str2)return 0;if(!str1||!str2)return Math.max(str1.length,str2.length);var prevRow=new Array(str2.length+1);for(var i=0;i<prevRow.length;++i){prevRow[i]=i;}
for(i=0;i<str1.length;++i){var nextCol=i+1;for(var j=0;j<str2.length;++j){var curCol=nextCol;nextCol=prevRow[j]+((str1.charAt(i)===str2.charAt(j))?0:1);var tmp=curCol+1;if(nextCol>tmp){nextCol=tmp;}
tmp=prevRow[j+1]+1;if(nextCol>tmp){nextCol=tmp;}
prevRow[j]=curCol;}
prevRow[j]=nextCol;}
return nextCol;};},{"./helper/makeString":20}],29:[function(_dereq_,module,exports){module.exports=function lines(str){if(str==null)return[];return String(str).split(/\r?\n/);};},{}],30:[function(_dereq_,module,exports){var pad=_dereq_('./pad');module.exports=function lpad(str,length,padStr){return pad(str,length,padStr);};},{"./pad":35}],31:[function(_dereq_,module,exports){var pad=_dereq_('./pad');module.exports=function lrpad(str,length,padStr){return pad(str,length,padStr,'both');};},{"./pad":35}],32:[function(_dereq_,module,exports){var makeString=_dereq_('./helper/makeString');var defaultToWhiteSpace=_dereq_('./helper/defaultToWhiteSpace');var nativeTrimLeft=String.prototype.trimLeft;module.exports=function ltrim(str,characters){str=makeString(str);if(!characters&&nativeTrimLeft)return nativeTrimLeft.call(str);characters=defaultToWhiteSpace(characters);return str.replace(new RegExp('^'+characters+'+'),'');};},{"./helper/defaultToWhiteSpace":16,"./helper/makeString":20}],33:[function(_dereq_,module,exports){module.exports=function naturalCmp(str1,str2){if(str1==str2)return 0;if(!str1)return-1;if(!str2)return 1;var cmpRegex=/(\.\d+|\d+|\D+)/g,tokens1=String(str1).match(cmpRegex),tokens2=String(str2).match(cmpRegex),count=Math.min(tokens1.length,tokens2.length);for(var i=0;i<count;i++){var a=tokens1[i],b=tokens2[i];if(a!==b){var num1=+a;var num2=+b;if(num1===num1&&num2===num2){return num1>num2?1:-1;}
return a<b?-1:1;}}
if(tokens1.length!=tokens2.length)
return tokens1.length-tokens2.length;return str1<str2?-1:1;};},{}],34:[function(_dereq_,module,exports){module.exports=function numberFormat(number,dec,dsep,tsep){if(isNaN(number)||number==null)return'';number=number.toFixed(~~dec);tsep=typeof tsep=='string'?tsep:',';var parts=number.split('.'),fnums=parts[0],decimals=parts[1]?(dsep||'.')+parts[1]:'';return fnums.replace(/(\d)(?=(?:\d{3})+$)/g,'$1'+tsep)+decimals;};},{}],35:[function(_dereq_,module,exports){var makeString=_dereq_('./helper/makeString');var strRepeat=_dereq_('./helper/strRepeat');module.exports=function pad(str,length,padStr,type){str=makeString(str);length=~~length;var padlen=0;if(!padStr)
padStr=' ';else if(padStr.length>1)
padStr=padStr.charAt(0);switch(type){case'right':padlen=length-str.length;return str+strRepeat(padStr,padlen);case'both':padlen=length-str.length;return strRepeat(padStr,Math.ceil(padlen/2))+str+strRepeat(padStr,Math.floor(padlen/2));default:padlen=length-str.length;return strRepeat(padStr,padlen)+str;}};},{"./helper/makeString":20,"./helper/strRepeat":21}],36:[function(_dereq_,module,exports){var adjacent=_dereq_('./helper/adjacent');module.exports=function succ(str){return adjacent(str,-1);};},{"./helper/adjacent":15}],37:[function(_dereq_,module,exports){var makeString=_dereq_('./helper/makeString');var rtrim=_dereq_('./rtrim');module.exports=function prune(str,length,pruneStr){str=makeString(str);length=~~length;pruneStr=pruneStr!=null?String(pruneStr):'...';if(str.length<=length)return str;var tmpl=function(c){return c.toUpperCase()!==c.toLowerCase()?'A':' ';},template=str.slice(0,length+1).replace(/.(?=\W*\w*$)/g,tmpl);if(template.slice(template.length-2).match(/\w\w/))
template=template.replace(/\s*\S+$/,'');else
template=rtrim(template.slice(0,template.length-1));return(template+pruneStr).length>str.length?str:str.slice(0,template.length)+pruneStr;};},{"./helper/makeString":20,"./rtrim":43}],38:[function(_dereq_,module,exports){var surround=_dereq_('./surround');module.exports=function quote(str,quoteChar){return surround(str,quoteChar||'"');};},{"./surround":54}],39:[function(_dereq_,module,exports){var makeString=_dereq_('./helper/makeString');var strRepeat=_dereq_('./helper/strRepeat');module.exports=function repeat(str,qty,separator){str=makeString(str);qty=~~qty;if(separator==null)return strRepeat(str,qty);for(var repeat=[];qty>0;repeat[--qty]=str){}
return repeat.join(separator);};},{"./helper/makeString":20,"./helper/strRepeat":21}],40:[function(_dereq_,module,exports){var makeString=_dereq_('./helper/makeString');module.exports=function replaceAll(str,find,replace,ignorecase){var flags=(ignorecase===true)?'gi':'g';var reg=new RegExp(find,flags);return makeString(str).replace(reg,replace);};},{"./helper/makeString":20}],41:[function(_dereq_,module,exports){var chars=_dereq_('./chars');module.exports=function reverse(str){return chars(str).reverse().join('');};},{"./chars":3}],42:[function(_dereq_,module,exports){var pad=_dereq_('./pad');module.exports=function rpad(str,length,padStr){return pad(str,length,padStr,'right');};},{"./pad":35}],43:[function(_dereq_,module,exports){var makeString=_dereq_('./helper/makeString');var defaultToWhiteSpace=_dereq_('./helper/defaultToWhiteSpace');var nativeTrimRight=String.prototype.trimRight;module.exports=function rtrim(str,characters){str=makeString(str);if(!characters&&nativeTrimRight)return nativeTrimRight.call(str);characters=defaultToWhiteSpace(characters);return str.replace(new RegExp(characters+'+$'),'');};},{"./helper/defaultToWhiteSpace":16,"./helper/makeString":20}],44:[function(_dereq_,module,exports){var makeString=_dereq_('./helper/makeString');var defaultToWhiteSpace=_dereq_('./helper/defaultToWhiteSpace');var trim=_dereq_('./trim');var dasherize=_dereq_('./dasherize');module.exports=function slugify(str){var from="",to="aaaaaaaaaccceeeeeghiiiijllnnoooooooossssttuuuuuunyyczzz",regex=new RegExp(defaultToWhiteSpace(from),'g');str=makeString(str).toLowerCase().replace(regex,function(c){var index=from.indexOf(c);return to.charAt(index)||'-';});return trim(dasherize(str.replace(/[^\w\s-]/g,'-')),'-');};},{"./dasherize":8,"./helper/defaultToWhiteSpace":16,"./helper/makeString":20,"./trim":61}],45:[function(_dereq_,module,exports){var chars=_dereq_('./chars');module.exports=function splice(str,i,howmany,substr){var arr=chars(str);arr.splice(~~i,~~howmany,substr);return arr.join('');};},{"./chars":3}],46:[function(_dereq_,module,exports){var strRepeat=_dereq_('./helper/strRepeat');var toString=Object.prototype.toString;var sprintf=(function(){function get_type(variable){return toString.call(variable).slice(8,-1).toLowerCase();}
var str_repeat=strRepeat;var str_format=function(){if(!str_format.cache.hasOwnProperty(arguments[0])){str_format.cache[arguments[0]]=str_format.parse(arguments[0]);}
return str_format.format.call(null,str_format.cache[arguments[0]],arguments);};str_format.format=function(parse_tree,argv){var cursor=1,tree_length=parse_tree.length,node_type='',arg,output=[],i,k,match,pad,pad_character,pad_length;for(i=0;i<tree_length;i++){node_type=get_type(parse_tree[i]);if(node_type==='string'){output.push(parse_tree[i]);}
else if(node_type==='array'){match=parse_tree[i];if(match[2]){arg=argv[cursor];for(k=0;k<match[2].length;k++){if(!arg.hasOwnProperty(match[2][k])){throw new Error(sprintf('[_.sprintf] property "%s" does not exist',match[2][k]));}
arg=arg[match[2][k]];}}else if(match[1]){arg=argv[match[1]];}
else{arg=argv[cursor++];}
if(/[^s]/.test(match[8])&&(get_type(arg)!='number')){throw new Error(sprintf('[_.sprintf] expecting number but found %s',get_type(arg)));}
switch(match[8]){case'b':arg=arg.toString(2);break;case'c':arg=String.fromCharCode(arg);break;case'd':arg=parseInt(arg,10);break;case'e':arg=match[7]?arg.toExponential(match[7]):arg.toExponential();break;case'f':arg=match[7]?parseFloat(arg).toFixed(match[7]):parseFloat(arg);break;case'o':arg=arg.toString(8);break;case's':arg=((arg=String(arg))&&match[7]?arg.substring(0,match[7]):arg);break;case'u':arg=Math.abs(arg);break;case'x':arg=arg.toString(16);break;case'X':arg=arg.toString(16).toUpperCase();break;}
arg=(/[def]/.test(match[8])&&match[3]&&arg>=0?'+'+arg:arg);pad_character=match[4]?match[4]=='0'?'0':match[4].charAt(1):' ';pad_length=match[6]-String(arg).length;pad=match[6]?str_repeat(pad_character,pad_length):'';output.push(match[5]?arg+pad:pad+arg);}}
return output.join('');};str_format.cache={};str_format.parse=function(fmt){var _fmt=fmt,match=[],parse_tree=[],arg_names=0;while(_fmt){if((match=/^[^\x25]+/.exec(_fmt))!==null){parse_tree.push(match[0]);}
else if((match=/^\x25{2}/.exec(_fmt))!==null){parse_tree.push('%');}
else if((match=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(_fmt))!==null){if(match[2]){arg_names|=1;var field_list=[],replacement_field=match[2],field_match=[];if((field_match=/^([a-z_][a-z_\d]*)/i.exec(replacement_field))!==null){field_list.push(field_match[1]);while((replacement_field=replacement_field.substring(field_match[0].length))!==''){if((field_match=/^\.([a-z_][a-z_\d]*)/i.exec(replacement_field))!==null){field_list.push(field_match[1]);}
else if((field_match=/^\[(\d+)\]/.exec(replacement_field))!==null){field_list.push(field_match[1]);}
else{throw new Error('[_.sprintf] huh?');}}}
else{throw new Error('[_.sprintf] huh?');}
match[2]=field_list;}
else{arg_names|=2;}
if(arg_names===3){throw new Error('[_.sprintf] mixing positional and named placeholders is not (yet) supported');}
parse_tree.push(match);}
else{throw new Error('[_.sprintf] huh?');}
_fmt=_fmt.substring(match[0].length);}
return parse_tree;};return str_format;})();module.exports=sprintf;},{"./helper/strRepeat":21}],47:[function(_dereq_,module,exports){var makeString=_dereq_('./helper/makeString');var toPositive=_dereq_('./helper/toPositive');module.exports=function startsWith(str,starts,position){str=makeString(str);starts=''+starts;position=position==null?0:Math.min(toPositive(position),str.length);return str.lastIndexOf(starts,position)===position;};},{"./helper/makeString":20,"./helper/toPositive":22}],48:[function(_dereq_,module,exports){var makeString=_dereq_('./helper/makeString');module.exports=function strLeft(str,sep){str=makeString(str);sep=makeString(sep);var pos=!sep?-1:str.indexOf(sep);return~pos?str.slice(0,pos):str;};},{"./helper/makeString":20}],49:[function(_dereq_,module,exports){var makeString=_dereq_('./helper/makeString');module.exports=function strLeftBack(str,sep){str=makeString(str);sep=makeString(sep);var pos=str.lastIndexOf(sep);return~pos?str.slice(0,pos):str;};},{"./helper/makeString":20}],50:[function(_dereq_,module,exports){var makeString=_dereq_('./helper/makeString');module.exports=function strRight(str,sep){str=makeString(str);sep=makeString(sep);var pos=!sep?-1:str.indexOf(sep);return~pos?str.slice(pos+sep.length,str.length):str;};},{"./helper/makeString":20}],51:[function(_dereq_,module,exports){var makeString=_dereq_('./helper/makeString');module.exports=function strRightBack(str,sep){str=makeString(str);sep=makeString(sep);var pos=!sep?-1:str.lastIndexOf(sep);return~pos?str.slice(pos+sep.length,str.length):str;};},{"./helper/makeString":20}],52:[function(_dereq_,module,exports){var makeString=_dereq_('./helper/makeString');module.exports=function stripTags(str){return makeString(str).replace(/<\/?[^>]+>/g,'');};},{"./helper/makeString":20}],53:[function(_dereq_,module,exports){var adjacent=_dereq_('./helper/adjacent');module.exports=function succ(str){return adjacent(str,1);};},{"./helper/adjacent":15}],54:[function(_dereq_,module,exports){module.exports=function surround(str,wrapper){return[wrapper,str,wrapper].join('');};},{}],55:[function(_dereq_,module,exports){var makeString=_dereq_('./helper/makeString');module.exports=function swapCase(str){return makeString(str).replace(/\S/g,function(c){return c===c.toUpperCase()?c.toLowerCase():c.toUpperCase();});};},{"./helper/makeString":20}],56:[function(_dereq_,module,exports){var makeString=_dereq_('./helper/makeString');module.exports=function titleize(str){return makeString(str).toLowerCase().replace(/(?:^|\s|-)\S/g,function(c){return c.toUpperCase();});};},{"./helper/makeString":20}],57:[function(_dereq_,module,exports){var trim=_dereq_('./trim');function boolMatch(s,matchers){var i,matcher,down=s.toLowerCase();matchers=[].concat(matchers);for(i=0;i<matchers.length;i+=1){matcher=matchers[i];if(!matcher)continue;if(matcher.test&&matcher.test(s))return true;if(matcher.toLowerCase()===down)return true;}}
module.exports=function toBoolean(str,trueValues,falseValues){if(typeof str==="number")str=""+str;if(typeof str!=="string")return!!str;str=trim(str);if(boolMatch(str,trueValues||["true","1"]))return true;if(boolMatch(str,falseValues||["false","0"]))return false;};},{"./trim":61}],58:[function(_dereq_,module,exports){var trim=_dereq_('./trim');module.exports=function toNumber(num,precision){if(num==null)return 0;var factor=Math.pow(10,isFinite(precision)?precision:0);return Math.round(num*factor)/factor;};},{"./trim":61}],59:[function(_dereq_,module,exports){var rtrim=_dereq_('./rtrim');module.exports=function toSentence(array,separator,lastSeparator,serial){separator=separator||', ';lastSeparator=lastSeparator||' and ';var a=array.slice(),lastMember=a.pop();if(array.length>2&&serial)lastSeparator=rtrim(separator)+lastSeparator;return a.length?a.join(separator)+lastSeparator+lastMember:lastMember;};},{"./rtrim":43}],60:[function(_dereq_,module,exports){var toSentence=_dereq_('./toSentence');module.exports=function toSentenceSerial(array,sep,lastSep){return toSentence(array,sep,lastSep,true);};},{"./toSentence":59}],61:[function(_dereq_,module,exports){var makeString=_dereq_('./helper/makeString');var defaultToWhiteSpace=_dereq_('./helper/defaultToWhiteSpace');var nativeTrim=String.prototype.trim;module.exports=function trim(str,characters){str=makeString(str);if(!characters&&nativeTrim)return nativeTrim.call(str);characters=defaultToWhiteSpace(characters);return str.replace(new RegExp('^'+characters+'+|'+characters+'+$','g'),'');};},{"./helper/defaultToWhiteSpace":16,"./helper/makeString":20}],62:[function(_dereq_,module,exports){var makeString=_dereq_('./helper/makeString');module.exports=function truncate(str,length,truncateStr){str=makeString(str);truncateStr=truncateStr||'...';length=~~length;return str.length>length?str.slice(0,length)+truncateStr:str;};},{"./helper/makeString":20}],63:[function(_dereq_,module,exports){var trim=_dereq_('./trim');module.exports=function underscored(str){return trim(str).replace(/([a-z\d])([A-Z]+)/g,'$1_$2').replace(/[-\s]+/g,'_').toLowerCase();};},{"./trim":61}],64:[function(_dereq_,module,exports){var makeString=_dereq_('./helper/makeString');var htmlEntities=_dereq_('./helper/htmlEntities');module.exports=function unescapeHTML(str){return makeString(str).replace(/\&([^;]+);/g,function(entity,entityCode){var match;if(entityCode in htmlEntities){return htmlEntities[entityCode];}else if(match=entityCode.match(/^#x([\da-fA-F]+)$/)){return String.fromCharCode(parseInt(match[1],16));}else if(match=entityCode.match(/^#(\d+)$/)){return String.fromCharCode(~~match[1]);}else{return entity;}});};},{"./helper/htmlEntities":19,"./helper/makeString":20}],65:[function(_dereq_,module,exports){module.exports=function unquote(str,quoteChar){quoteChar=quoteChar||'"';if(str[0]===quoteChar&&str[str.length-1]===quoteChar)
return str.slice(1,str.length-1);else return str;};},{}],66:[function(_dereq_,module,exports){var sprintf=_dereq_('./sprintf');module.exports=function vsprintf(fmt,argv){argv.unshift(fmt);return sprintf.apply(null,argv);};},{"./sprintf":46}],67:[function(_dereq_,module,exports){var isBlank=_dereq_('./isBlank');var trim=_dereq_('./trim');module.exports=function words(str,delimiter){if(isBlank(str))return[];return trim(str,delimiter).split(delimiter||/\s+/);};},{"./isBlank":26,"./trim":61}]},{},[14])
(14)});define('text',['module'],function(module){'use strict';var text,fs,Cc,Ci,xpcIsWindows,progIds=['Msxml2.XMLHTTP','Microsoft.XMLHTTP','Msxml2.XMLHTTP.4.0'],xmlRegExp=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,bodyRegExp=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,hasLocation=typeof location!=='undefined'&&location.href,defaultProtocol=hasLocation&&location.protocol&&location.protocol.replace(/\:/,''),defaultHostName=hasLocation&&location.hostname,defaultPort=hasLocation&&(location.port||undefined),buildMap={},masterConfig=(module.config&&module.config())||{};function useDefault(value,defaultValue){return value===undefined||value===''?defaultValue:value;}
function isSamePort(protocol1,port1,protocol2,port2){if(port1===port2){return true;}else if(protocol1===protocol2){if(protocol1==='http'){return useDefault(port1,'80')===useDefault(port2,'80');}else if(protocol1==='https'){return useDefault(port1,'443')===useDefault(port2,'443');}}
return false;}
text={version:'2.0.16',strip:function(content){if(content){content=content.replace(xmlRegExp,"");var matches=content.match(bodyRegExp);if(matches){content=matches[1];}}else{content="";}
return content;},jsEscape:function(content){return content.replace(/(['\\])/g,'\\$1').replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029");},createXhr:masterConfig.createXhr||function(){var xhr,i,progId;if(typeof XMLHttpRequest!=="undefined"){return new XMLHttpRequest();}else if(typeof ActiveXObject!=="undefined"){for(i=0;i<3;i+=1){progId=progIds[i];try{xhr=new ActiveXObject(progId);}catch(e){}
if(xhr){progIds=[progId];break;}}}
return xhr;},parseName:function(name){var modName,ext,temp,strip=false,index=name.lastIndexOf("."),isRelative=name.indexOf('./')===0||name.indexOf('../')===0;if(index!==-1&&(!isRelative||index>1)){modName=name.substring(0,index);ext=name.substring(index+1);}else{modName=name;}
temp=ext||modName;index=temp.indexOf("!");if(index!==-1){strip=temp.substring(index+1)==="strip";temp=temp.substring(0,index);if(ext){ext=temp;}else{modName=temp;}}
return{moduleName:modName,ext:ext,strip:strip};},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(url,protocol,hostname,port){var uProtocol,uHostName,uPort,match=text.xdRegExp.exec(url);if(!match){return true;}
uProtocol=match[2];uHostName=match[3];uHostName=uHostName.split(':');uPort=uHostName[1];uHostName=uHostName[0];return(!uProtocol||uProtocol===protocol)&&(!uHostName||uHostName.toLowerCase()===hostname.toLowerCase())&&((!uPort&&!uHostName)||isSamePort(uProtocol,uPort,protocol,port));},finishLoad:function(name,strip,content,onLoad){content=strip?text.strip(content):content;if(masterConfig.isBuild){buildMap[name]=content;}
onLoad(content);},load:function(name,req,onLoad,config){if(config&&config.isBuild&&!config.inlineText){onLoad();return;}
masterConfig.isBuild=config&&config.isBuild;var parsed=text.parseName(name),nonStripName=parsed.moduleName+
(parsed.ext?'.'+parsed.ext:''),url=req.toUrl(nonStripName),useXhr=(masterConfig.useXhr)||text.useXhr;if(url.indexOf('empty:')===0){onLoad();return;}
if(!hasLocation||useXhr(url,defaultProtocol,defaultHostName,defaultPort)){text.get(url,function(content){text.finishLoad(name,parsed.strip,content,onLoad);},function(err){if(onLoad.error){onLoad.error(err);}});}else{req([nonStripName],function(content){text.finishLoad(parsed.moduleName+'.'+parsed.ext,parsed.strip,content,onLoad);},function(err){if(onLoad.error){onLoad.error(err);}});}},write:function(pluginName,moduleName,write,config){if(buildMap.hasOwnProperty(moduleName)){var content=text.jsEscape(buildMap[moduleName]);write.asModule(pluginName+"!"+moduleName,"define(function () { return '"+
content+"';});\n");}},writeFile:function(pluginName,moduleName,req,write,config){var parsed=text.parseName(moduleName),extPart=parsed.ext?'.'+parsed.ext:'',nonStripName=parsed.moduleName+extPart,fileName=req.toUrl(parsed.moduleName+extPart)+'.js';text.load(nonStripName,req,function(value){var textWrite=function(contents){return write(fileName,contents);};textWrite.asModule=function(moduleName,contents){return write.asModule(moduleName,fileName,contents);};text.write(pluginName,nonStripName,textWrite,config);},config);}};if(masterConfig.env==='node'||(!masterConfig.env&&typeof process!=="undefined"&&process.versions&&!!process.versions.node&&!process.versions['node-webkit']&&!process.versions['atom-shell'])){fs=require.nodeRequire('fs');text.get=function(url,callback,errback){try{var file=fs.readFileSync(url,'utf8');if(file[0]==='\uFEFF'){file=file.substring(1);}
callback(file);}catch(e){if(errback){errback(e);}}};}else if(masterConfig.env==='xhr'||(!masterConfig.env&&text.createXhr())){text.get=function(url,callback,errback,headers){var xhr=text.createXhr(),header;xhr.open('GET',url,true);if(headers){for(header in headers){if(headers.hasOwnProperty(header)){xhr.setRequestHeader(header.toLowerCase(),headers[header]);}}}
if(masterConfig.onXhr){masterConfig.onXhr(xhr,url);}
xhr.onreadystatechange=function(evt){var status,err;if(xhr.readyState===4){status=xhr.status||0;if(status>399&&status<600){err=new Error(url+' HTTP status: '+status);err.xhr=xhr;if(errback){errback(err);}}else{callback(xhr.responseText);}
if(masterConfig.onXhrComplete){masterConfig.onXhrComplete(xhr,url);}}};xhr.send(null);};}else if(masterConfig.env==='rhino'||(!masterConfig.env&&typeof Packages!=='undefined'&&typeof java!=='undefined')){text.get=function(url,callback){var stringBuffer,line,encoding="utf-8",file=new java.io.File(url),lineSeparator=java.lang.System.getProperty("line.separator"),input=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(file),encoding)),content='';try{stringBuffer=new java.lang.StringBuffer();line=input.readLine();if(line&&line.length()&&line.charAt(0)===0xfeff){line=line.substring(1);}
if(line!==null){stringBuffer.append(line);}
while((line=input.readLine())!==null){stringBuffer.append(lineSeparator);stringBuffer.append(line);}
content=String(stringBuffer.toString());}finally{input.close();}
callback(content);};}else if(masterConfig.env==='xpconnect'||(!masterConfig.env&&typeof Components!=='undefined'&&Components.classes&&Components.interfaces)){Cc=Components.classes;Ci=Components.interfaces;Components.utils['import']('resource://gre/modules/FileUtils.jsm');xpcIsWindows=('@mozilla.org/windows-registry-key;1'in Cc);text.get=function(url,callback){var inStream,convertStream,fileObj,readData={};if(xpcIsWindows){url=url.replace(/\//g,'\\');}
fileObj=new FileUtils.File(url);try{inStream=Cc['@mozilla.org/network/file-input-stream;1'].createInstance(Ci.nsIFileInputStream);inStream.init(fileObj,1,0,false);convertStream=Cc['@mozilla.org/intl/converter-input-stream;1'].createInstance(Ci.nsIConverterInputStream);convertStream.init(inStream,"utf-8",inStream.available(),Ci.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER);convertStream.readString(inStream.available(),readData);convertStream.close();inStream.close();callback(readData.value);}catch(e){throw new Error((fileObj&&fileObj.path||'')+': '+e);}};}
return text;});define('text!templates/course_list.html',[],function(){return'<div class="page-header">\n    <h1 class="hd-1 emphasized">\n        <%- gettext(\'Courses\') %>\n        <div class="pull-right">\n            <a href="/courses/new/" class="btn btn-primary btn-small"><%- gettext(\'Add New Course\') %></a>\n        </div>\n    </h1>\n</div>\n\n<table id="courseTable" class="copy copy-base table table-striped table-bordered" cellspacing="0">\n    <caption class="sr-only">Current Courses</caption>\n</table>\n';});/*! DataTables 1.10.10
 * 2008-2015 SpryMedia Ltd - datatables.net/license
 */(function(factory){"use strict";if(typeof define==='function'&&define.amd){define('datatables.net',['jquery'],function($){return factory($,window,document);});}
else if(typeof exports==='object'){module.exports=function(root,$){if(!root){root=window;}
if(!$){$=typeof window!=='undefined'?require('jquery'):require('jquery')(root);}
return factory($,root,root.document);};}
else{factory(jQuery,window,document);}}
(function($,window,document,undefined){"use strict";var DataTable;var _ext;var _Api;var _api_register;var _api_registerPlural;var _re_dic={};var _re_new_lines=/[\r\n]/g;var _re_html=/<.*?>/g;var _re_date_start=/^[\w\+\-]/;var _re_date_end=/[\w\+\-]$/;var _re_escape_regex=new RegExp('(\\'+['/','.','*','+','?','|','(',')','[',']','{','}','\\','$','^','-'].join('|\\')+')','g');var _re_formatted_numeric=/[',$%\u2009\u202F\u20BD\u20a9\u20BArfk]/gi;var _empty=function(d){return!d||d===true||d==='-'?true:false;};var _intVal=function(s){var integer=parseInt(s,10);return!isNaN(integer)&&isFinite(s)?integer:null;};var _numToDecimal=function(num,decimalPoint){if(!_re_dic[decimalPoint]){_re_dic[decimalPoint]=new RegExp(_fnEscapeRegex(decimalPoint),'g');}
return typeof num==='string'&&decimalPoint!=='.'?num.replace(/\./g,'').replace(_re_dic[decimalPoint],'.'):num;};var _isNumber=function(d,decimalPoint,formatted){var strType=typeof d==='string';if(_empty(d)){return true;}
if(decimalPoint&&strType){d=_numToDecimal(d,decimalPoint);}
if(formatted&&strType){d=d.replace(_re_formatted_numeric,'');}
return!isNaN(parseFloat(d))&&isFinite(d);};var _isHtml=function(d){return _empty(d)||typeof d==='string';};var _htmlNumeric=function(d,decimalPoint,formatted){if(_empty(d)){return true;}
var html=_isHtml(d);return!html?null:_isNumber(_stripHtml(d),decimalPoint,formatted)?true:null;};var _pluck=function(a,prop,prop2){var out=[];var i=0,ien=a.length;if(prop2!==undefined){for(;i<ien;i++){if(a[i]&&a[i][prop]){out.push(a[i][prop][prop2]);}}}
else{for(;i<ien;i++){if(a[i]){out.push(a[i][prop]);}}}
return out;};var _pluck_order=function(a,order,prop,prop2)
{var out=[];var i=0,ien=order.length;if(prop2!==undefined){for(;i<ien;i++){if(a[order[i]][prop]){out.push(a[order[i]][prop][prop2]);}}}
else{for(;i<ien;i++){out.push(a[order[i]][prop]);}}
return out;};var _range=function(len,start)
{var out=[];var end;if(start===undefined){start=0;end=len;}
else{end=start;start=len;}
for(var i=start;i<end;i++){out.push(i);}
return out;};var _removeEmpty=function(a)
{var out=[];for(var i=0,ien=a.length;i<ien;i++){if(a[i]){out.push(a[i]);}}
return out;};var _stripHtml=function(d){return d.replace(_re_html,'');};var _unique=function(src)
{var
out=[],val,i,ien=src.length,j,k=0;again:for(i=0;i<ien;i++){val=src[i];for(j=0;j<k;j++){if(out[j]===val){continue again;}}
out.push(val);k++;}
return out;};function _fnHungarianMap(o)
{var
hungarian='a aa ai ao as b fn i m o s ',match,newKey,map={};$.each(o,function(key,val){match=key.match(/^([^A-Z]+?)([A-Z])/);if(match&&hungarian.indexOf(match[1]+' ')!==-1)
{newKey=key.replace(match[0],match[2].toLowerCase());map[newKey]=key;if(match[1]==='o')
{_fnHungarianMap(o[key]);}}});o._hungarianMap=map;}
function _fnCamelToHungarian(src,user,force)
{if(!src._hungarianMap){_fnHungarianMap(src);}
var hungarianKey;$.each(user,function(key,val){hungarianKey=src._hungarianMap[key];if(hungarianKey!==undefined&&(force||user[hungarianKey]===undefined))
{if(hungarianKey.charAt(0)==='o')
{if(!user[hungarianKey]){user[hungarianKey]={};}
$.extend(true,user[hungarianKey],user[key]);_fnCamelToHungarian(src[hungarianKey],user[hungarianKey],force);}
else{user[hungarianKey]=user[key];}}});}
function _fnLanguageCompat(lang)
{var defaults=DataTable.defaults.oLanguage;var zeroRecords=lang.sZeroRecords;if(!lang.sEmptyTable&&zeroRecords&&defaults.sEmptyTable==="No data available in table")
{_fnMap(lang,lang,'sZeroRecords','sEmptyTable');}
if(!lang.sLoadingRecords&&zeroRecords&&defaults.sLoadingRecords==="Loading...")
{_fnMap(lang,lang,'sZeroRecords','sLoadingRecords');}
if(lang.sInfoThousands){lang.sThousands=lang.sInfoThousands;}
var decimal=lang.sDecimal;if(decimal){_addNumericSort(decimal);}}
var _fnCompatMap=function(o,knew,old){if(o[knew]!==undefined){o[old]=o[knew];}};function _fnCompatOpts(init)
{_fnCompatMap(init,'ordering','bSort');_fnCompatMap(init,'orderMulti','bSortMulti');_fnCompatMap(init,'orderClasses','bSortClasses');_fnCompatMap(init,'orderCellsTop','bSortCellsTop');_fnCompatMap(init,'order','aaSorting');_fnCompatMap(init,'orderFixed','aaSortingFixed');_fnCompatMap(init,'paging','bPaginate');_fnCompatMap(init,'pagingType','sPaginationType');_fnCompatMap(init,'pageLength','iDisplayLength');_fnCompatMap(init,'searching','bFilter');if(typeof init.sScrollX==='boolean'){init.sScrollX=init.sScrollX?'100%':'';}
if(typeof init.scrollX==='boolean'){init.scrollX=init.scrollX?'100%':'';}
var searchCols=init.aoSearchCols;if(searchCols){for(var i=0,ien=searchCols.length;i<ien;i++){if(searchCols[i]){_fnCamelToHungarian(DataTable.models.oSearch,searchCols[i]);}}}}
function _fnCompatCols(init)
{_fnCompatMap(init,'orderable','bSortable');_fnCompatMap(init,'orderData','aDataSort');_fnCompatMap(init,'orderSequence','asSorting');_fnCompatMap(init,'orderDataType','sortDataType');var dataSort=init.aDataSort;if(dataSort&&!$.isArray(dataSort)){init.aDataSort=[dataSort];}}
function _fnBrowserDetect(settings)
{if(!DataTable.__browser){var browser={};DataTable.__browser=browser;var n=$('<div/>').css({position:'fixed',top:0,left:0,height:1,width:1,overflow:'hidden'}).append($('<div/>').css({position:'absolute',top:1,left:1,width:100,overflow:'scroll'}).append($('<div/>').css({width:'100%',height:10}))).appendTo('body');var outer=n.children();var inner=outer.children();browser.barWidth=outer[0].offsetWidth-outer[0].clientWidth;browser.bScrollOversize=inner[0].offsetWidth===100&&outer[0].clientWidth!==100;browser.bScrollbarLeft=Math.round(inner.offset().left)!==1;browser.bBounding=n[0].getBoundingClientRect().width?true:false;n.remove();}
$.extend(settings.oBrowser,DataTable.__browser);settings.oScroll.iBarWidth=DataTable.__browser.barWidth;}
function _fnReduce(that,fn,init,start,end,inc)
{var
i=start,value,isSet=false;if(init!==undefined){value=init;isSet=true;}
while(i!==end){if(!that.hasOwnProperty(i)){continue;}
value=isSet?fn(value,that[i],i,that):that[i];isSet=true;i+=inc;}
return value;}
function _fnAddColumn(oSettings,nTh)
{var oDefaults=DataTable.defaults.column;var iCol=oSettings.aoColumns.length;var oCol=$.extend({},DataTable.models.oColumn,oDefaults,{"nTh":nTh?nTh:document.createElement('th'),"sTitle":oDefaults.sTitle?oDefaults.sTitle:nTh?nTh.innerHTML:'',"aDataSort":oDefaults.aDataSort?oDefaults.aDataSort:[iCol],"mData":oDefaults.mData?oDefaults.mData:iCol,idx:iCol});oSettings.aoColumns.push(oCol);var searchCols=oSettings.aoPreSearchCols;searchCols[iCol]=$.extend({},DataTable.models.oSearch,searchCols[iCol]);_fnColumnOptions(oSettings,iCol,$(nTh).data());}
function _fnColumnOptions(oSettings,iCol,oOptions)
{var oCol=oSettings.aoColumns[iCol];var oClasses=oSettings.oClasses;var th=$(oCol.nTh);if(!oCol.sWidthOrig){oCol.sWidthOrig=th.attr('width')||null;var t=(th.attr('style')||'').match(/width:\s*(\d+[pxem%]+)/);if(t){oCol.sWidthOrig=t[1];}}
if(oOptions!==undefined&&oOptions!==null)
{_fnCompatCols(oOptions);_fnCamelToHungarian(DataTable.defaults.column,oOptions);if(oOptions.mDataProp!==undefined&&!oOptions.mData)
{oOptions.mData=oOptions.mDataProp;}
if(oOptions.sType)
{oCol._sManualType=oOptions.sType;}
if(oOptions.className&&!oOptions.sClass)
{oOptions.sClass=oOptions.className;}
$.extend(oCol,oOptions);_fnMap(oCol,oOptions,"sWidth","sWidthOrig");if(oOptions.iDataSort!==undefined)
{oCol.aDataSort=[oOptions.iDataSort];}
_fnMap(oCol,oOptions,"aDataSort");}
var mDataSrc=oCol.mData;var mData=_fnGetObjectDataFn(mDataSrc);var mRender=oCol.mRender?_fnGetObjectDataFn(oCol.mRender):null;var attrTest=function(src){return typeof src==='string'&&src.indexOf('@')!==-1;};oCol._bAttrSrc=$.isPlainObject(mDataSrc)&&(attrTest(mDataSrc.sort)||attrTest(mDataSrc.type)||attrTest(mDataSrc.filter));oCol.fnGetData=function(rowData,type,meta){var innerData=mData(rowData,type,undefined,meta);return mRender&&type?mRender(innerData,type,rowData,meta):innerData;};oCol.fnSetData=function(rowData,val,meta){return _fnSetObjectDataFn(mDataSrc)(rowData,val,meta);};if(typeof mDataSrc!=='number'){oSettings._rowReadObject=true;}
if(!oSettings.oFeatures.bSort)
{oCol.bSortable=false;th.addClass(oClasses.sSortableNone);}
var bAsc=$.inArray('asc',oCol.asSorting)!==-1;var bDesc=$.inArray('desc',oCol.asSorting)!==-1;if(!oCol.bSortable||(!bAsc&&!bDesc))
{oCol.sSortingClass=oClasses.sSortableNone;oCol.sSortingClassJUI="";}
else if(bAsc&&!bDesc)
{oCol.sSortingClass=oClasses.sSortableAsc;oCol.sSortingClassJUI=oClasses.sSortJUIAscAllowed;}
else if(!bAsc&&bDesc)
{oCol.sSortingClass=oClasses.sSortableDesc;oCol.sSortingClassJUI=oClasses.sSortJUIDescAllowed;}
else
{oCol.sSortingClass=oClasses.sSortable;oCol.sSortingClassJUI=oClasses.sSortJUI;}}
function _fnAdjustColumnSizing(settings)
{if(settings.oFeatures.bAutoWidth!==false)
{var columns=settings.aoColumns;_fnCalculateColumnWidths(settings);for(var i=0,iLen=columns.length;i<iLen;i++)
{columns[i].nTh.style.width=columns[i].sWidth;}}
var scroll=settings.oScroll;if(scroll.sY!==''||scroll.sX!=='')
{_fnScrollDraw(settings);}
_fnCallbackFire(settings,null,'column-sizing',[settings]);}
function _fnVisibleToColumnIndex(oSettings,iMatch)
{var aiVis=_fnGetColumns(oSettings,'bVisible');return typeof aiVis[iMatch]==='number'?aiVis[iMatch]:null;}
function _fnColumnIndexToVisible(oSettings,iMatch)
{var aiVis=_fnGetColumns(oSettings,'bVisible');var iPos=$.inArray(iMatch,aiVis);return iPos!==-1?iPos:null;}
function _fnVisbleColumns(oSettings)
{return _fnGetColumns(oSettings,'bVisible').length;}
function _fnGetColumns(oSettings,sParam)
{var a=[];$.map(oSettings.aoColumns,function(val,i){if(val[sParam]){a.push(i);}});return a;}
function _fnColumnTypes(settings)
{var columns=settings.aoColumns;var data=settings.aoData;var types=DataTable.ext.type.detect;var i,ien,j,jen,k,ken;var col,cell,detectedType,cache;for(i=0,ien=columns.length;i<ien;i++){col=columns[i];cache=[];if(!col.sType&&col._sManualType){col.sType=col._sManualType;}
else if(!col.sType){for(j=0,jen=types.length;j<jen;j++){for(k=0,ken=data.length;k<ken;k++){if(cache[k]===undefined){cache[k]=_fnGetCellData(settings,k,i,'type');}
detectedType=types[j](cache[k],settings);if(!detectedType&&j!==types.length-1){break;}
if(detectedType==='html'){break;}}
if(detectedType){col.sType=detectedType;break;}}
if(!col.sType){col.sType='string';}}}}
function _fnApplyColumnDefs(oSettings,aoColDefs,aoCols,fn)
{var i,iLen,j,jLen,k,kLen,def;var columns=oSettings.aoColumns;if(aoColDefs)
{for(i=aoColDefs.length-1;i>=0;i--)
{def=aoColDefs[i];var aTargets=def.targets!==undefined?def.targets:def.aTargets;if(!$.isArray(aTargets))
{aTargets=[aTargets];}
for(j=0,jLen=aTargets.length;j<jLen;j++)
{if(typeof aTargets[j]==='number'&&aTargets[j]>=0)
{while(columns.length<=aTargets[j])
{_fnAddColumn(oSettings);}
fn(aTargets[j],def);}
else if(typeof aTargets[j]==='number'&&aTargets[j]<0)
{fn(columns.length+aTargets[j],def);}
else if(typeof aTargets[j]==='string')
{for(k=0,kLen=columns.length;k<kLen;k++)
{if(aTargets[j]=="_all"||$(columns[k].nTh).hasClass(aTargets[j]))
{fn(k,def);}}}}}}
if(aoCols)
{for(i=0,iLen=aoCols.length;i<iLen;i++)
{fn(i,aoCols[i]);}}}
function _fnAddData(oSettings,aDataIn,nTr,anTds)
{var iRow=oSettings.aoData.length;var oData=$.extend(true,{},DataTable.models.oRow,{src:nTr?'dom':'data',idx:iRow});oData._aData=aDataIn;oSettings.aoData.push(oData);var nTd,sThisType;var columns=oSettings.aoColumns;for(var i=0,iLen=columns.length;i<iLen;i++)
{columns[i].sType=null;}
oSettings.aiDisplayMaster.push(iRow);var id=oSettings.rowIdFn(aDataIn);if(id!==undefined){oSettings.aIds[id]=oData;}
if(nTr||!oSettings.oFeatures.bDeferRender)
{_fnCreateTr(oSettings,iRow,nTr,anTds);}
return iRow;}
function _fnAddTr(settings,trs)
{var row;if(!(trs instanceof $)){trs=$(trs);}
return trs.map(function(i,el){row=_fnGetRowElements(settings,el);return _fnAddData(settings,row.data,el,row.cells);});}
function _fnNodeToDataIndex(oSettings,n)
{return(n._DT_RowIndex!==undefined)?n._DT_RowIndex:null;}
function _fnNodeToColumnIndex(oSettings,iRow,n)
{return $.inArray(n,oSettings.aoData[iRow].anCells);}
function _fnGetCellData(settings,rowIdx,colIdx,type)
{var draw=settings.iDraw;var col=settings.aoColumns[colIdx];var rowData=settings.aoData[rowIdx]._aData;var defaultContent=col.sDefaultContent;var cellData=col.fnGetData(rowData,type,{settings:settings,row:rowIdx,col:colIdx});if(cellData===undefined){if(settings.iDrawError!=draw&&defaultContent===null){_fnLog(settings,0,"Requested unknown parameter "+
(typeof col.mData=='function'?'{function}':"'"+col.mData+"'")+" for row "+rowIdx+", column "+colIdx,4);settings.iDrawError=draw;}
return defaultContent;}
if((cellData===rowData||cellData===null)&&defaultContent!==null){cellData=defaultContent;}
else if(typeof cellData==='function'){return cellData.call(rowData);}
if(cellData===null&&type=='display'){return'';}
return cellData;}
function _fnSetCellData(settings,rowIdx,colIdx,val)
{var col=settings.aoColumns[colIdx];var rowData=settings.aoData[rowIdx]._aData;col.fnSetData(rowData,val,{settings:settings,row:rowIdx,col:colIdx});}
var __reArray=/\[.*?\]$/;var __reFn=/\(\)$/;function _fnSplitObjNotation(str)
{return $.map(str.match(/(\\.|[^\.])+/g)||[''],function(s){return s.replace(/\\./g,'.');});}
function _fnGetObjectDataFn(mSource)
{if($.isPlainObject(mSource))
{var o={};$.each(mSource,function(key,val){if(val){o[key]=_fnGetObjectDataFn(val);}});return function(data,type,row,meta){var t=o[type]||o._;return t!==undefined?t(data,type,row,meta):data;};}
else if(mSource===null)
{return function(data){return data;};}
else if(typeof mSource==='function')
{return function(data,type,row,meta){return mSource(data,type,row,meta);};}
else if(typeof mSource==='string'&&(mSource.indexOf('.')!==-1||mSource.indexOf('[')!==-1||mSource.indexOf('(')!==-1))
{var fetchData=function(data,type,src){var arrayNotation,funcNotation,out,innerSrc;if(src!=="")
{var a=_fnSplitObjNotation(src);for(var i=0,iLen=a.length;i<iLen;i++)
{arrayNotation=a[i].match(__reArray);funcNotation=a[i].match(__reFn);if(arrayNotation)
{a[i]=a[i].replace(__reArray,'');if(a[i]!==""){data=data[a[i]];}
out=[];a.splice(0,i+1);innerSrc=a.join('.');if($.isArray(data)){for(var j=0,jLen=data.length;j<jLen;j++){out.push(fetchData(data[j],type,innerSrc));}}
var join=arrayNotation[0].substring(1,arrayNotation[0].length-1);data=(join==="")?out:out.join(join);break;}
else if(funcNotation)
{a[i]=a[i].replace(__reFn,'');data=data[a[i]]();continue;}
if(data===null||data[a[i]]===undefined)
{return undefined;}
data=data[a[i]];}}
return data;};return function(data,type){return fetchData(data,type,mSource);};}
else
{return function(data,type){return data[mSource];};}}
function _fnSetObjectDataFn(mSource)
{if($.isPlainObject(mSource))
{return _fnSetObjectDataFn(mSource._);}
else if(mSource===null)
{return function(){};}
else if(typeof mSource==='function')
{return function(data,val,meta){mSource(data,'set',val,meta);};}
else if(typeof mSource==='string'&&(mSource.indexOf('.')!==-1||mSource.indexOf('[')!==-1||mSource.indexOf('(')!==-1))
{var setData=function(data,val,src){var a=_fnSplitObjNotation(src),b;var aLast=a[a.length-1];var arrayNotation,funcNotation,o,innerSrc;for(var i=0,iLen=a.length-1;i<iLen;i++)
{arrayNotation=a[i].match(__reArray);funcNotation=a[i].match(__reFn);if(arrayNotation)
{a[i]=a[i].replace(__reArray,'');data[a[i]]=[];b=a.slice();b.splice(0,i+1);innerSrc=b.join('.');if($.isArray(val))
{for(var j=0,jLen=val.length;j<jLen;j++)
{o={};setData(o,val[j],innerSrc);data[a[i]].push(o);}}
else
{data[a[i]]=val;}
return;}
else if(funcNotation)
{a[i]=a[i].replace(__reFn,'');data=data[a[i]](val);}
if(data[a[i]]===null||data[a[i]]===undefined)
{data[a[i]]={};}
data=data[a[i]];}
if(aLast.match(__reFn))
{data=data[aLast.replace(__reFn,'')](val);}
else
{data[aLast.replace(__reArray,'')]=val;}};return function(data,val){return setData(data,val,mSource);};}
else
{return function(data,val){data[mSource]=val;};}}
function _fnGetDataMaster(settings)
{return _pluck(settings.aoData,'_aData');}
function _fnClearTable(settings)
{settings.aoData.length=0;settings.aiDisplayMaster.length=0;settings.aiDisplay.length=0;settings.aIds={};}
function _fnDeleteIndex(a,iTarget,splice)
{var iTargetIndex=-1;for(var i=0,iLen=a.length;i<iLen;i++)
{if(a[i]==iTarget)
{iTargetIndex=i;}
else if(a[i]>iTarget)
{a[i]--;}}
if(iTargetIndex!=-1&&splice===undefined)
{a.splice(iTargetIndex,1);}}
function _fnInvalidate(settings,rowIdx,src,colIdx)
{var row=settings.aoData[rowIdx];var i,ien;var cellWrite=function(cell,col){while(cell.childNodes.length){cell.removeChild(cell.firstChild);}
cell.innerHTML=_fnGetCellData(settings,rowIdx,col,'display');};if(src==='dom'||((!src||src==='auto')&&row.src==='dom')){row._aData=_fnGetRowElements(settings,row,colIdx,colIdx===undefined?undefined:row._aData).data;}
else{var cells=row.anCells;if(cells){if(colIdx!==undefined){cellWrite(cells[colIdx],colIdx);}
else{for(i=0,ien=cells.length;i<ien;i++){cellWrite(cells[i],i);}}}}
row._aSortData=null;row._aFilterData=null;var cols=settings.aoColumns;if(colIdx!==undefined){cols[colIdx].sType=null;}
else{for(i=0,ien=cols.length;i<ien;i++){cols[i].sType=null;}
_fnRowAttributes(settings,row);}}
function _fnGetRowElements(settings,row,colIdx,d)
{var
tds=[],td=row.firstChild,name,col,o,i=0,contents,columns=settings.aoColumns,objectRead=settings._rowReadObject;d=d!==undefined?d:objectRead?{}:[];var attr=function(str,td){if(typeof str==='string'){var idx=str.indexOf('@');if(idx!==-1){var attr=str.substring(idx+1);var setter=_fnSetObjectDataFn(str);setter(d,td.getAttribute(attr));}}};var cellProcess=function(cell){if(colIdx===undefined||colIdx===i){col=columns[i];contents=$.trim(cell.innerHTML);if(col&&col._bAttrSrc){var setter=_fnSetObjectDataFn(col.mData._);setter(d,contents);attr(col.mData.sort,cell);attr(col.mData.type,cell);attr(col.mData.filter,cell);}
else{if(objectRead){if(!col._setter){col._setter=_fnSetObjectDataFn(col.mData);}
col._setter(d,contents);}
else{d[i]=contents;}}}
i++;};if(td){while(td){name=td.nodeName.toUpperCase();if(name=="TD"||name=="TH"){cellProcess(td);tds.push(td);}
td=td.nextSibling;}}
else{tds=row.anCells;for(var j=0,jen=tds.length;j<jen;j++){cellProcess(tds[j]);}}
var rowNode=row.firstChild?row:row.nTr;if(rowNode){var id=rowNode.getAttribute('id');if(id){_fnSetObjectDataFn(settings.rowId)(d,id);}}
return{data:d,cells:tds};}
function _fnCreateTr(oSettings,iRow,nTrIn,anTds)
{var
row=oSettings.aoData[iRow],rowData=row._aData,cells=[],nTr,nTd,oCol,i,iLen;if(row.nTr===null)
{nTr=nTrIn||document.createElement('tr');row.nTr=nTr;row.anCells=cells;nTr._DT_RowIndex=iRow;_fnRowAttributes(oSettings,row);for(i=0,iLen=oSettings.aoColumns.length;i<iLen;i++)
{oCol=oSettings.aoColumns[i];nTd=nTrIn?anTds[i]:document.createElement(oCol.sCellType);nTd._DT_CellIndex={row:iRow,column:i};cells.push(nTd);if(!nTrIn||oCol.mRender||oCol.mData!==i)
{nTd.innerHTML=_fnGetCellData(oSettings,iRow,i,'display');}
if(oCol.sClass)
{nTd.className+=' '+oCol.sClass;}
if(oCol.bVisible&&!nTrIn)
{nTr.appendChild(nTd);}
else if(!oCol.bVisible&&nTrIn)
{nTd.parentNode.removeChild(nTd);}
if(oCol.fnCreatedCell)
{oCol.fnCreatedCell.call(oSettings.oInstance,nTd,_fnGetCellData(oSettings,iRow,i),rowData,iRow,i);}}
_fnCallbackFire(oSettings,'aoRowCreatedCallback',null,[nTr,rowData,iRow]);}
row.nTr.setAttribute('role','row');}
function _fnRowAttributes(settings,row)
{var tr=row.nTr;var data=row._aData;if(tr){var id=settings.rowIdFn(data);if(id){tr.id=id;}
if(data.DT_RowClass){var a=data.DT_RowClass.split(' ');row.__rowc=row.__rowc?_unique(row.__rowc.concat(a)):a;$(tr).removeClass(row.__rowc.join(' ')).addClass(data.DT_RowClass);}
if(data.DT_RowAttr){$(tr).attr(data.DT_RowAttr);}
if(data.DT_RowData){$(tr).data(data.DT_RowData);}}}
function _fnBuildHead(oSettings)
{var i,ien,cell,row,column;var thead=oSettings.nTHead;var tfoot=oSettings.nTFoot;var createHeader=$('th, td',thead).length===0;var classes=oSettings.oClasses;var columns=oSettings.aoColumns;if(createHeader){row=$('<tr/>').appendTo(thead);}
for(i=0,ien=columns.length;i<ien;i++){column=columns[i];cell=$(column.nTh).addClass(column.sClass);if(createHeader){cell.appendTo(row);}
if(oSettings.oFeatures.bSort){cell.addClass(column.sSortingClass);if(column.bSortable!==false){cell.attr('tabindex',oSettings.iTabIndex).attr('aria-controls',oSettings.sTableId);_fnSortAttachListener(oSettings,column.nTh,i);}}
if(column.sTitle!=cell[0].innerHTML){cell.html(column.sTitle);}
_fnRenderer(oSettings,'header')(oSettings,cell,column,classes);}
if(createHeader){_fnDetectHeader(oSettings.aoHeader,thead);}
$(thead).find('>tr').attr('role','row');$(thead).find('>tr>th, >tr>td').addClass(classes.sHeaderTH);$(tfoot).find('>tr>th, >tr>td').addClass(classes.sFooterTH);if(tfoot!==null){var cells=oSettings.aoFooter[0];for(i=0,ien=cells.length;i<ien;i++){column=columns[i];column.nTf=cells[i].cell;if(column.sClass){$(column.nTf).addClass(column.sClass);}}}}
function _fnDrawHead(oSettings,aoSource,bIncludeHidden)
{var i,iLen,j,jLen,k,kLen,n,nLocalTr;var aoLocal=[];var aApplied=[];var iColumns=oSettings.aoColumns.length;var iRowspan,iColspan;if(!aoSource)
{return;}
if(bIncludeHidden===undefined)
{bIncludeHidden=false;}
for(i=0,iLen=aoSource.length;i<iLen;i++)
{aoLocal[i]=aoSource[i].slice();aoLocal[i].nTr=aoSource[i].nTr;for(j=iColumns-1;j>=0;j--)
{if(!oSettings.aoColumns[j].bVisible&&!bIncludeHidden)
{aoLocal[i].splice(j,1);}}
aApplied.push([]);}
for(i=0,iLen=aoLocal.length;i<iLen;i++)
{nLocalTr=aoLocal[i].nTr;if(nLocalTr)
{while((n=nLocalTr.firstChild))
{nLocalTr.removeChild(n);}}
for(j=0,jLen=aoLocal[i].length;j<jLen;j++)
{iRowspan=1;iColspan=1;if(aApplied[i][j]===undefined)
{nLocalTr.appendChild(aoLocal[i][j].cell);aApplied[i][j]=1;while(aoLocal[i+iRowspan]!==undefined&&aoLocal[i][j].cell==aoLocal[i+iRowspan][j].cell)
{aApplied[i+iRowspan][j]=1;iRowspan++;}
while(aoLocal[i][j+iColspan]!==undefined&&aoLocal[i][j].cell==aoLocal[i][j+iColspan].cell)
{for(k=0;k<iRowspan;k++)
{aApplied[i+k][j+iColspan]=1;}
iColspan++;}
$(aoLocal[i][j].cell).attr('rowspan',iRowspan).attr('colspan',iColspan);}}}}
function _fnDraw(oSettings)
{var aPreDraw=_fnCallbackFire(oSettings,'aoPreDrawCallback','preDraw',[oSettings]);if($.inArray(false,aPreDraw)!==-1)
{_fnProcessingDisplay(oSettings,false);return;}
var i,iLen,n;var anRows=[];var iRowCount=0;var asStripeClasses=oSettings.asStripeClasses;var iStripes=asStripeClasses.length;var iOpenRows=oSettings.aoOpenRows.length;var oLang=oSettings.oLanguage;var iInitDisplayStart=oSettings.iInitDisplayStart;var bServerSide=_fnDataSource(oSettings)=='ssp';var aiDisplay=oSettings.aiDisplay;oSettings.bDrawing=true;if(iInitDisplayStart!==undefined&&iInitDisplayStart!==-1)
{oSettings._iDisplayStart=bServerSide?iInitDisplayStart:iInitDisplayStart>=oSettings.fnRecordsDisplay()?0:iInitDisplayStart;oSettings.iInitDisplayStart=-1;}
var iDisplayStart=oSettings._iDisplayStart;var iDisplayEnd=oSettings.fnDisplayEnd();if(oSettings.bDeferLoading)
{oSettings.bDeferLoading=false;oSettings.iDraw++;_fnProcessingDisplay(oSettings,false);}
else if(!bServerSide)
{oSettings.iDraw++;}
else if(!oSettings.bDestroying&&!_fnAjaxUpdate(oSettings))
{return;}
if(aiDisplay.length!==0)
{var iStart=bServerSide?0:iDisplayStart;var iEnd=bServerSide?oSettings.aoData.length:iDisplayEnd;for(var j=iStart;j<iEnd;j++)
{var iDataIndex=aiDisplay[j];var aoData=oSettings.aoData[iDataIndex];if(aoData.nTr===null)
{_fnCreateTr(oSettings,iDataIndex);}
var nRow=aoData.nTr;if(iStripes!==0)
{var sStripe=asStripeClasses[iRowCount%iStripes];if(aoData._sRowStripe!=sStripe)
{$(nRow).removeClass(aoData._sRowStripe).addClass(sStripe);aoData._sRowStripe=sStripe;}}
_fnCallbackFire(oSettings,'aoRowCallback',null,[nRow,aoData._aData,iRowCount,j]);anRows.push(nRow);iRowCount++;}}
else
{var sZero=oLang.sZeroRecords;if(oSettings.iDraw==1&&_fnDataSource(oSettings)=='ajax')
{sZero=oLang.sLoadingRecords;}
else if(oLang.sEmptyTable&&oSettings.fnRecordsTotal()===0)
{sZero=oLang.sEmptyTable;}
anRows[0]=$('<tr/>',{'class':iStripes?asStripeClasses[0]:''}).append($('<td />',{'valign':'top','colSpan':_fnVisbleColumns(oSettings),'class':oSettings.oClasses.sRowEmpty}).html(sZero))[0];}
_fnCallbackFire(oSettings,'aoHeaderCallback','header',[$(oSettings.nTHead).children('tr')[0],_fnGetDataMaster(oSettings),iDisplayStart,iDisplayEnd,aiDisplay]);_fnCallbackFire(oSettings,'aoFooterCallback','footer',[$(oSettings.nTFoot).children('tr')[0],_fnGetDataMaster(oSettings),iDisplayStart,iDisplayEnd,aiDisplay]);var body=$(oSettings.nTBody);body.children().detach();body.append($(anRows));_fnCallbackFire(oSettings,'aoDrawCallback','draw',[oSettings]);oSettings.bSorted=false;oSettings.bFiltered=false;oSettings.bDrawing=false;}
function _fnReDraw(settings,holdPosition)
{var
features=settings.oFeatures,sort=features.bSort,filter=features.bFilter;if(sort){_fnSort(settings);}
if(filter){_fnFilterComplete(settings,settings.oPreviousSearch);}
else{settings.aiDisplay=settings.aiDisplayMaster.slice();}
if(holdPosition!==true){settings._iDisplayStart=0;}
settings._drawHold=holdPosition;_fnDraw(settings);settings._drawHold=false;}
function _fnAddOptionsHtml(oSettings)
{var classes=oSettings.oClasses;var table=$(oSettings.nTable);var holding=$('<div/>').insertBefore(table);var features=oSettings.oFeatures;var insert=$('<div/>',{id:oSettings.sTableId+'_wrapper','class':classes.sWrapper+(oSettings.nTFoot?'':' '+classes.sNoFooter)});oSettings.nHolding=holding[0];oSettings.nTableWrapper=insert[0];oSettings.nTableReinsertBefore=oSettings.nTable.nextSibling;var aDom=oSettings.sDom.split('');var featureNode,cOption,nNewNode,cNext,sAttr,j;for(var i=0;i<aDom.length;i++)
{featureNode=null;cOption=aDom[i];if(cOption=='<')
{nNewNode=$('<div/>')[0];cNext=aDom[i+1];if(cNext=="'"||cNext=='"')
{sAttr="";j=2;while(aDom[i+j]!=cNext)
{sAttr+=aDom[i+j];j++;}
if(sAttr=="H")
{sAttr=classes.sJUIHeader;}
else if(sAttr=="F")
{sAttr=classes.sJUIFooter;}
if(sAttr.indexOf('.')!=-1)
{var aSplit=sAttr.split('.');nNewNode.id=aSplit[0].substr(1,aSplit[0].length-1);nNewNode.className=aSplit[1];}
else if(sAttr.charAt(0)=="#")
{nNewNode.id=sAttr.substr(1,sAttr.length-1);}
else
{nNewNode.className=sAttr;}
i+=j;}
insert.append(nNewNode);insert=$(nNewNode);}
else if(cOption=='>')
{insert=insert.parent();}
else if(cOption=='l'&&features.bPaginate&&features.bLengthChange)
{featureNode=_fnFeatureHtmlLength(oSettings);}
else if(cOption=='f'&&features.bFilter)
{featureNode=_fnFeatureHtmlFilter(oSettings);}
else if(cOption=='r'&&features.bProcessing)
{featureNode=_fnFeatureHtmlProcessing(oSettings);}
else if(cOption=='t')
{featureNode=_fnFeatureHtmlTable(oSettings);}
else if(cOption=='i'&&features.bInfo)
{featureNode=_fnFeatureHtmlInfo(oSettings);}
else if(cOption=='p'&&features.bPaginate)
{featureNode=_fnFeatureHtmlPaginate(oSettings);}
else if(DataTable.ext.feature.length!==0)
{var aoFeatures=DataTable.ext.feature;for(var k=0,kLen=aoFeatures.length;k<kLen;k++)
{if(cOption==aoFeatures[k].cFeature)
{featureNode=aoFeatures[k].fnInit(oSettings);break;}}}
if(featureNode)
{var aanFeatures=oSettings.aanFeatures;if(!aanFeatures[cOption])
{aanFeatures[cOption]=[];}
aanFeatures[cOption].push(featureNode);insert.append(featureNode);}}
holding.replaceWith(insert);oSettings.nHolding=null;}
function _fnDetectHeader(aLayout,nThead)
{var nTrs=$(nThead).children('tr');var nTr,nCell;var i,k,l,iLen,jLen,iColShifted,iColumn,iColspan,iRowspan;var bUnique;var fnShiftCol=function(a,i,j){var k=a[i];while(k[j]){j++;}
return j;};aLayout.splice(0,aLayout.length);for(i=0,iLen=nTrs.length;i<iLen;i++)
{aLayout.push([]);}
for(i=0,iLen=nTrs.length;i<iLen;i++)
{nTr=nTrs[i];iColumn=0;nCell=nTr.firstChild;while(nCell){if(nCell.nodeName.toUpperCase()=="TD"||nCell.nodeName.toUpperCase()=="TH")
{iColspan=nCell.getAttribute('colspan')*1;iRowspan=nCell.getAttribute('rowspan')*1;iColspan=(!iColspan||iColspan===0||iColspan===1)?1:iColspan;iRowspan=(!iRowspan||iRowspan===0||iRowspan===1)?1:iRowspan;iColShifted=fnShiftCol(aLayout,i,iColumn);bUnique=iColspan===1?true:false;for(l=0;l<iColspan;l++)
{for(k=0;k<iRowspan;k++)
{aLayout[i+k][iColShifted+l]={"cell":nCell,"unique":bUnique};aLayout[i+k].nTr=nTr;}}}
nCell=nCell.nextSibling;}}}
function _fnGetUniqueThs(oSettings,nHeader,aLayout)
{var aReturn=[];if(!aLayout)
{aLayout=oSettings.aoHeader;if(nHeader)
{aLayout=[];_fnDetectHeader(aLayout,nHeader);}}
for(var i=0,iLen=aLayout.length;i<iLen;i++)
{for(var j=0,jLen=aLayout[i].length;j<jLen;j++)
{if(aLayout[i][j].unique&&(!aReturn[j]||!oSettings.bSortCellsTop))
{aReturn[j]=aLayout[i][j].cell;}}}
return aReturn;}
function _fnBuildAjax(oSettings,data,fn)
{_fnCallbackFire(oSettings,'aoServerParams','serverParams',[data]);if(data&&$.isArray(data)){var tmp={};var rbracket=/(.*?)\[\]$/;$.each(data,function(key,val){var match=val.name.match(rbracket);if(match){var name=match[0];if(!tmp[name]){tmp[name]=[];}
tmp[name].push(val.value);}
else{tmp[val.name]=val.value;}});data=tmp;}
var ajaxData;var ajax=oSettings.ajax;var instance=oSettings.oInstance;var callback=function(json){_fnCallbackFire(oSettings,null,'xhr',[oSettings,json,oSettings.jqXHR]);fn(json);};if($.isPlainObject(ajax)&&ajax.data)
{ajaxData=ajax.data;var newData=$.isFunction(ajaxData)?ajaxData(data,oSettings):ajaxData;data=$.isFunction(ajaxData)&&newData?newData:$.extend(true,data,newData);delete ajax.data;}
var baseAjax={"data":data,"success":function(json){var error=json.error||json.sError;if(error){_fnLog(oSettings,0,error);}
oSettings.json=json;callback(json);},"dataType":"json","cache":false,"type":oSettings.sServerMethod,"error":function(xhr,error,thrown){var ret=_fnCallbackFire(oSettings,null,'xhr',[oSettings,null,oSettings.jqXHR]);if($.inArray(true,ret)===-1){if(error=="parsererror"){_fnLog(oSettings,0,'Invalid JSON response',1);}
else if(xhr.readyState===4){_fnLog(oSettings,0,'Ajax error',7);}}
_fnProcessingDisplay(oSettings,false);}};oSettings.oAjaxData=data;_fnCallbackFire(oSettings,null,'preXhr',[oSettings,data]);if(oSettings.fnServerData)
{oSettings.fnServerData.call(instance,oSettings.sAjaxSource,$.map(data,function(val,key){return{name:key,value:val};}),callback,oSettings);}
else if(oSettings.sAjaxSource||typeof ajax==='string')
{oSettings.jqXHR=$.ajax($.extend(baseAjax,{url:ajax||oSettings.sAjaxSource}));}
else if($.isFunction(ajax))
{oSettings.jqXHR=ajax.call(instance,data,callback,oSettings);}
else
{oSettings.jqXHR=$.ajax($.extend(baseAjax,ajax));ajax.data=ajaxData;}}
function _fnAjaxUpdate(settings)
{if(settings.bAjaxDataGet){settings.iDraw++;_fnProcessingDisplay(settings,true);_fnBuildAjax(settings,_fnAjaxParameters(settings),function(json){_fnAjaxUpdateDraw(settings,json);});return false;}
return true;}
function _fnAjaxParameters(settings)
{var
columns=settings.aoColumns,columnCount=columns.length,features=settings.oFeatures,preSearch=settings.oPreviousSearch,preColSearch=settings.aoPreSearchCols,i,data=[],dataProp,column,columnSearch,sort=_fnSortFlatten(settings),displayStart=settings._iDisplayStart,displayLength=features.bPaginate!==false?settings._iDisplayLength:-1;var param=function(name,value){data.push({'name':name,'value':value});};param('sEcho',settings.iDraw);param('iColumns',columnCount);param('sColumns',_pluck(columns,'sName').join(','));param('iDisplayStart',displayStart);param('iDisplayLength',displayLength);var d={draw:settings.iDraw,columns:[],order:[],start:displayStart,length:displayLength,search:{value:preSearch.sSearch,regex:preSearch.bRegex}};for(i=0;i<columnCount;i++){column=columns[i];columnSearch=preColSearch[i];dataProp=typeof column.mData=="function"?'function':column.mData;d.columns.push({data:dataProp,name:column.sName,searchable:column.bSearchable,orderable:column.bSortable,search:{value:columnSearch.sSearch,regex:columnSearch.bRegex}});param("mDataProp_"+i,dataProp);if(features.bFilter){param('sSearch_'+i,columnSearch.sSearch);param('bRegex_'+i,columnSearch.bRegex);param('bSearchable_'+i,column.bSearchable);}
if(features.bSort){param('bSortable_'+i,column.bSortable);}}
if(features.bFilter){param('sSearch',preSearch.sSearch);param('bRegex',preSearch.bRegex);}
if(features.bSort){$.each(sort,function(i,val){d.order.push({column:val.col,dir:val.dir});param('iSortCol_'+i,val.col);param('sSortDir_'+i,val.dir);});param('iSortingCols',sort.length);}
var legacy=DataTable.ext.legacy.ajax;if(legacy===null){return settings.sAjaxSource?data:d;}
return legacy?data:d;}
function _fnAjaxUpdateDraw(settings,json)
{var compat=function(old,modern){return json[old]!==undefined?json[old]:json[modern];};var data=_fnAjaxDataSrc(settings,json);var draw=compat('sEcho','draw');var recordsTotal=compat('iTotalRecords','recordsTotal');var recordsFiltered=compat('iTotalDisplayRecords','recordsFiltered');if(draw){if(draw*1<settings.iDraw){return;}
settings.iDraw=draw*1;}
_fnClearTable(settings);settings._iRecordsTotal=parseInt(recordsTotal,10);settings._iRecordsDisplay=parseInt(recordsFiltered,10);for(var i=0,ien=data.length;i<ien;i++){_fnAddData(settings,data[i]);}
settings.aiDisplay=settings.aiDisplayMaster.slice();settings.bAjaxDataGet=false;_fnDraw(settings);if(!settings._bInitComplete){_fnInitComplete(settings,json);}
settings.bAjaxDataGet=true;_fnProcessingDisplay(settings,false);}
function _fnAjaxDataSrc(oSettings,json)
{var dataSrc=$.isPlainObject(oSettings.ajax)&&oSettings.ajax.dataSrc!==undefined?oSettings.ajax.dataSrc:oSettings.sAjaxDataProp;if(dataSrc==='data'){return json.aaData||json[dataSrc];}
return dataSrc!==""?_fnGetObjectDataFn(dataSrc)(json):json;}
function _fnFeatureHtmlFilter(settings)
{var classes=settings.oClasses;var tableId=settings.sTableId;var language=settings.oLanguage;var previousSearch=settings.oPreviousSearch;var features=settings.aanFeatures;var input='<input type="search" class="'+classes.sFilterInput+'"/>';var str=language.sSearch;str=str.match(/_INPUT_/)?str.replace('_INPUT_',input):str+input;var filter=$('<div/>',{'id':!features.f?tableId+'_filter':null,'class':classes.sFilter}).append($('<label/>').append(str));var searchFn=function(){var n=features.f;var val=!this.value?"":this.value;if(val!=previousSearch.sSearch){_fnFilterComplete(settings,{"sSearch":val,"bRegex":previousSearch.bRegex,"bSmart":previousSearch.bSmart,"bCaseInsensitive":previousSearch.bCaseInsensitive});settings._iDisplayStart=0;_fnDraw(settings);}};var searchDelay=settings.searchDelay!==null?settings.searchDelay:_fnDataSource(settings)==='ssp'?400:0;var jqFilter=$('input',filter).val(previousSearch.sSearch).attr('placeholder',language.sSearchPlaceholder).bind('keyup.DT search.DT input.DT paste.DT cut.DT',searchDelay?_fnThrottle(searchFn,searchDelay):searchFn).bind('keypress.DT',function(e){if(e.keyCode==13){return false;}}).attr('aria-controls',tableId);$(settings.nTable).on('search.dt.DT',function(ev,s){if(settings===s){try{if(jqFilter[0]!==document.activeElement){jqFilter.val(previousSearch.sSearch);}}
catch(e){}}});return filter[0];}
function _fnFilterComplete(oSettings,oInput,iForce)
{var oPrevSearch=oSettings.oPreviousSearch;var aoPrevSearch=oSettings.aoPreSearchCols;var fnSaveFilter=function(oFilter){oPrevSearch.sSearch=oFilter.sSearch;oPrevSearch.bRegex=oFilter.bRegex;oPrevSearch.bSmart=oFilter.bSmart;oPrevSearch.bCaseInsensitive=oFilter.bCaseInsensitive;};var fnRegex=function(o){return o.bEscapeRegex!==undefined?!o.bEscapeRegex:o.bRegex;};_fnColumnTypes(oSettings);if(_fnDataSource(oSettings)!='ssp')
{_fnFilter(oSettings,oInput.sSearch,iForce,fnRegex(oInput),oInput.bSmart,oInput.bCaseInsensitive);fnSaveFilter(oInput);for(var i=0;i<aoPrevSearch.length;i++)
{_fnFilterColumn(oSettings,aoPrevSearch[i].sSearch,i,fnRegex(aoPrevSearch[i]),aoPrevSearch[i].bSmart,aoPrevSearch[i].bCaseInsensitive);}
_fnFilterCustom(oSettings);}
else
{fnSaveFilter(oInput);}
oSettings.bFiltered=true;_fnCallbackFire(oSettings,null,'search',[oSettings]);}
function _fnFilterCustom(settings)
{var filters=DataTable.ext.search;var displayRows=settings.aiDisplay;var row,rowIdx;for(var i=0,ien=filters.length;i<ien;i++){var rows=[];for(var j=0,jen=displayRows.length;j<jen;j++){rowIdx=displayRows[j];row=settings.aoData[rowIdx];if(filters[i](settings,row._aFilterData,rowIdx,row._aData,j)){rows.push(rowIdx);}}
displayRows.length=0;$.merge(displayRows,rows);}}
function _fnFilterColumn(settings,searchStr,colIdx,regex,smart,caseInsensitive)
{if(searchStr===''){return;}
var data;var display=settings.aiDisplay;var rpSearch=_fnFilterCreateSearch(searchStr,regex,smart,caseInsensitive);for(var i=display.length-1;i>=0;i--){data=settings.aoData[display[i]]._aFilterData[colIdx];if(!rpSearch.test(data)){display.splice(i,1);}}}
function _fnFilter(settings,input,force,regex,smart,caseInsensitive)
{var rpSearch=_fnFilterCreateSearch(input,regex,smart,caseInsensitive);var prevSearch=settings.oPreviousSearch.sSearch;var displayMaster=settings.aiDisplayMaster;var display,invalidated,i;if(DataTable.ext.search.length!==0){force=true;}
invalidated=_fnFilterData(settings);if(input.length<=0){settings.aiDisplay=displayMaster.slice();}
else{if(invalidated||force||prevSearch.length>input.length||input.indexOf(prevSearch)!==0||settings.bSorted){settings.aiDisplay=displayMaster.slice();}
display=settings.aiDisplay;for(i=display.length-1;i>=0;i--){if(!rpSearch.test(settings.aoData[display[i]]._sFilterRow)){display.splice(i,1);}}}}
function _fnFilterCreateSearch(search,regex,smart,caseInsensitive)
{search=regex?search:_fnEscapeRegex(search);if(smart){var a=$.map(search.match(/"[^"]+"|[^ ]+/g)||[''],function(word){if(word.charAt(0)==='"'){var m=word.match(/^"(.*)"$/);word=m?m[1]:word;}
return word.replace('"','');});search='^(?=.*?'+a.join(')(?=.*?')+').*$';}
return new RegExp(search,caseInsensitive?'i':'');}
function _fnEscapeRegex(sVal)
{return sVal.replace(_re_escape_regex,'\\$1');}
var __filter_div=$('<div>')[0];var __filter_div_textContent=__filter_div.textContent!==undefined;function _fnFilterData(settings)
{var columns=settings.aoColumns;var column;var i,j,ien,jen,filterData,cellData,row;var fomatters=DataTable.ext.type.search;var wasInvalidated=false;for(i=0,ien=settings.aoData.length;i<ien;i++){row=settings.aoData[i];if(!row._aFilterData){filterData=[];for(j=0,jen=columns.length;j<jen;j++){column=columns[j];if(column.bSearchable){cellData=_fnGetCellData(settings,i,j,'filter');if(fomatters[column.sType]){cellData=fomatters[column.sType](cellData);}
if(cellData===null){cellData='';}
if(typeof cellData!=='string'&&cellData.toString){cellData=cellData.toString();}}
else{cellData='';}
if(cellData.indexOf&&cellData.indexOf('&')!==-1){__filter_div.innerHTML=cellData;cellData=__filter_div_textContent?__filter_div.textContent:__filter_div.innerText;}
if(cellData.replace){cellData=cellData.replace(/[\r\n]/g,'');}
filterData.push(cellData);}
row._aFilterData=filterData;row._sFilterRow=filterData.join('  ');wasInvalidated=true;}}
return wasInvalidated;}
function _fnSearchToCamel(obj)
{return{search:obj.sSearch,smart:obj.bSmart,regex:obj.bRegex,caseInsensitive:obj.bCaseInsensitive};}
function _fnSearchToHung(obj)
{return{sSearch:obj.search,bSmart:obj.smart,bRegex:obj.regex,bCaseInsensitive:obj.caseInsensitive};}
function _fnFeatureHtmlInfo(settings)
{var
tid=settings.sTableId,nodes=settings.aanFeatures.i,n=$('<div/>',{'class':settings.oClasses.sInfo,'id':!nodes?tid+'_info':null});if(!nodes){settings.aoDrawCallback.push({"fn":_fnUpdateInfo,"sName":"information"});n.attr('role','status').attr('aria-live','polite');$(settings.nTable).attr('aria-describedby',tid+'_info');}
return n[0];}
function _fnUpdateInfo(settings)
{var nodes=settings.aanFeatures.i;if(nodes.length===0){return;}
var
lang=settings.oLanguage,start=settings._iDisplayStart+1,end=settings.fnDisplayEnd(),max=settings.fnRecordsTotal(),total=settings.fnRecordsDisplay(),out=total?lang.sInfo:lang.sInfoEmpty;if(total!==max){out+=' '+lang.sInfoFiltered;}
out+=lang.sInfoPostFix;out=_fnInfoMacros(settings,out);var callback=lang.fnInfoCallback;if(callback!==null){out=callback.call(settings.oInstance,settings,start,end,max,total,out);}
$(nodes).html(out);}
function _fnInfoMacros(settings,str)
{var
formatter=settings.fnFormatNumber,start=settings._iDisplayStart+1,len=settings._iDisplayLength,vis=settings.fnRecordsDisplay(),all=len===-1;return str.replace(/_START_/g,formatter.call(settings,start)).replace(/_END_/g,formatter.call(settings,settings.fnDisplayEnd())).replace(/_MAX_/g,formatter.call(settings,settings.fnRecordsTotal())).replace(/_TOTAL_/g,formatter.call(settings,vis)).replace(/_PAGE_/g,formatter.call(settings,all?1:Math.ceil(start/len))).replace(/_PAGES_/g,formatter.call(settings,all?1:Math.ceil(vis/len)));}
function _fnInitialise(settings)
{var i,iLen,iAjaxStart=settings.iInitDisplayStart;var columns=settings.aoColumns,column;var features=settings.oFeatures;var deferLoading=settings.bDeferLoading;if(!settings.bInitialised){setTimeout(function(){_fnInitialise(settings);},200);return;}
_fnAddOptionsHtml(settings);_fnBuildHead(settings);_fnDrawHead(settings,settings.aoHeader);_fnDrawHead(settings,settings.aoFooter);_fnProcessingDisplay(settings,true);if(features.bAutoWidth){_fnCalculateColumnWidths(settings);}
for(i=0,iLen=columns.length;i<iLen;i++){column=columns[i];if(column.sWidth){column.nTh.style.width=_fnStringToCss(column.sWidth);}}
_fnCallbackFire(settings,null,'preInit',[settings]);_fnReDraw(settings);var dataSrc=_fnDataSource(settings);if(dataSrc!='ssp'||deferLoading){if(dataSrc=='ajax'){_fnBuildAjax(settings,[],function(json){var aData=_fnAjaxDataSrc(settings,json);for(i=0;i<aData.length;i++){_fnAddData(settings,aData[i]);}
settings.iInitDisplayStart=iAjaxStart;_fnReDraw(settings);_fnProcessingDisplay(settings,false);_fnInitComplete(settings,json);},settings);}
else{_fnProcessingDisplay(settings,false);_fnInitComplete(settings);}}}
function _fnInitComplete(settings,json)
{settings._bInitComplete=true;if(json||settings.oInit.aaData){_fnAdjustColumnSizing(settings);}
_fnCallbackFire(settings,null,'plugin-init',[settings,json]);_fnCallbackFire(settings,'aoInitComplete','init',[settings,json]);}
function _fnLengthChange(settings,val)
{var len=parseInt(val,10);settings._iDisplayLength=len;_fnLengthOverflow(settings);_fnCallbackFire(settings,null,'length',[settings,len]);}
function _fnFeatureHtmlLength(settings)
{var
classes=settings.oClasses,tableId=settings.sTableId,menu=settings.aLengthMenu,d2=$.isArray(menu[0]),lengths=d2?menu[0]:menu,language=d2?menu[1]:menu;var select=$('<select/>',{'name':tableId+'_length','aria-controls':tableId,'class':classes.sLengthSelect});for(var i=0,ien=lengths.length;i<ien;i++){select[0][i]=new Option(language[i],lengths[i]);}
var div=$('<div><label/></div>').addClass(classes.sLength);if(!settings.aanFeatures.l){div[0].id=tableId+'_length';}
div.children().append(settings.oLanguage.sLengthMenu.replace('_MENU_',select[0].outerHTML));$('select',div).val(settings._iDisplayLength).bind('change.DT',function(e){_fnLengthChange(settings,$(this).val());_fnDraw(settings);});$(settings.nTable).bind('length.dt.DT',function(e,s,len){if(settings===s){$('select',div).val(len);}});return div[0];}
function _fnFeatureHtmlPaginate(settings)
{var
type=settings.sPaginationType,plugin=DataTable.ext.pager[type],modern=typeof plugin==='function',redraw=function(settings){_fnDraw(settings);},node=$('<div/>').addClass(settings.oClasses.sPaging+type)[0],features=settings.aanFeatures;if(!modern){plugin.fnInit(settings,node,redraw);}
if(!features.p)
{node.id=settings.sTableId+'_paginate';settings.aoDrawCallback.push({"fn":function(settings){if(modern){var
start=settings._iDisplayStart,len=settings._iDisplayLength,visRecords=settings.fnRecordsDisplay(),all=len===-1,page=all?0:Math.ceil(start/len),pages=all?1:Math.ceil(visRecords/len),buttons=plugin(page,pages),i,ien;for(i=0,ien=features.p.length;i<ien;i++){_fnRenderer(settings,'pageButton')(settings,features.p[i],i,buttons,page,pages);}}
else{plugin.fnUpdate(settings,redraw);}},"sName":"pagination"});}
return node;}
function _fnPageChange(settings,action,redraw)
{var
start=settings._iDisplayStart,len=settings._iDisplayLength,records=settings.fnRecordsDisplay();if(records===0||len===-1)
{start=0;}
else if(typeof action==="number")
{start=action*len;if(start>records)
{start=0;}}
else if(action=="first")
{start=0;}
else if(action=="previous")
{start=len>=0?start-len:0;if(start<0)
{start=0;}}
else if(action=="next")
{if(start+len<records)
{start+=len;}}
else if(action=="last")
{start=Math.floor((records-1)/len)*len;}
else
{_fnLog(settings,0,"Unknown paging action: "+action,5);}
var changed=settings._iDisplayStart!==start;settings._iDisplayStart=start;if(changed){_fnCallbackFire(settings,null,'page',[settings]);if(redraw){_fnDraw(settings);}}
return changed;}
function _fnFeatureHtmlProcessing(settings)
{return $('<div/>',{'id':!settings.aanFeatures.r?settings.sTableId+'_processing':null,'class':settings.oClasses.sProcessing}).html(settings.oLanguage.sProcessing).insertBefore(settings.nTable)[0];}
function _fnProcessingDisplay(settings,show)
{if(settings.oFeatures.bProcessing){$(settings.aanFeatures.r).css('display',show?'block':'none');}
_fnCallbackFire(settings,null,'processing',[settings,show]);}
function _fnFeatureHtmlTable(settings)
{var table=$(settings.nTable);table.attr('role','grid');var scroll=settings.oScroll;if(scroll.sX===''&&scroll.sY===''){return settings.nTable;}
var scrollX=scroll.sX;var scrollY=scroll.sY;var classes=settings.oClasses;var caption=table.children('caption');var captionSide=caption.length?caption[0]._captionSide:null;var headerClone=$(table[0].cloneNode(false));var footerClone=$(table[0].cloneNode(false));var footer=table.children('tfoot');var _div='<div/>';var size=function(s){return!s?null:_fnStringToCss(s);};if(!footer.length){footer=null;}
var scroller=$(_div,{'class':classes.sScrollWrapper}).append($(_div,{'class':classes.sScrollHead}).css({overflow:'hidden',position:'relative',border:0,width:scrollX?size(scrollX):'100%'}).append($(_div,{'class':classes.sScrollHeadInner}).css({'box-sizing':'content-box',width:scroll.sXInner||'100%'}).append(headerClone.removeAttr('id').css('margin-left',0).append(captionSide==='top'?caption:null).append(table.children('thead'))))).append($(_div,{'class':classes.sScrollBody}).css({position:'relative',overflow:'auto',width:size(scrollX)}).append(table));if(footer){scroller.append($(_div,{'class':classes.sScrollFoot}).css({overflow:'hidden',border:0,width:scrollX?size(scrollX):'100%'}).append($(_div,{'class':classes.sScrollFootInner}).append(footerClone.removeAttr('id').css('margin-left',0).append(captionSide==='bottom'?caption:null).append(table.children('tfoot')))));}
var children=scroller.children();var scrollHead=children[0];var scrollBody=children[1];var scrollFoot=footer?children[2]:null;if(scrollX){$(scrollBody).on('scroll.DT',function(e){var scrollLeft=this.scrollLeft;scrollHead.scrollLeft=scrollLeft;if(footer){scrollFoot.scrollLeft=scrollLeft;}});}
$(scrollBody).css(scrollY&&scroll.bCollapse?'max-height':'height',scrollY);settings.nScrollHead=scrollHead;settings.nScrollBody=scrollBody;settings.nScrollFoot=scrollFoot;settings.aoDrawCallback.push({"fn":_fnScrollDraw,"sName":"scrolling"});return scroller[0];}
function _fnScrollDraw(settings)
{var
scroll=settings.oScroll,scrollX=scroll.sX,scrollXInner=scroll.sXInner,scrollY=scroll.sY,barWidth=scroll.iBarWidth,divHeader=$(settings.nScrollHead),divHeaderStyle=divHeader[0].style,divHeaderInner=divHeader.children('div'),divHeaderInnerStyle=divHeaderInner[0].style,divHeaderTable=divHeaderInner.children('table'),divBodyEl=settings.nScrollBody,divBody=$(divBodyEl),divBodyStyle=divBodyEl.style,divFooter=$(settings.nScrollFoot),divFooterInner=divFooter.children('div'),divFooterTable=divFooterInner.children('table'),header=$(settings.nTHead),table=$(settings.nTable),tableEl=table[0],tableStyle=tableEl.style,footer=settings.nTFoot?$(settings.nTFoot):null,browser=settings.oBrowser,ie67=browser.bScrollOversize,headerTrgEls,footerTrgEls,headerSrcEls,footerSrcEls,headerCopy,footerCopy,headerWidths=[],footerWidths=[],headerContent=[],idx,correction,sanityWidth,zeroOut=function(nSizer){var style=nSizer.style;style.paddingTop="0";style.paddingBottom="0";style.borderTopWidth="0";style.borderBottomWidth="0";style.height=0;};var scrollBarVis=divBodyEl.scrollHeight>divBodyEl.clientHeight;if(settings.scrollBarVis!==scrollBarVis&&settings.scrollBarVis!==undefined){settings.scrollBarVis=scrollBarVis;_fnAdjustColumnSizing(settings);return;}
else{settings.scrollBarVis=scrollBarVis;}
table.children('thead, tfoot').remove();headerCopy=header.clone().prependTo(table);headerTrgEls=header.find('tr');headerSrcEls=headerCopy.find('tr');headerCopy.find('th, td').removeAttr('tabindex');if(footer){footerCopy=footer.clone().prependTo(table);footerTrgEls=footer.find('tr');footerSrcEls=footerCopy.find('tr');}
if(!scrollX)
{divBodyStyle.width='100%';divHeader[0].style.width='100%';}
$.each(_fnGetUniqueThs(settings,headerCopy),function(i,el){idx=_fnVisibleToColumnIndex(settings,i);el.style.width=settings.aoColumns[idx].sWidth;});if(footer){_fnApplyToChildren(function(n){n.style.width="";},footerSrcEls);}
sanityWidth=table.outerWidth();if(scrollX===""){tableStyle.width="100%";if(ie67&&(table.find('tbody').height()>divBodyEl.offsetHeight||divBody.css('overflow-y')=="scroll")){tableStyle.width=_fnStringToCss(table.outerWidth()-barWidth);}
sanityWidth=table.outerWidth();}
else if(scrollXInner!==""){tableStyle.width=_fnStringToCss(scrollXInner);sanityWidth=table.outerWidth();}
_fnApplyToChildren(zeroOut,headerSrcEls);_fnApplyToChildren(function(nSizer){headerContent.push(nSizer.innerHTML);headerWidths.push(_fnStringToCss($(nSizer).css('width')));},headerSrcEls);_fnApplyToChildren(function(nToSize,i){nToSize.style.width=headerWidths[i];},headerTrgEls);$(headerSrcEls).height(0);if(footer)
{_fnApplyToChildren(zeroOut,footerSrcEls);_fnApplyToChildren(function(nSizer){footerWidths.push(_fnStringToCss($(nSizer).css('width')));},footerSrcEls);_fnApplyToChildren(function(nToSize,i){nToSize.style.width=footerWidths[i];},footerTrgEls);$(footerSrcEls).height(0);}
_fnApplyToChildren(function(nSizer,i){nSizer.innerHTML='<div class="dataTables_sizing" style="height:0;overflow:hidden;">'+headerContent[i]+'</div>';nSizer.style.width=headerWidths[i];},headerSrcEls);if(footer)
{_fnApplyToChildren(function(nSizer,i){nSizer.innerHTML="";nSizer.style.width=footerWidths[i];},footerSrcEls);}
if(table.outerWidth()<sanityWidth)
{correction=((divBodyEl.scrollHeight>divBodyEl.offsetHeight||divBody.css('overflow-y')=="scroll"))?sanityWidth+barWidth:sanityWidth;if(ie67&&(divBodyEl.scrollHeight>divBodyEl.offsetHeight||divBody.css('overflow-y')=="scroll")){tableStyle.width=_fnStringToCss(correction-barWidth);}
if(scrollX===""||scrollXInner!==""){_fnLog(settings,1,'Possible column misalignment',6);}}
else
{correction='100%';}
divBodyStyle.width=_fnStringToCss(correction);divHeaderStyle.width=_fnStringToCss(correction);if(footer){settings.nScrollFoot.style.width=_fnStringToCss(correction);}
if(!scrollY){if(ie67){divBodyStyle.height=_fnStringToCss(tableEl.offsetHeight+barWidth);}}
var iOuterWidth=table.outerWidth();divHeaderTable[0].style.width=_fnStringToCss(iOuterWidth);divHeaderInnerStyle.width=_fnStringToCss(iOuterWidth);var bScrolling=table.height()>divBodyEl.clientHeight||divBody.css('overflow-y')=="scroll";var padding='padding'+(browser.bScrollbarLeft?'Left':'Right');divHeaderInnerStyle[padding]=bScrolling?barWidth+"px":"0px";if(footer){divFooterTable[0].style.width=_fnStringToCss(iOuterWidth);divFooterInner[0].style.width=_fnStringToCss(iOuterWidth);divFooterInner[0].style[padding]=bScrolling?barWidth+"px":"0px";}
divBody.scroll();if((settings.bSorted||settings.bFiltered)&&!settings._drawHold){divBodyEl.scrollTop=0;}}
function _fnApplyToChildren(fn,an1,an2)
{var index=0,i=0,iLen=an1.length;var nNode1,nNode2;while(i<iLen){nNode1=an1[i].firstChild;nNode2=an2?an2[i].firstChild:null;while(nNode1){if(nNode1.nodeType===1){if(an2){fn(nNode1,nNode2,index);}
else{fn(nNode1,index);}
index++;}
nNode1=nNode1.nextSibling;nNode2=an2?nNode2.nextSibling:null;}
i++;}}
var __re_html_remove=/<.*?>/g;function _fnCalculateColumnWidths(oSettings)
{var
table=oSettings.nTable,columns=oSettings.aoColumns,scroll=oSettings.oScroll,scrollY=scroll.sY,scrollX=scroll.sX,scrollXInner=scroll.sXInner,columnCount=columns.length,visibleColumns=_fnGetColumns(oSettings,'bVisible'),headerCells=$('th',oSettings.nTHead),tableWidthAttr=table.getAttribute('width'),tableContainer=table.parentNode,userInputs=false,i,column,columnIdx,width,outerWidth,browser=oSettings.oBrowser,ie67=browser.bScrollOversize;var styleWidth=table.style.width;if(styleWidth&&styleWidth.indexOf('%')!==-1){tableWidthAttr=styleWidth;}
for(i=0;i<visibleColumns.length;i++){column=columns[visibleColumns[i]];if(column.sWidth!==null){column.sWidth=_fnConvertToWidth(column.sWidthOrig,tableContainer);userInputs=true;}}
if(ie67||!userInputs&&!scrollX&&!scrollY&&columnCount==_fnVisbleColumns(oSettings)&&columnCount==headerCells.length){for(i=0;i<columnCount;i++){var colIdx=_fnVisibleToColumnIndex(oSettings,i);if(colIdx!==null){columns[colIdx].sWidth=_fnStringToCss(headerCells.eq(i).width());}}}
else
{var tmpTable=$(table).clone().css('visibility','hidden').removeAttr('id');tmpTable.find('tbody tr').remove();var tr=$('<tr/>').appendTo(tmpTable.find('tbody'));tmpTable.find('thead, tfoot').remove();tmpTable.append($(oSettings.nTHead).clone()).append($(oSettings.nTFoot).clone());tmpTable.find('tfoot th, tfoot td').css('width','');headerCells=_fnGetUniqueThs(oSettings,tmpTable.find('thead')[0]);for(i=0;i<visibleColumns.length;i++){column=columns[visibleColumns[i]];headerCells[i].style.width=column.sWidthOrig!==null&&column.sWidthOrig!==''?_fnStringToCss(column.sWidthOrig):'';if(column.sWidthOrig&&scrollX){$(headerCells[i]).append($('<div/>').css({width:column.sWidthOrig,margin:0,padding:0,border:0,height:1}));}}
if(oSettings.aoData.length){for(i=0;i<visibleColumns.length;i++){columnIdx=visibleColumns[i];column=columns[columnIdx];$(_fnGetWidestNode(oSettings,columnIdx)).clone(false).append(column.sContentPadding).appendTo(tr);}}
var holder=$('<div/>').css(scrollX||scrollY?{position:'absolute',top:0,left:0,height:1,right:0,overflow:'hidden'}:{}).append(tmpTable).appendTo(tableContainer);if(scrollX&&scrollXInner){tmpTable.width(scrollXInner);}
else if(scrollX){tmpTable.css('width','auto');tmpTable.removeAttr('width');if(tmpTable.width()<tableContainer.clientWidth&&tableWidthAttr){tmpTable.width(tableContainer.clientWidth);}}
else if(scrollY){tmpTable.width(tableContainer.clientWidth);}
else if(tableWidthAttr){tmpTable.width(tableWidthAttr);}
var total=0;for(i=0;i<visibleColumns.length;i++){var cell=$(headerCells[i]);var border=cell.outerWidth()-cell.width();var bounding=browser.bBounding?Math.ceil(headerCells[i].getBoundingClientRect().width):cell.outerWidth();total+=bounding;columns[visibleColumns[i]].sWidth=_fnStringToCss(bounding-border);}
table.style.width=_fnStringToCss(total);holder.remove();}
if(tableWidthAttr){table.style.width=_fnStringToCss(tableWidthAttr);}
if((tableWidthAttr||scrollX)&&!oSettings._reszEvt){var bindResize=function(){$(window).bind('resize.DT-'+oSettings.sInstance,_fnThrottle(function(){_fnAdjustColumnSizing(oSettings);}));};if(ie67){setTimeout(bindResize,1000);}
else{bindResize();}
oSettings._reszEvt=true;}}
function _fnThrottle(fn,freq){var
frequency=freq!==undefined?freq:200,last,timer;return function(){var
that=this,now=+new Date(),args=arguments;if(last&&now<last+frequency){clearTimeout(timer);timer=setTimeout(function(){last=undefined;fn.apply(that,args);},frequency);}
else{last=now;fn.apply(that,args);}};}
function _fnConvertToWidth(width,parent)
{if(!width){return 0;}
var n=$('<div/>').css('width',_fnStringToCss(width)).appendTo(parent||document.body);var val=n[0].offsetWidth;n.remove();return val;}
function _fnGetWidestNode(settings,colIdx)
{var idx=_fnGetMaxLenString(settings,colIdx);if(idx<0){return null;}
var data=settings.aoData[idx];return!data.nTr?$('<td/>').html(_fnGetCellData(settings,idx,colIdx,'display'))[0]:data.anCells[colIdx];}
function _fnGetMaxLenString(settings,colIdx)
{var s,max=-1,maxIdx=-1;for(var i=0,ien=settings.aoData.length;i<ien;i++){s=_fnGetCellData(settings,i,colIdx,'display')+'';s=s.replace(__re_html_remove,'');s=s.replace(/&nbsp;/g,' ');if(s.length>max){max=s.length;maxIdx=i;}}
return maxIdx;}
function _fnStringToCss(s)
{if(s===null){return'0px';}
if(typeof s=='number'){return s<0?'0px':s+'px';}
return s.match(/\d$/)?s+'px':s;}
function _fnSortFlatten(settings)
{var
i,iLen,k,kLen,aSort=[],aiOrig=[],aoColumns=settings.aoColumns,aDataSort,iCol,sType,srcCol,fixed=settings.aaSortingFixed,fixedObj=$.isPlainObject(fixed),nestedSort=[],add=function(a){if(a.length&&!$.isArray(a[0])){nestedSort.push(a);}
else{$.merge(nestedSort,a);}};if($.isArray(fixed)){add(fixed);}
if(fixedObj&&fixed.pre){add(fixed.pre);}
add(settings.aaSorting);if(fixedObj&&fixed.post){add(fixed.post);}
for(i=0;i<nestedSort.length;i++)
{srcCol=nestedSort[i][0];aDataSort=aoColumns[srcCol].aDataSort;for(k=0,kLen=aDataSort.length;k<kLen;k++)
{iCol=aDataSort[k];sType=aoColumns[iCol].sType||'string';if(nestedSort[i]._idx===undefined){nestedSort[i]._idx=$.inArray(nestedSort[i][1],aoColumns[iCol].asSorting);}
aSort.push({src:srcCol,col:iCol,dir:nestedSort[i][1],index:nestedSort[i]._idx,type:sType,formatter:DataTable.ext.type.order[sType+"-pre"]});}}
return aSort;}
function _fnSort(oSettings)
{var
i,ien,iLen,j,jLen,k,kLen,sDataType,nTh,aiOrig=[],oExtSort=DataTable.ext.type.order,aoData=oSettings.aoData,aoColumns=oSettings.aoColumns,aDataSort,data,iCol,sType,oSort,formatters=0,sortCol,displayMaster=oSettings.aiDisplayMaster,aSort;_fnColumnTypes(oSettings);aSort=_fnSortFlatten(oSettings);for(i=0,ien=aSort.length;i<ien;i++){sortCol=aSort[i];if(sortCol.formatter){formatters++;}
_fnSortData(oSettings,sortCol.col);}
if(_fnDataSource(oSettings)!='ssp'&&aSort.length!==0)
{for(i=0,iLen=displayMaster.length;i<iLen;i++){aiOrig[displayMaster[i]]=i;}
if(formatters===aSort.length){displayMaster.sort(function(a,b){var
x,y,k,test,sort,len=aSort.length,dataA=aoData[a]._aSortData,dataB=aoData[b]._aSortData;for(k=0;k<len;k++){sort=aSort[k];x=dataA[sort.col];y=dataB[sort.col];test=x<y?-1:x>y?1:0;if(test!==0){return sort.dir==='asc'?test:-test;}}
x=aiOrig[a];y=aiOrig[b];return x<y?-1:x>y?1:0;});}
else{displayMaster.sort(function(a,b){var
x,y,k,l,test,sort,fn,len=aSort.length,dataA=aoData[a]._aSortData,dataB=aoData[b]._aSortData;for(k=0;k<len;k++){sort=aSort[k];x=dataA[sort.col];y=dataB[sort.col];fn=oExtSort[sort.type+"-"+sort.dir]||oExtSort["string-"+sort.dir];test=fn(x,y);if(test!==0){return test;}}
x=aiOrig[a];y=aiOrig[b];return x<y?-1:x>y?1:0;});}}
oSettings.bSorted=true;}
function _fnSortAria(settings)
{var label;var nextSort;var columns=settings.aoColumns;var aSort=_fnSortFlatten(settings);var oAria=settings.oLanguage.oAria;for(var i=0,iLen=columns.length;i<iLen;i++)
{var col=columns[i];var asSorting=col.asSorting;var sTitle=col.sTitle.replace(/<.*?>/g,"");var th=col.nTh;th.removeAttribute('aria-sort');if(col.bSortable){if(aSort.length>0&&aSort[0].col==i){th.setAttribute('aria-sort',aSort[0].dir=="asc"?"ascending":"descending");nextSort=asSorting[aSort[0].index+1]||asSorting[0];}
else{nextSort=asSorting[0];}
label=sTitle+(nextSort==="asc"?oAria.sSortAscending:oAria.sSortDescending);}
else{label=sTitle;}
th.setAttribute('aria-label',label);}}
function _fnSortListener(settings,colIdx,append,callback)
{var col=settings.aoColumns[colIdx];var sorting=settings.aaSorting;var asSorting=col.asSorting;var nextSortIdx;var next=function(a,overflow){var idx=a._idx;if(idx===undefined){idx=$.inArray(a[1],asSorting);}
return idx+1<asSorting.length?idx+1:overflow?null:0;};if(typeof sorting[0]==='number'){sorting=settings.aaSorting=[sorting];}
if(append&&settings.oFeatures.bSortMulti){var sortIdx=$.inArray(colIdx,_pluck(sorting,'0'));if(sortIdx!==-1){nextSortIdx=next(sorting[sortIdx],true);if(nextSortIdx===null&&sorting.length===1){nextSortIdx=0;}
if(nextSortIdx===null){sorting.splice(sortIdx,1);}
else{sorting[sortIdx][1]=asSorting[nextSortIdx];sorting[sortIdx]._idx=nextSortIdx;}}
else{sorting.push([colIdx,asSorting[0],0]);sorting[sorting.length-1]._idx=0;}}
else if(sorting.length&&sorting[0][0]==colIdx){nextSortIdx=next(sorting[0]);sorting.length=1;sorting[0][1]=asSorting[nextSortIdx];sorting[0]._idx=nextSortIdx;}
else{sorting.length=0;sorting.push([colIdx,asSorting[0]]);sorting[0]._idx=0;}
_fnReDraw(settings);if(typeof callback=='function'){callback(settings);}}
function _fnSortAttachListener(settings,attachTo,colIdx,callback)
{var col=settings.aoColumns[colIdx];_fnBindAction(attachTo,{},function(e){if(col.bSortable===false){return;}
if(settings.oFeatures.bProcessing){_fnProcessingDisplay(settings,true);setTimeout(function(){_fnSortListener(settings,colIdx,e.shiftKey,callback);if(_fnDataSource(settings)!=='ssp'){_fnProcessingDisplay(settings,false);}},0);}
else{_fnSortListener(settings,colIdx,e.shiftKey,callback);}});}
function _fnSortingClasses(settings)
{var oldSort=settings.aLastSort;var sortClass=settings.oClasses.sSortColumn;var sort=_fnSortFlatten(settings);var features=settings.oFeatures;var i,ien,colIdx;if(features.bSort&&features.bSortClasses){for(i=0,ien=oldSort.length;i<ien;i++){colIdx=oldSort[i].src;$(_pluck(settings.aoData,'anCells',colIdx)).removeClass(sortClass+(i<2?i+1:3));}
for(i=0,ien=sort.length;i<ien;i++){colIdx=sort[i].src;$(_pluck(settings.aoData,'anCells',colIdx)).addClass(sortClass+(i<2?i+1:3));}}
settings.aLastSort=sort;}
function _fnSortData(settings,idx)
{var column=settings.aoColumns[idx];var customSort=DataTable.ext.order[column.sSortDataType];var customData;if(customSort){customData=customSort.call(settings.oInstance,settings,idx,_fnColumnIndexToVisible(settings,idx));}
var row,cellData;var formatter=DataTable.ext.type.order[column.sType+"-pre"];for(var i=0,ien=settings.aoData.length;i<ien;i++){row=settings.aoData[i];if(!row._aSortData){row._aSortData=[];}
if(!row._aSortData[idx]||customSort){cellData=customSort?customData[i]:_fnGetCellData(settings,i,idx,'sort');row._aSortData[idx]=formatter?formatter(cellData):cellData;}}}
function _fnSaveState(settings)
{if(!settings.oFeatures.bStateSave||settings.bDestroying)
{return;}
var state={time:+new Date(),start:settings._iDisplayStart,length:settings._iDisplayLength,order:$.extend(true,[],settings.aaSorting),search:_fnSearchToCamel(settings.oPreviousSearch),columns:$.map(settings.aoColumns,function(col,i){return{visible:col.bVisible,search:_fnSearchToCamel(settings.aoPreSearchCols[i])};})};_fnCallbackFire(settings,"aoStateSaveParams",'stateSaveParams',[settings,state]);settings.oSavedState=state;settings.fnStateSaveCallback.call(settings.oInstance,settings,state);}
function _fnLoadState(settings,oInit)
{var i,ien;var columns=settings.aoColumns;if(!settings.oFeatures.bStateSave){return;}
var state=settings.fnStateLoadCallback.call(settings.oInstance,settings);if(!state||!state.time){return;}
var abStateLoad=_fnCallbackFire(settings,'aoStateLoadParams','stateLoadParams',[settings,state]);if($.inArray(false,abStateLoad)!==-1){return;}
var duration=settings.iStateDuration;if(duration>0&&state.time<+new Date()-(duration*1000)){return;}
if(columns.length!==state.columns.length){return;}
settings.oLoadedState=$.extend(true,{},state);if(state.start!==undefined){settings._iDisplayStart=state.start;settings.iInitDisplayStart=state.start;}
if(state.length!==undefined){settings._iDisplayLength=state.length;}
if(state.order!==undefined){settings.aaSorting=[];$.each(state.order,function(i,col){settings.aaSorting.push(col[0]>=columns.length?[0,col[1]]:col);});}
if(state.search!==undefined){$.extend(settings.oPreviousSearch,_fnSearchToHung(state.search));}
for(i=0,ien=state.columns.length;i<ien;i++){var col=state.columns[i];if(col.visible!==undefined){columns[i].bVisible=col.visible;}
if(col.search!==undefined){$.extend(settings.aoPreSearchCols[i],_fnSearchToHung(col.search));}}
_fnCallbackFire(settings,'aoStateLoaded','stateLoaded',[settings,state]);}
function _fnSettingsFromNode(table)
{var settings=DataTable.settings;var idx=$.inArray(table,_pluck(settings,'nTable'));return idx!==-1?settings[idx]:null;}
function _fnLog(settings,level,msg,tn)
{msg='DataTables warning: '+
(settings?'table id='+settings.sTableId+' - ':'')+msg;if(tn){msg+='. For more information about this error, please see '+'http://datatables.net/tn/'+tn;}
if(!level){var ext=DataTable.ext;var type=ext.sErrMode||ext.errMode;if(settings){_fnCallbackFire(settings,null,'error',[settings,tn,msg]);}
if(type=='alert'){alert(msg);}
else if(type=='throw'){throw new Error(msg);}
else if(typeof type=='function'){type(settings,tn,msg);}}
else if(window.console&&console.log){console.log(msg);}}
function _fnMap(ret,src,name,mappedName)
{if($.isArray(name)){$.each(name,function(i,val){if($.isArray(val)){_fnMap(ret,src,val[0],val[1]);}
else{_fnMap(ret,src,val);}});return;}
if(mappedName===undefined){mappedName=name;}
if(src[name]!==undefined){ret[mappedName]=src[name];}}
function _fnExtend(out,extender,breakRefs)
{var val;for(var prop in extender){if(extender.hasOwnProperty(prop)){val=extender[prop];if($.isPlainObject(val)){if(!$.isPlainObject(out[prop])){out[prop]={};}
$.extend(true,out[prop],val);}
else if(breakRefs&&prop!=='data'&&prop!=='aaData'&&$.isArray(val)){out[prop]=val.slice();}
else{out[prop]=val;}}}
return out;}
function _fnBindAction(n,oData,fn)
{$(n).bind('click.DT',oData,function(e){n.blur();fn(e);}).bind('keypress.DT',oData,function(e){if(e.which===13){e.preventDefault();fn(e);}}).bind('selectstart.DT',function(){return false;});}
function _fnCallbackReg(oSettings,sStore,fn,sName)
{if(fn)
{oSettings[sStore].push({"fn":fn,"sName":sName});}}
function _fnCallbackFire(settings,callbackArr,eventName,args)
{var ret=[];if(callbackArr){ret=$.map(settings[callbackArr].slice().reverse(),function(val,i){return val.fn.apply(settings.oInstance,args);});}
if(eventName!==null){var e=$.Event(eventName+'.dt');$(settings.nTable).trigger(e,args);ret.push(e.result);}
return ret;}
function _fnLengthOverflow(settings)
{var
start=settings._iDisplayStart,end=settings.fnDisplayEnd(),len=settings._iDisplayLength;if(start>=end)
{start=end-len;}
start-=(start%len);if(len===-1||start<0)
{start=0;}
settings._iDisplayStart=start;}
function _fnRenderer(settings,type)
{var renderer=settings.renderer;var host=DataTable.ext.renderer[type];if($.isPlainObject(renderer)&&renderer[type]){return host[renderer[type]]||host._;}
else if(typeof renderer==='string'){return host[renderer]||host._;}
return host._;}
function _fnDataSource(settings)
{if(settings.oFeatures.bServerSide){return'ssp';}
else if(settings.ajax||settings.sAjaxSource){return'ajax';}
return'dom';}
DataTable=function(options)
{this.$=function(sSelector,oOpts)
{return this.api(true).$(sSelector,oOpts);};this._=function(sSelector,oOpts)
{return this.api(true).rows(sSelector,oOpts).data();};this.api=function(traditional)
{return traditional?new _Api(_fnSettingsFromNode(this[_ext.iApiIndex])):new _Api(this);};this.fnAddData=function(data,redraw)
{var api=this.api(true);var rows=$.isArray(data)&&($.isArray(data[0])||$.isPlainObject(data[0]))?api.rows.add(data):api.row.add(data);if(redraw===undefined||redraw){api.draw();}
return rows.flatten().toArray();};this.fnAdjustColumnSizing=function(bRedraw)
{var api=this.api(true).columns.adjust();var settings=api.settings()[0];var scroll=settings.oScroll;if(bRedraw===undefined||bRedraw){api.draw(false);}
else if(scroll.sX!==""||scroll.sY!==""){_fnScrollDraw(settings);}};this.fnClearTable=function(bRedraw)
{var api=this.api(true).clear();if(bRedraw===undefined||bRedraw){api.draw();}};this.fnClose=function(nTr)
{this.api(true).row(nTr).child.hide();};this.fnDeleteRow=function(target,callback,redraw)
{var api=this.api(true);var rows=api.rows(target);var settings=rows.settings()[0];var data=settings.aoData[rows[0][0]];rows.remove();if(callback){callback.call(this,settings,data);}
if(redraw===undefined||redraw){api.draw();}
return data;};this.fnDestroy=function(remove)
{this.api(true).destroy(remove);};this.fnDraw=function(complete)
{this.api(true).draw(complete);};this.fnFilter=function(sInput,iColumn,bRegex,bSmart,bShowGlobal,bCaseInsensitive)
{var api=this.api(true);if(iColumn===null||iColumn===undefined){api.search(sInput,bRegex,bSmart,bCaseInsensitive);}
else{api.column(iColumn).search(sInput,bRegex,bSmart,bCaseInsensitive);}
api.draw();};this.fnGetData=function(src,col)
{var api=this.api(true);if(src!==undefined){var type=src.nodeName?src.nodeName.toLowerCase():'';return col!==undefined||type=='td'||type=='th'?api.cell(src,col).data():api.row(src).data()||null;}
return api.data().toArray();};this.fnGetNodes=function(iRow)
{var api=this.api(true);return iRow!==undefined?api.row(iRow).node():api.rows().nodes().flatten().toArray();};this.fnGetPosition=function(node)
{var api=this.api(true);var nodeName=node.nodeName.toUpperCase();if(nodeName=='TR'){return api.row(node).index();}
else if(nodeName=='TD'||nodeName=='TH'){var cell=api.cell(node).index();return[cell.row,cell.columnVisible,cell.column];}
return null;};this.fnIsOpen=function(nTr)
{return this.api(true).row(nTr).child.isShown();};this.fnOpen=function(nTr,mHtml,sClass)
{return this.api(true).row(nTr).child(mHtml,sClass).show().child()[0];};this.fnPageChange=function(mAction,bRedraw)
{var api=this.api(true).page(mAction);if(bRedraw===undefined||bRedraw){api.draw(false);}};this.fnSetColumnVis=function(iCol,bShow,bRedraw)
{var api=this.api(true).column(iCol).visible(bShow);if(bRedraw===undefined||bRedraw){api.columns.adjust().draw();}};this.fnSettings=function()
{return _fnSettingsFromNode(this[_ext.iApiIndex]);};this.fnSort=function(aaSort)
{this.api(true).order(aaSort).draw();};this.fnSortListener=function(nNode,iColumn,fnCallback)
{this.api(true).order.listener(nNode,iColumn,fnCallback);};this.fnUpdate=function(mData,mRow,iColumn,bRedraw,bAction)
{var api=this.api(true);if(iColumn===undefined||iColumn===null){api.row(mRow).data(mData);}
else{api.cell(mRow,iColumn).data(mData);}
if(bAction===undefined||bAction){api.columns.adjust();}
if(bRedraw===undefined||bRedraw){api.draw();}
return 0;};this.fnVersionCheck=_ext.fnVersionCheck;var _that=this;var emptyInit=options===undefined;var len=this.length;if(emptyInit){options={};}
this.oApi=this.internal=_ext.internal;for(var fn in DataTable.ext.internal){if(fn){this[fn]=_fnExternApiFunc(fn);}}
this.each(function(){var o={};var oInit=len>1?_fnExtend(o,options,true):options;var i=0,iLen,j,jLen,k,kLen;var sId=this.getAttribute('id');var bInitHandedOff=false;var defaults=DataTable.defaults;var $this=$(this);if(this.nodeName.toLowerCase()!='table')
{_fnLog(null,0,'Non-table node initialisation ('+this.nodeName+')',2);return;}
_fnCompatOpts(defaults);_fnCompatCols(defaults.column);_fnCamelToHungarian(defaults,defaults,true);_fnCamelToHungarian(defaults.column,defaults.column,true);_fnCamelToHungarian(defaults,$.extend(oInit,$this.data()));var allSettings=DataTable.settings;for(i=0,iLen=allSettings.length;i<iLen;i++)
{var s=allSettings[i];if(s.nTable==this||s.nTHead.parentNode==this||(s.nTFoot&&s.nTFoot.parentNode==this))
{var bRetrieve=oInit.bRetrieve!==undefined?oInit.bRetrieve:defaults.bRetrieve;var bDestroy=oInit.bDestroy!==undefined?oInit.bDestroy:defaults.bDestroy;if(emptyInit||bRetrieve)
{return s.oInstance;}
else if(bDestroy)
{s.oInstance.fnDestroy();break;}
else
{_fnLog(s,0,'Cannot reinitialise DataTable',3);return;}}
if(s.sTableId==this.id)
{allSettings.splice(i,1);break;}}
if(sId===null||sId==="")
{sId="DataTables_Table_"+(DataTable.ext._unique++);this.id=sId;}
var oSettings=$.extend(true,{},DataTable.models.oSettings,{"sDestroyWidth":$this[0].style.width,"sInstance":sId,"sTableId":sId});oSettings.nTable=this;oSettings.oApi=_that.internal;oSettings.oInit=oInit;allSettings.push(oSettings);oSettings.oInstance=(_that.length===1)?_that:$this.dataTable();_fnCompatOpts(oInit);if(oInit.oLanguage)
{_fnLanguageCompat(oInit.oLanguage);}
if(oInit.aLengthMenu&&!oInit.iDisplayLength)
{oInit.iDisplayLength=$.isArray(oInit.aLengthMenu[0])?oInit.aLengthMenu[0][0]:oInit.aLengthMenu[0];}
oInit=_fnExtend($.extend(true,{},defaults),oInit);_fnMap(oSettings.oFeatures,oInit,["bPaginate","bLengthChange","bFilter","bSort","bSortMulti","bInfo","bProcessing","bAutoWidth","bSortClasses","bServerSide","bDeferRender"]);_fnMap(oSettings,oInit,["asStripeClasses","ajax","fnServerData","fnFormatNumber","sServerMethod","aaSorting","aaSortingFixed","aLengthMenu","sPaginationType","sAjaxSource","sAjaxDataProp","iStateDuration","sDom","bSortCellsTop","iTabIndex","fnStateLoadCallback","fnStateSaveCallback","renderer","searchDelay","rowId",["iCookieDuration","iStateDuration"],["oSearch","oPreviousSearch"],["aoSearchCols","aoPreSearchCols"],["iDisplayLength","_iDisplayLength"],["bJQueryUI","bJUI"]]);_fnMap(oSettings.oScroll,oInit,[["sScrollX","sX"],["sScrollXInner","sXInner"],["sScrollY","sY"],["bScrollCollapse","bCollapse"]]);_fnMap(oSettings.oLanguage,oInit,"fnInfoCallback");_fnCallbackReg(oSettings,'aoDrawCallback',oInit.fnDrawCallback,'user');_fnCallbackReg(oSettings,'aoServerParams',oInit.fnServerParams,'user');_fnCallbackReg(oSettings,'aoStateSaveParams',oInit.fnStateSaveParams,'user');_fnCallbackReg(oSettings,'aoStateLoadParams',oInit.fnStateLoadParams,'user');_fnCallbackReg(oSettings,'aoStateLoaded',oInit.fnStateLoaded,'user');_fnCallbackReg(oSettings,'aoRowCallback',oInit.fnRowCallback,'user');_fnCallbackReg(oSettings,'aoRowCreatedCallback',oInit.fnCreatedRow,'user');_fnCallbackReg(oSettings,'aoHeaderCallback',oInit.fnHeaderCallback,'user');_fnCallbackReg(oSettings,'aoFooterCallback',oInit.fnFooterCallback,'user');_fnCallbackReg(oSettings,'aoInitComplete',oInit.fnInitComplete,'user');_fnCallbackReg(oSettings,'aoPreDrawCallback',oInit.fnPreDrawCallback,'user');oSettings.rowIdFn=_fnGetObjectDataFn(oInit.rowId);_fnBrowserDetect(oSettings);var oClasses=oSettings.oClasses;if(oInit.bJQueryUI)
{$.extend(oClasses,DataTable.ext.oJUIClasses,oInit.oClasses);if(oInit.sDom===defaults.sDom&&defaults.sDom==="lfrtip")
{oSettings.sDom='<"H"lfr>t<"F"ip>';}
if(!oSettings.renderer){oSettings.renderer='jqueryui';}
else if($.isPlainObject(oSettings.renderer)&&!oSettings.renderer.header){oSettings.renderer.header='jqueryui';}}
else
{$.extend(oClasses,DataTable.ext.classes,oInit.oClasses);}
$this.addClass(oClasses.sTable);if(oSettings.iInitDisplayStart===undefined)
{oSettings.iInitDisplayStart=oInit.iDisplayStart;oSettings._iDisplayStart=oInit.iDisplayStart;}
if(oInit.iDeferLoading!==null)
{oSettings.bDeferLoading=true;var tmp=$.isArray(oInit.iDeferLoading);oSettings._iRecordsDisplay=tmp?oInit.iDeferLoading[0]:oInit.iDeferLoading;oSettings._iRecordsTotal=tmp?oInit.iDeferLoading[1]:oInit.iDeferLoading;}
var oLanguage=oSettings.oLanguage;$.extend(true,oLanguage,oInit.oLanguage);if(oLanguage.sUrl!=="")
{$.ajax({dataType:'json',url:oLanguage.sUrl,success:function(json){_fnLanguageCompat(json);_fnCamelToHungarian(defaults.oLanguage,json);$.extend(true,oLanguage,json);_fnInitialise(oSettings);},error:function(){_fnInitialise(oSettings);}});bInitHandedOff=true;}
if(oInit.asStripeClasses===null)
{oSettings.asStripeClasses=[oClasses.sStripeOdd,oClasses.sStripeEven];}
var stripeClasses=oSettings.asStripeClasses;var rowOne=$this.children('tbody').find('tr').eq(0);if($.inArray(true,$.map(stripeClasses,function(el,i){return rowOne.hasClass(el);}))!==-1){$('tbody tr',this).removeClass(stripeClasses.join(' '));oSettings.asDestroyStripes=stripeClasses.slice();}
var anThs=[];var aoColumnsInit;var nThead=this.getElementsByTagName('thead');if(nThead.length!==0)
{_fnDetectHeader(oSettings.aoHeader,nThead[0]);anThs=_fnGetUniqueThs(oSettings);}
if(oInit.aoColumns===null)
{aoColumnsInit=[];for(i=0,iLen=anThs.length;i<iLen;i++)
{aoColumnsInit.push(null);}}
else
{aoColumnsInit=oInit.aoColumns;}
for(i=0,iLen=aoColumnsInit.length;i<iLen;i++)
{_fnAddColumn(oSettings,anThs?anThs[i]:null);}
_fnApplyColumnDefs(oSettings,oInit.aoColumnDefs,aoColumnsInit,function(iCol,oDef){_fnColumnOptions(oSettings,iCol,oDef);});if(rowOne.length){var a=function(cell,name){return cell.getAttribute('data-'+name)!==null?name:null;};$(rowOne[0]).children('th, td').each(function(i,cell){var col=oSettings.aoColumns[i];if(col.mData===i){var sort=a(cell,'sort')||a(cell,'order');var filter=a(cell,'filter')||a(cell,'search');if(sort!==null||filter!==null){col.mData={_:i+'.display',sort:sort!==null?i+'.@data-'+sort:undefined,type:sort!==null?i+'.@data-'+sort:undefined,filter:filter!==null?i+'.@data-'+filter:undefined};_fnColumnOptions(oSettings,i);}}});}
var features=oSettings.oFeatures;if(oInit.bStateSave)
{features.bStateSave=true;_fnLoadState(oSettings,oInit);_fnCallbackReg(oSettings,'aoDrawCallback',_fnSaveState,'state_save');}
if(oInit.aaSorting===undefined)
{var sorting=oSettings.aaSorting;for(i=0,iLen=sorting.length;i<iLen;i++)
{sorting[i][1]=oSettings.aoColumns[i].asSorting[0];}}
_fnSortingClasses(oSettings);if(features.bSort)
{_fnCallbackReg(oSettings,'aoDrawCallback',function(){if(oSettings.bSorted){var aSort=_fnSortFlatten(oSettings);var sortedColumns={};$.each(aSort,function(i,val){sortedColumns[val.src]=val.dir;});_fnCallbackFire(oSettings,null,'order',[oSettings,aSort,sortedColumns]);_fnSortAria(oSettings);}});}
_fnCallbackReg(oSettings,'aoDrawCallback',function(){if(oSettings.bSorted||_fnDataSource(oSettings)==='ssp'||features.bDeferRender){_fnSortingClasses(oSettings);}},'sc');var captions=$this.children('caption').each(function(){this._captionSide=$this.css('caption-side');});var thead=$this.children('thead');if(thead.length===0)
{thead=$('<thead/>').appendTo(this);}
oSettings.nTHead=thead[0];var tbody=$this.children('tbody');if(tbody.length===0)
{tbody=$('<tbody/>').appendTo(this);}
oSettings.nTBody=tbody[0];var tfoot=$this.children('tfoot');if(tfoot.length===0&&captions.length>0&&(oSettings.oScroll.sX!==""||oSettings.oScroll.sY!==""))
{tfoot=$('<tfoot/>').appendTo(this);}
if(tfoot.length===0||tfoot.children().length===0){$this.addClass(oClasses.sNoFooter);}
else if(tfoot.length>0){oSettings.nTFoot=tfoot[0];_fnDetectHeader(oSettings.aoFooter,oSettings.nTFoot);}
if(oInit.aaData)
{for(i=0;i<oInit.aaData.length;i++)
{_fnAddData(oSettings,oInit.aaData[i]);}}
else if(oSettings.bDeferLoading||_fnDataSource(oSettings)=='dom')
{_fnAddTr(oSettings,$(oSettings.nTBody).children('tr'));}
oSettings.aiDisplay=oSettings.aiDisplayMaster.slice();oSettings.bInitialised=true;if(bInitHandedOff===false)
{_fnInitialise(oSettings);}});_that=null;return this;};var __apiStruct=[];var __arrayProto=Array.prototype;var _toSettings=function(mixed)
{var idx,jq;var settings=DataTable.settings;var tables=$.map(settings,function(el,i){return el.nTable;});if(!mixed){return[];}
else if(mixed.nTable&&mixed.oApi){return[mixed];}
else if(mixed.nodeName&&mixed.nodeName.toLowerCase()==='table'){idx=$.inArray(mixed,tables);return idx!==-1?[settings[idx]]:null;}
else if(mixed&&typeof mixed.settings==='function'){return mixed.settings().toArray();}
else if(typeof mixed==='string'){jq=$(mixed);}
else if(mixed instanceof $){jq=mixed;}
if(jq){return jq.map(function(i){idx=$.inArray(this,tables);return idx!==-1?settings[idx]:null;}).toArray();}};_Api=function(context,data)
{if(!(this instanceof _Api)){return new _Api(context,data);}
var settings=[];var ctxSettings=function(o){var a=_toSettings(o);if(a){settings=settings.concat(a);}};if($.isArray(context)){for(var i=0,ien=context.length;i<ien;i++){ctxSettings(context[i]);}}
else{ctxSettings(context);}
this.context=_unique(settings);if(data){$.merge(this,data);}
this.selector={rows:null,cols:null,opts:null};_Api.extend(this,this,__apiStruct);};DataTable.Api=_Api;$.extend(_Api.prototype,{any:function()
{return this.count()!==0;},concat:__arrayProto.concat,context:[],count:function()
{return this.flatten().length;},each:function(fn)
{for(var i=0,ien=this.length;i<ien;i++){fn.call(this,this[i],i,this);}
return this;},eq:function(idx)
{var ctx=this.context;return ctx.length>idx?new _Api(ctx[idx],this[idx]):null;},filter:function(fn)
{var a=[];if(__arrayProto.filter){a=__arrayProto.filter.call(this,fn,this);}
else{for(var i=0,ien=this.length;i<ien;i++){if(fn.call(this,this[i],i,this)){a.push(this[i]);}}}
return new _Api(this.context,a);},flatten:function()
{var a=[];return new _Api(this.context,a.concat.apply(a,this.toArray()));},join:__arrayProto.join,indexOf:__arrayProto.indexOf||function(obj,start)
{for(var i=(start||0),ien=this.length;i<ien;i++){if(this[i]===obj){return i;}}
return-1;},iterator:function(flatten,type,fn,alwaysNew){var
a=[],ret,i,ien,j,jen,context=this.context,rows,items,item,selector=this.selector;if(typeof flatten==='string'){alwaysNew=fn;fn=type;type=flatten;flatten=false;}
for(i=0,ien=context.length;i<ien;i++){var apiInst=new _Api(context[i]);if(type==='table'){ret=fn.call(apiInst,context[i],i);if(ret!==undefined){a.push(ret);}}
else if(type==='columns'||type==='rows'){ret=fn.call(apiInst,context[i],this[i],i);if(ret!==undefined){a.push(ret);}}
else if(type==='column'||type==='column-rows'||type==='row'||type==='cell'){items=this[i];if(type==='column-rows'){rows=_selector_row_indexes(context[i],selector.opts);}
for(j=0,jen=items.length;j<jen;j++){item=items[j];if(type==='cell'){ret=fn.call(apiInst,context[i],item.row,item.column,i,j);}
else{ret=fn.call(apiInst,context[i],item,i,j,rows);}
if(ret!==undefined){a.push(ret);}}}}
if(a.length||alwaysNew){var api=new _Api(context,flatten?a.concat.apply([],a):a);var apiSelector=api.selector;apiSelector.rows=selector.rows;apiSelector.cols=selector.cols;apiSelector.opts=selector.opts;return api;}
return this;},lastIndexOf:__arrayProto.lastIndexOf||function(obj,start)
{return this.indexOf.apply(this.toArray.reverse(),arguments);},length:0,map:function(fn)
{var a=[];if(__arrayProto.map){a=__arrayProto.map.call(this,fn,this);}
else{for(var i=0,ien=this.length;i<ien;i++){a.push(fn.call(this,this[i],i));}}
return new _Api(this.context,a);},pluck:function(prop)
{return this.map(function(el){return el[prop];});},pop:__arrayProto.pop,push:__arrayProto.push,reduce:__arrayProto.reduce||function(fn,init)
{return _fnReduce(this,fn,init,0,this.length,1);},reduceRight:__arrayProto.reduceRight||function(fn,init)
{return _fnReduce(this,fn,init,this.length-1,-1,-1);},reverse:__arrayProto.reverse,selector:null,shift:__arrayProto.shift,sort:__arrayProto.sort,splice:__arrayProto.splice,toArray:function()
{return __arrayProto.slice.call(this);},to$:function()
{return $(this);},toJQuery:function()
{return $(this);},unique:function()
{return new _Api(this.context,_unique(this));},unshift:__arrayProto.unshift});_Api.extend=function(scope,obj,ext)
{if(!ext.length||!obj||(!(obj instanceof _Api)&&!obj.__dt_wrapper)){return;}
var
i,ien,j,jen,struct,inner,methodScoping=function(scope,fn,struc){return function(){var ret=fn.apply(scope,arguments);_Api.extend(ret,ret,struc.methodExt);return ret;};};for(i=0,ien=ext.length;i<ien;i++){struct=ext[i];obj[struct.name]=typeof struct.val==='function'?methodScoping(scope,struct.val,struct):$.isPlainObject(struct.val)?{}:struct.val;obj[struct.name].__dt_wrapper=true;_Api.extend(scope,obj[struct.name],struct.propExt);}};_Api.register=_api_register=function(name,val)
{if($.isArray(name)){for(var j=0,jen=name.length;j<jen;j++){_Api.register(name[j],val);}
return;}
var
i,ien,heir=name.split('.'),struct=__apiStruct,key,method;var find=function(src,name){for(var i=0,ien=src.length;i<ien;i++){if(src[i].name===name){return src[i];}}
return null;};for(i=0,ien=heir.length;i<ien;i++){method=heir[i].indexOf('()')!==-1;key=method?heir[i].replace('()',''):heir[i];var src=find(struct,key);if(!src){src={name:key,val:{},methodExt:[],propExt:[]};struct.push(src);}
if(i===ien-1){src.val=val;}
else{struct=method?src.methodExt:src.propExt;}}};_Api.registerPlural=_api_registerPlural=function(pluralName,singularName,val){_Api.register(pluralName,val);_Api.register(singularName,function(){var ret=val.apply(this,arguments);if(ret===this){return this;}
else if(ret instanceof _Api){return ret.length?$.isArray(ret[0])?new _Api(ret.context,ret[0]):ret[0]:undefined;}
return ret;});};var __table_selector=function(selector,a)
{if(typeof selector==='number'){return[a[selector]];}
var nodes=$.map(a,function(el,i){return el.nTable;});return $(nodes).filter(selector).map(function(i){var idx=$.inArray(this,nodes);return a[idx];}).toArray();};_api_register('tables()',function(selector){return selector?new _Api(__table_selector(selector,this.context)):this;});_api_register('table()',function(selector){var tables=this.tables(selector);var ctx=tables.context;return ctx.length?new _Api(ctx[0]):tables;});_api_registerPlural('tables().nodes()','table().node()',function(){return this.iterator('table',function(ctx){return ctx.nTable;},1);});_api_registerPlural('tables().body()','table().body()',function(){return this.iterator('table',function(ctx){return ctx.nTBody;},1);});_api_registerPlural('tables().header()','table().header()',function(){return this.iterator('table',function(ctx){return ctx.nTHead;},1);});_api_registerPlural('tables().footer()','table().footer()',function(){return this.iterator('table',function(ctx){return ctx.nTFoot;},1);});_api_registerPlural('tables().containers()','table().container()',function(){return this.iterator('table',function(ctx){return ctx.nTableWrapper;},1);});_api_register('draw()',function(paging){return this.iterator('table',function(settings){if(paging==='page'){_fnDraw(settings);}
else{if(typeof paging==='string'){paging=paging==='full-hold'?false:true;}
_fnReDraw(settings,paging===false);}});});_api_register('page()',function(action){if(action===undefined){return this.page.info().page;}
return this.iterator('table',function(settings){_fnPageChange(settings,action);});});_api_register('page.info()',function(action){if(this.context.length===0){return undefined;}
var
settings=this.context[0],start=settings._iDisplayStart,len=settings.oFeatures.bPaginate?settings._iDisplayLength:-1,visRecords=settings.fnRecordsDisplay(),all=len===-1;return{"page":all?0:Math.floor(start/len),"pages":all?1:Math.ceil(visRecords/len),"start":start,"end":settings.fnDisplayEnd(),"length":len,"recordsTotal":settings.fnRecordsTotal(),"recordsDisplay":visRecords,"serverSide":_fnDataSource(settings)==='ssp'};});_api_register('page.len()',function(len){if(len===undefined){return this.context.length!==0?this.context[0]._iDisplayLength:undefined;}
return this.iterator('table',function(settings){_fnLengthChange(settings,len);});});var __reload=function(settings,holdPosition,callback){if(callback){var api=new _Api(settings);api.one('draw',function(){callback(api.ajax.json());});}
if(_fnDataSource(settings)=='ssp'){_fnReDraw(settings,holdPosition);}
else{_fnProcessingDisplay(settings,true);var xhr=settings.jqXHR;if(xhr&&xhr.readyState!==4){xhr.abort();}
_fnBuildAjax(settings,[],function(json){_fnClearTable(settings);var data=_fnAjaxDataSrc(settings,json);for(var i=0,ien=data.length;i<ien;i++){_fnAddData(settings,data[i]);}
_fnReDraw(settings,holdPosition);_fnProcessingDisplay(settings,false);});}};_api_register('ajax.json()',function(){var ctx=this.context;if(ctx.length>0){return ctx[0].json;}});_api_register('ajax.params()',function(){var ctx=this.context;if(ctx.length>0){return ctx[0].oAjaxData;}});_api_register('ajax.reload()',function(callback,resetPaging){return this.iterator('table',function(settings){__reload(settings,resetPaging===false,callback);});});_api_register('ajax.url()',function(url){var ctx=this.context;if(url===undefined){if(ctx.length===0){return undefined;}
ctx=ctx[0];return ctx.ajax?$.isPlainObject(ctx.ajax)?ctx.ajax.url:ctx.ajax:ctx.sAjaxSource;}
return this.iterator('table',function(settings){if($.isPlainObject(settings.ajax)){settings.ajax.url=url;}
else{settings.ajax=url;}});});_api_register('ajax.url().load()',function(callback,resetPaging){return this.iterator('table',function(ctx){__reload(ctx,resetPaging===false,callback);});});var _selector_run=function(type,selector,selectFn,settings,opts)
{var
out=[],res,a,i,ien,j,jen,selectorType=typeof selector;if(!selector||selectorType==='string'||selectorType==='function'||selector.length===undefined){selector=[selector];}
for(i=0,ien=selector.length;i<ien;i++){a=selector[i]&&selector[i].split?selector[i].split(','):[selector[i]];for(j=0,jen=a.length;j<jen;j++){res=selectFn(typeof a[j]==='string'?$.trim(a[j]):a[j]);if(res&&res.length){out=out.concat(res);}}}
var ext=_ext.selector[type];if(ext.length){for(i=0,ien=ext.length;i<ien;i++){out=ext[i](settings,opts,out);}}
return _unique(out);};var _selector_opts=function(opts)
{if(!opts){opts={};}
if(opts.filter&&opts.search===undefined){opts.search=opts.filter;}
return $.extend({search:'none',order:'current',page:'all'},opts);};var _selector_first=function(inst)
{for(var i=0,ien=inst.length;i<ien;i++){if(inst[i].length>0){inst[0]=inst[i];inst[0].length=1;inst.length=1;inst.context=[inst.context[i]];return inst;}}
inst.length=0;return inst;};var _selector_row_indexes=function(settings,opts)
{var
i,ien,tmp,a=[],displayFiltered=settings.aiDisplay,displayMaster=settings.aiDisplayMaster;var
search=opts.search,order=opts.order,page=opts.page;if(_fnDataSource(settings)=='ssp'){return search==='removed'?[]:_range(0,displayMaster.length);}
else if(page=='current'){for(i=settings._iDisplayStart,ien=settings.fnDisplayEnd();i<ien;i++){a.push(displayFiltered[i]);}}
else if(order=='current'||order=='applied'){a=search=='none'?displayMaster.slice():search=='applied'?displayFiltered.slice():$.map(displayMaster,function(el,i){return $.inArray(el,displayFiltered)===-1?el:null;});}
else if(order=='index'||order=='original'){for(i=0,ien=settings.aoData.length;i<ien;i++){if(search=='none'){a.push(i);}
else{tmp=$.inArray(i,displayFiltered);if((tmp===-1&&search=='removed')||(tmp>=0&&search=='applied'))
{a.push(i);}}}}
return a;};var __row_selector=function(settings,selector,opts)
{var run=function(sel){var selInt=_intVal(sel);var i,ien;if(selInt!==null&&!opts){return[selInt];}
var rows=_selector_row_indexes(settings,opts);if(selInt!==null&&$.inArray(selInt,rows)!==-1){return[selInt];}
else if(!sel){return rows;}
if(typeof sel==='function'){return $.map(rows,function(idx){var row=settings.aoData[idx];return sel(idx,row._aData,row.nTr)?idx:null;});}
var nodes=_removeEmpty(_pluck_order(settings.aoData,rows,'nTr'));if(sel.nodeName){if($.inArray(sel,nodes)!==-1){return[sel._DT_RowIndex];}}
if(typeof sel==='string'&&sel.charAt(0)==='#'){var rowObj=settings.aIds[sel.replace(/^#/,'')];if(rowObj!==undefined){return[rowObj.idx];}}
return $(nodes).filter(sel).map(function(){return this._DT_RowIndex;}).toArray();};return _selector_run('row',selector,run,settings,opts);};_api_register('rows()',function(selector,opts){if(selector===undefined){selector='';}
else if($.isPlainObject(selector)){opts=selector;selector='';}
opts=_selector_opts(opts);var inst=this.iterator('table',function(settings){return __row_selector(settings,selector,opts);},1);inst.selector.rows=selector;inst.selector.opts=opts;return inst;});_api_register('rows().nodes()',function(){return this.iterator('row',function(settings,row){return settings.aoData[row].nTr||undefined;},1);});_api_register('rows().data()',function(){return this.iterator(true,'rows',function(settings,rows){return _pluck_order(settings.aoData,rows,'_aData');},1);});_api_registerPlural('rows().cache()','row().cache()',function(type){return this.iterator('row',function(settings,row){var r=settings.aoData[row];return type==='search'?r._aFilterData:r._aSortData;},1);});_api_registerPlural('rows().invalidate()','row().invalidate()',function(src){return this.iterator('row',function(settings,row){_fnInvalidate(settings,row,src);});});_api_registerPlural('rows().indexes()','row().index()',function(){return this.iterator('row',function(settings,row){return row;},1);});_api_registerPlural('rows().ids()','row().id()',function(hash){var a=[];var context=this.context;for(var i=0,ien=context.length;i<ien;i++){for(var j=0,jen=this[i].length;j<jen;j++){var id=context[i].rowIdFn(context[i].aoData[this[i][j]]._aData);a.push((hash===true?'#':'')+id);}}
return new _Api(context,a);});_api_registerPlural('rows().remove()','row().remove()',function(){var that=this;this.iterator('row',function(settings,row,thatIdx){var data=settings.aoData;var rowData=data[row];var i,ien,j,jen;var loopRow,loopCells;data.splice(row,1);for(i=0,ien=data.length;i<ien;i++){loopRow=data[i];loopCells=loopRow.anCells;if(loopRow.nTr!==null){loopRow.nTr._DT_RowIndex=i;}
if(loopCells!==null){for(j=0,jen=loopCells.length;j<jen;j++){loopCells[j]._DT_CellIndex.row=i;}}}
_fnDeleteIndex(settings.aiDisplayMaster,row);_fnDeleteIndex(settings.aiDisplay,row);_fnDeleteIndex(that[thatIdx],row,false);_fnLengthOverflow(settings);var id=settings.rowIdFn(rowData._aData);if(id!==undefined){delete settings.aIds[id];}});this.iterator('table',function(settings){for(var i=0,ien=settings.aoData.length;i<ien;i++){settings.aoData[i].idx=i;}});return this;});_api_register('rows.add()',function(rows){var newRows=this.iterator('table',function(settings){var row,i,ien;var out=[];for(i=0,ien=rows.length;i<ien;i++){row=rows[i];if(row.nodeName&&row.nodeName.toUpperCase()==='TR'){out.push(_fnAddTr(settings,row)[0]);}
else{out.push(_fnAddData(settings,row));}}
return out;},1);var modRows=this.rows(-1);modRows.pop();$.merge(modRows,newRows);return modRows;});_api_register('row()',function(selector,opts){return _selector_first(this.rows(selector,opts));});_api_register('row().data()',function(data){var ctx=this.context;if(data===undefined){return ctx.length&&this.length?ctx[0].aoData[this[0]]._aData:undefined;}
ctx[0].aoData[this[0]]._aData=data;_fnInvalidate(ctx[0],this[0],'data');return this;});_api_register('row().node()',function(){var ctx=this.context;return ctx.length&&this.length?ctx[0].aoData[this[0]].nTr||null:null;});_api_register('row.add()',function(row){if(row instanceof $&&row.length){row=row[0];}
var rows=this.iterator('table',function(settings){if(row.nodeName&&row.nodeName.toUpperCase()==='TR'){return _fnAddTr(settings,row)[0];}
return _fnAddData(settings,row);});return this.row(rows[0]);});var __details_add=function(ctx,row,data,klass)
{var rows=[];var addRow=function(r,k){if($.isArray(r)||r instanceof $){for(var i=0,ien=r.length;i<ien;i++){addRow(r[i],k);}
return;}
if(r.nodeName&&r.nodeName.toLowerCase()==='tr'){rows.push(r);}
else{var created=$('<tr><td/></tr>').addClass(k);$('td',created).addClass(k).html(r)
[0].colSpan=_fnVisbleColumns(ctx);rows.push(created[0]);}};addRow(data,klass);if(row._details){row._details.remove();}
row._details=$(rows);if(row._detailsShow){row._details.insertAfter(row.nTr);}};var __details_remove=function(api,idx)
{var ctx=api.context;if(ctx.length){var row=ctx[0].aoData[idx!==undefined?idx:api[0]];if(row&&row._details){row._details.remove();row._detailsShow=undefined;row._details=undefined;}}};var __details_display=function(api,show){var ctx=api.context;if(ctx.length&&api.length){var row=ctx[0].aoData[api[0]];if(row._details){row._detailsShow=show;if(show){row._details.insertAfter(row.nTr);}
else{row._details.detach();}
__details_events(ctx[0]);}}};var __details_events=function(settings)
{var api=new _Api(settings);var namespace='.dt.DT_details';var drawEvent='draw'+namespace;var colvisEvent='column-visibility'+namespace;var destroyEvent='destroy'+namespace;var data=settings.aoData;api.off(drawEvent+' '+colvisEvent+' '+destroyEvent);if(_pluck(data,'_details').length>0){api.on(drawEvent,function(e,ctx){if(settings!==ctx){return;}
api.rows({page:'current'}).eq(0).each(function(idx){var row=data[idx];if(row._detailsShow){row._details.insertAfter(row.nTr);}});});api.on(colvisEvent,function(e,ctx,idx,vis){if(settings!==ctx){return;}
var row,visible=_fnVisbleColumns(ctx);for(var i=0,ien=data.length;i<ien;i++){row=data[i];if(row._details){row._details.children('td[colspan]').attr('colspan',visible);}}});api.on(destroyEvent,function(e,ctx){if(settings!==ctx){return;}
for(var i=0,ien=data.length;i<ien;i++){if(data[i]._details){__details_remove(api,i);}}});}};var _emp='';var _child_obj=_emp+'row().child';var _child_mth=_child_obj+'()';_api_register(_child_mth,function(data,klass){var ctx=this.context;if(data===undefined){return ctx.length&&this.length?ctx[0].aoData[this[0]]._details:undefined;}
else if(data===true){this.child.show();}
else if(data===false){__details_remove(this);}
else if(ctx.length&&this.length){__details_add(ctx[0],ctx[0].aoData[this[0]],data,klass);}
return this;});_api_register([_child_obj+'.show()',_child_mth+'.show()'],function(show){__details_display(this,true);return this;});_api_register([_child_obj+'.hide()',_child_mth+'.hide()'],function(){__details_display(this,false);return this;});_api_register([_child_obj+'.remove()',_child_mth+'.remove()'],function(){__details_remove(this);return this;});_api_register(_child_obj+'.isShown()',function(){var ctx=this.context;if(ctx.length&&this.length){return ctx[0].aoData[this[0]]._detailsShow||false;}
return false;});var __re_column_selector=/^(.+):(name|visIdx|visible)$/;var __columnData=function(settings,column,r1,r2,rows){var a=[];for(var row=0,ien=rows.length;row<ien;row++){a.push(_fnGetCellData(settings,rows[row],column));}
return a;};var __column_selector=function(settings,selector,opts)
{var
columns=settings.aoColumns,names=_pluck(columns,'sName'),nodes=_pluck(columns,'nTh');var run=function(s){var selInt=_intVal(s);if(s===''){return _range(columns.length);}
if(selInt!==null){return[selInt>=0?selInt:columns.length+selInt];}
if(typeof s==='function'){var rows=_selector_row_indexes(settings,opts);return $.map(columns,function(col,idx){return s(idx,__columnData(settings,idx,0,0,rows),nodes[idx])?idx:null;});}
var match=typeof s==='string'?s.match(__re_column_selector):'';if(match){switch(match[2]){case'visIdx':case'visible':var idx=parseInt(match[1],10);if(idx<0){var visColumns=$.map(columns,function(col,i){return col.bVisible?i:null;});return[visColumns[visColumns.length+idx]];}
return[_fnVisibleToColumnIndex(settings,idx)];case'name':return $.map(names,function(name,i){return name===match[1]?i:null;});}}
else{return $(nodes).filter(s).map(function(){return $.inArray(this,nodes);}).toArray();}};return _selector_run('column',selector,run,settings,opts);};var __setColumnVis=function(settings,column,vis,recalc){var
cols=settings.aoColumns,col=cols[column],data=settings.aoData,row,cells,i,ien,tr;if(vis===undefined){return col.bVisible;}
if(col.bVisible===vis){return;}
if(vis){var insertBefore=$.inArray(true,_pluck(cols,'bVisible'),column+1);for(i=0,ien=data.length;i<ien;i++){tr=data[i].nTr;cells=data[i].anCells;if(tr){tr.insertBefore(cells[column],cells[insertBefore]||null);}}}
else{$(_pluck(settings.aoData,'anCells',column)).detach();}
col.bVisible=vis;_fnDrawHead(settings,settings.aoHeader);_fnDrawHead(settings,settings.aoFooter);if(recalc===undefined||recalc){_fnAdjustColumnSizing(settings);if(settings.oScroll.sX||settings.oScroll.sY){_fnScrollDraw(settings);}}
_fnCallbackFire(settings,null,'column-visibility',[settings,column,vis,recalc]);_fnSaveState(settings);};_api_register('columns()',function(selector,opts){if(selector===undefined){selector='';}
else if($.isPlainObject(selector)){opts=selector;selector='';}
opts=_selector_opts(opts);var inst=this.iterator('table',function(settings){return __column_selector(settings,selector,opts);},1);inst.selector.cols=selector;inst.selector.opts=opts;return inst;});_api_registerPlural('columns().header()','column().header()',function(selector,opts){return this.iterator('column',function(settings,column){return settings.aoColumns[column].nTh;},1);});_api_registerPlural('columns().footer()','column().footer()',function(selector,opts){return this.iterator('column',function(settings,column){return settings.aoColumns[column].nTf;},1);});_api_registerPlural('columns().data()','column().data()',function(){return this.iterator('column-rows',__columnData,1);});_api_registerPlural('columns().dataSrc()','column().dataSrc()',function(){return this.iterator('column',function(settings,column){return settings.aoColumns[column].mData;},1);});_api_registerPlural('columns().cache()','column().cache()',function(type){return this.iterator('column-rows',function(settings,column,i,j,rows){return _pluck_order(settings.aoData,rows,type==='search'?'_aFilterData':'_aSortData',column);},1);});_api_registerPlural('columns().nodes()','column().nodes()',function(){return this.iterator('column-rows',function(settings,column,i,j,rows){return _pluck_order(settings.aoData,rows,'anCells',column);},1);});_api_registerPlural('columns().visible()','column().visible()',function(vis,calc){return this.iterator('column',function(settings,column){if(vis===undefined){return settings.aoColumns[column].bVisible;}
__setColumnVis(settings,column,vis,calc);});});_api_registerPlural('columns().indexes()','column().index()',function(type){return this.iterator('column',function(settings,column){return type==='visible'?_fnColumnIndexToVisible(settings,column):column;},1);});_api_register('columns.adjust()',function(){return this.iterator('table',function(settings){_fnAdjustColumnSizing(settings);},1);});_api_register('column.index()',function(type,idx){if(this.context.length!==0){var ctx=this.context[0];if(type==='fromVisible'||type==='toData'){return _fnVisibleToColumnIndex(ctx,idx);}
else if(type==='fromData'||type==='toVisible'){return _fnColumnIndexToVisible(ctx,idx);}}});_api_register('column()',function(selector,opts){return _selector_first(this.columns(selector,opts));});var __cell_selector=function(settings,selector,opts)
{var data=settings.aoData;var rows=_selector_row_indexes(settings,opts);var cells=_removeEmpty(_pluck_order(data,rows,'anCells'));var allCells=$([].concat.apply([],cells));var row;var columns=settings.aoColumns.length;var a,i,ien,j,o,host;var run=function(s){var fnSelector=typeof s==='function';if(s===null||s===undefined||fnSelector){a=[];for(i=0,ien=rows.length;i<ien;i++){row=rows[i];for(j=0;j<columns;j++){o={row:row,column:j};if(fnSelector){host=data[row];if(s(o,_fnGetCellData(settings,row,j),host.anCells?host.anCells[j]:null)){a.push(o);}}
else{a.push(o);}}}
return a;}
if($.isPlainObject(s)){return[s];}
return allCells.filter(s).map(function(i,el){return{row:el._DT_CellIndex.row,column:el._DT_CellIndex.column};}).toArray();};return _selector_run('cell',selector,run,settings,opts);};_api_register('cells()',function(rowSelector,columnSelector,opts){if($.isPlainObject(rowSelector)){if(rowSelector.row===undefined){opts=rowSelector;rowSelector=null;}
else{opts=columnSelector;columnSelector=null;}}
if($.isPlainObject(columnSelector)){opts=columnSelector;columnSelector=null;}
if(columnSelector===null||columnSelector===undefined){return this.iterator('table',function(settings){return __cell_selector(settings,rowSelector,_selector_opts(opts));});}
var columns=this.columns(columnSelector,opts);var rows=this.rows(rowSelector,opts);var a,i,ien,j,jen;var cells=this.iterator('table',function(settings,idx){a=[];for(i=0,ien=rows[idx].length;i<ien;i++){for(j=0,jen=columns[idx].length;j<jen;j++){a.push({row:rows[idx][i],column:columns[idx][j]});}}
return a;},1);$.extend(cells.selector,{cols:columnSelector,rows:rowSelector,opts:opts});return cells;});_api_registerPlural('cells().nodes()','cell().node()',function(){return this.iterator('cell',function(settings,row,column){var cells=settings.aoData[row].anCells;return cells?cells[column]:undefined;},1);});_api_register('cells().data()',function(){return this.iterator('cell',function(settings,row,column){return _fnGetCellData(settings,row,column);},1);});_api_registerPlural('cells().cache()','cell().cache()',function(type){type=type==='search'?'_aFilterData':'_aSortData';return this.iterator('cell',function(settings,row,column){return settings.aoData[row][type][column];},1);});_api_registerPlural('cells().render()','cell().render()',function(type){return this.iterator('cell',function(settings,row,column){return _fnGetCellData(settings,row,column,type);},1);});_api_registerPlural('cells().indexes()','cell().index()',function(){return this.iterator('cell',function(settings,row,column){return{row:row,column:column,columnVisible:_fnColumnIndexToVisible(settings,column)};},1);});_api_registerPlural('cells().invalidate()','cell().invalidate()',function(src){return this.iterator('cell',function(settings,row,column){_fnInvalidate(settings,row,src,column);});});_api_register('cell()',function(rowSelector,columnSelector,opts){return _selector_first(this.cells(rowSelector,columnSelector,opts));});_api_register('cell().data()',function(data){var ctx=this.context;var cell=this[0];if(data===undefined){return ctx.length&&cell.length?_fnGetCellData(ctx[0],cell[0].row,cell[0].column):undefined;}
_fnSetCellData(ctx[0],cell[0].row,cell[0].column,data);_fnInvalidate(ctx[0],cell[0].row,'data',cell[0].column);return this;});_api_register('order()',function(order,dir){var ctx=this.context;if(order===undefined){return ctx.length!==0?ctx[0].aaSorting:undefined;}
if(typeof order==='number'){order=[[order,dir]];}
else if(!$.isArray(order[0])){order=Array.prototype.slice.call(arguments);}
return this.iterator('table',function(settings){settings.aaSorting=order.slice();});});_api_register('order.listener()',function(node,column,callback){return this.iterator('table',function(settings){_fnSortAttachListener(settings,node,column,callback);});});_api_register('order.fixed()',function(set){if(!set){var ctx=this.context;var fixed=ctx.length?ctx[0].aaSortingFixed:undefined;return $.isArray(fixed)?{pre:fixed}:fixed;}
return this.iterator('table',function(settings){settings.aaSortingFixed=$.extend(true,{},set);});});_api_register(['columns().order()','column().order()'],function(dir){var that=this;return this.iterator('table',function(settings,i){var sort=[];$.each(that[i],function(j,col){sort.push([col,dir]);});settings.aaSorting=sort;});});_api_register('search()',function(input,regex,smart,caseInsen){var ctx=this.context;if(input===undefined){return ctx.length!==0?ctx[0].oPreviousSearch.sSearch:undefined;}
return this.iterator('table',function(settings){if(!settings.oFeatures.bFilter){return;}
_fnFilterComplete(settings,$.extend({},settings.oPreviousSearch,{"sSearch":input+"","bRegex":regex===null?false:regex,"bSmart":smart===null?true:smart,"bCaseInsensitive":caseInsen===null?true:caseInsen}),1);});});_api_registerPlural('columns().search()','column().search()',function(input,regex,smart,caseInsen){return this.iterator('column',function(settings,column){var preSearch=settings.aoPreSearchCols;if(input===undefined){return preSearch[column].sSearch;}
if(!settings.oFeatures.bFilter){return;}
$.extend(preSearch[column],{"sSearch":input+"","bRegex":regex===null?false:regex,"bSmart":smart===null?true:smart,"bCaseInsensitive":caseInsen===null?true:caseInsen});_fnFilterComplete(settings,settings.oPreviousSearch,1);});});_api_register('state()',function(){return this.context.length?this.context[0].oSavedState:null;});_api_register('state.clear()',function(){return this.iterator('table',function(settings){settings.fnStateSaveCallback.call(settings.oInstance,settings,{});});});_api_register('state.loaded()',function(){return this.context.length?this.context[0].oLoadedState:null;});_api_register('state.save()',function(){return this.iterator('table',function(settings){_fnSaveState(settings);});});DataTable.versionCheck=DataTable.fnVersionCheck=function(version)
{var aThis=DataTable.version.split('.');var aThat=version.split('.');var iThis,iThat;for(var i=0,iLen=aThat.length;i<iLen;i++){iThis=parseInt(aThis[i],10)||0;iThat=parseInt(aThat[i],10)||0;if(iThis===iThat){continue;}
return iThis>iThat;}
return true;};DataTable.isDataTable=DataTable.fnIsDataTable=function(table)
{var t=$(table).get(0);var is=false;$.each(DataTable.settings,function(i,o){var head=o.nScrollHead?$('table',o.nScrollHead)[0]:null;var foot=o.nScrollFoot?$('table',o.nScrollFoot)[0]:null;if(o.nTable===t||head===t||foot===t){is=true;}});return is;};DataTable.tables=DataTable.fnTables=function(visible)
{var api=false;if($.isPlainObject(visible)){api=visible.api;visible=visible.visible;}
var a=$.map(DataTable.settings,function(o){if(!visible||(visible&&$(o.nTable).is(':visible'))){return o.nTable;}});return api?new _Api(a):a;};DataTable.util={throttle:_fnThrottle,escapeRegex:_fnEscapeRegex};DataTable.camelToHungarian=_fnCamelToHungarian;_api_register('$()',function(selector,opts){var
rows=this.rows(opts).nodes(),jqRows=$(rows);return $([].concat(jqRows.filter(selector).toArray(),jqRows.find(selector).toArray()));});$.each(['on','one','off'],function(i,key){_api_register(key+'()',function(){var args=Array.prototype.slice.call(arguments);if(!args[0].match(/\.dt\b/)){args[0]+='.dt';}
var inst=$(this.tables().nodes());inst[key].apply(inst,args);return this;});});_api_register('clear()',function(){return this.iterator('table',function(settings){_fnClearTable(settings);});});_api_register('settings()',function(){return new _Api(this.context,this.context);});_api_register('init()',function(){var ctx=this.context;return ctx.length?ctx[0].oInit:null;});_api_register('data()',function(){return this.iterator('table',function(settings){return _pluck(settings.aoData,'_aData');}).flatten();});_api_register('destroy()',function(remove){remove=remove||false;return this.iterator('table',function(settings){var orig=settings.nTableWrapper.parentNode;var classes=settings.oClasses;var table=settings.nTable;var tbody=settings.nTBody;var thead=settings.nTHead;var tfoot=settings.nTFoot;var jqTable=$(table);var jqTbody=$(tbody);var jqWrapper=$(settings.nTableWrapper);var rows=$.map(settings.aoData,function(r){return r.nTr;});var i,ien;settings.bDestroying=true;_fnCallbackFire(settings,"aoDestroyCallback","destroy",[settings]);if(!remove){new _Api(settings).columns().visible(true);}
jqWrapper.unbind('.DT').find(':not(tbody *)').unbind('.DT');$(window).unbind('.DT-'+settings.sInstance);if(table!=thead.parentNode){jqTable.children('thead').detach();jqTable.append(thead);}
if(tfoot&&table!=tfoot.parentNode){jqTable.children('tfoot').detach();jqTable.append(tfoot);}
settings.aaSorting=[];settings.aaSortingFixed=[];_fnSortingClasses(settings);$(rows).removeClass(settings.asStripeClasses.join(' '));$('th, td',thead).removeClass(classes.sSortable+' '+
classes.sSortableAsc+' '+classes.sSortableDesc+' '+classes.sSortableNone);if(settings.bJUI){$('th span.'+classes.sSortIcon+', td span.'+classes.sSortIcon,thead).detach();$('th, td',thead).each(function(){var wrapper=$('div.'+classes.sSortJUIWrapper,this);$(this).append(wrapper.contents());wrapper.detach();});}
jqTbody.children().detach();jqTbody.append(rows);var removedMethod=remove?'remove':'detach';jqTable[removedMethod]();jqWrapper[removedMethod]();if(!remove&&orig){orig.insertBefore(table,settings.nTableReinsertBefore);jqTable.css('width',settings.sDestroyWidth).removeClass(classes.sTable);ien=settings.asDestroyStripes.length;if(ien){jqTbody.children().each(function(i){$(this).addClass(settings.asDestroyStripes[i%ien]);});}}
var idx=$.inArray(settings,DataTable.settings);if(idx!==-1){DataTable.settings.splice(idx,1);}});});$.each(['column','row','cell'],function(i,type){_api_register(type+'s().every()',function(fn){var opts=this.selector.opts;var api=this;return this.iterator(type,function(settings,arg1,arg2,arg3,arg4){fn.call(api[type](arg1,type==='cell'?arg2:opts,type==='cell'?opts:undefined),arg1,arg2,arg3,arg4);});});});_api_register('i18n()',function(token,def,plural){var ctx=this.context[0];var resolved=_fnGetObjectDataFn(token)(ctx.oLanguage);if(resolved===undefined){resolved=def;}
if(plural!==undefined&&$.isPlainObject(resolved)){resolved=resolved[plural]!==undefined?resolved[plural]:resolved._;}
return resolved.replace('%d',plural);});DataTable.version="1.10.10";DataTable.settings=[];DataTable.models={};DataTable.models.oSearch={"bCaseInsensitive":true,"sSearch":"","bRegex":false,"bSmart":true};DataTable.models.oRow={"nTr":null,"anCells":null,"_aData":[],"_aSortData":null,"_aFilterData":null,"_sFilterRow":null,"_sRowStripe":"","src":null,"idx":-1};DataTable.models.oColumn={"idx":null,"aDataSort":null,"asSorting":null,"bSearchable":null,"bSortable":null,"bVisible":null,"_sManualType":null,"_bAttrSrc":false,"fnCreatedCell":null,"fnGetData":null,"fnSetData":null,"mData":null,"mRender":null,"nTh":null,"nTf":null,"sClass":null,"sContentPadding":null,"sDefaultContent":null,"sName":null,"sSortDataType":'std',"sSortingClass":null,"sSortingClassJUI":null,"sTitle":null,"sType":null,"sWidth":null,"sWidthOrig":null};DataTable.defaults={"aaData":null,"aaSorting":[[0,'asc']],"aaSortingFixed":[],"ajax":null,"aLengthMenu":[10,25,50,100],"aoColumns":null,"aoColumnDefs":null,"aoSearchCols":[],"asStripeClasses":null,"bAutoWidth":true,"bDeferRender":false,"bDestroy":false,"bFilter":true,"bInfo":true,"bJQueryUI":false,"bLengthChange":true,"bPaginate":true,"bProcessing":false,"bRetrieve":false,"bScrollCollapse":false,"bServerSide":false,"bSort":true,"bSortMulti":true,"bSortCellsTop":false,"bSortClasses":true,"bStateSave":false,"fnCreatedRow":null,"fnDrawCallback":null,"fnFooterCallback":null,"fnFormatNumber":function(toFormat){return toFormat.toString().replace(/\B(?=(\d{3})+(?!\d))/g,this.oLanguage.sThousands);},"fnHeaderCallback":null,"fnInfoCallback":null,"fnInitComplete":null,"fnPreDrawCallback":null,"fnRowCallback":null,"fnServerData":null,"fnServerParams":null,"fnStateLoadCallback":function(settings){try{return JSON.parse((settings.iStateDuration===-1?sessionStorage:localStorage).getItem('DataTables_'+settings.sInstance+'_'+location.pathname));}catch(e){}},"fnStateLoadParams":null,"fnStateLoaded":null,"fnStateSaveCallback":function(settings,data){try{(settings.iStateDuration===-1?sessionStorage:localStorage).setItem('DataTables_'+settings.sInstance+'_'+location.pathname,JSON.stringify(data));}catch(e){}},"fnStateSaveParams":null,"iStateDuration":7200,"iDeferLoading":null,"iDisplayLength":10,"iDisplayStart":0,"iTabIndex":0,"oClasses":{},"oLanguage":{"oAria":{"sSortAscending":": activate to sort column ascending","sSortDescending":": activate to sort column descending"},"oPaginate":{"sFirst":"First","sLast":"Last","sNext":"Next","sPrevious":"Previous"},"sEmptyTable":"No data available in table","sInfo":"Showing _START_ to _END_ of _TOTAL_ entries","sInfoEmpty":"Showing 0 to 0 of 0 entries","sInfoFiltered":"(filtered from _MAX_ total entries)","sInfoPostFix":"","sDecimal":"","sThousands":",","sLengthMenu":"Show _MENU_ entries","sLoadingRecords":"Loading...","sProcessing":"Processing...","sSearch":"Search:","sSearchPlaceholder":"","sUrl":"","sZeroRecords":"No matching records found"},"oSearch":$.extend({},DataTable.models.oSearch),"sAjaxDataProp":"data","sAjaxSource":null,"sDom":"lfrtip","searchDelay":null,"sPaginationType":"simple_numbers","sScrollX":"","sScrollXInner":"","sScrollY":"","sServerMethod":"GET","renderer":null,"rowId":"DT_RowId"};_fnHungarianMap(DataTable.defaults);DataTable.defaults.column={"aDataSort":null,"iDataSort":-1,"asSorting":['asc','desc'],"bSearchable":true,"bSortable":true,"bVisible":true,"fnCreatedCell":null,"mData":null,"mRender":null,"sCellType":"td","sClass":"","sContentPadding":"","sDefaultContent":null,"sName":"","sSortDataType":"std","sTitle":null,"sType":null,"sWidth":null};_fnHungarianMap(DataTable.defaults.column);DataTable.models.oSettings={"oFeatures":{"bAutoWidth":null,"bDeferRender":null,"bFilter":null,"bInfo":null,"bLengthChange":null,"bPaginate":null,"bProcessing":null,"bServerSide":null,"bSort":null,"bSortMulti":null,"bSortClasses":null,"bStateSave":null},"oScroll":{"bCollapse":null,"iBarWidth":0,"sX":null,"sXInner":null,"sY":null},"oLanguage":{"fnInfoCallback":null},"oBrowser":{"bScrollOversize":false,"bScrollbarLeft":false,"bBounding":false,"barWidth":0},"ajax":null,"aanFeatures":[],"aoData":[],"aiDisplay":[],"aiDisplayMaster":[],"aIds":{},"aoColumns":[],"aoHeader":[],"aoFooter":[],"oPreviousSearch":{},"aoPreSearchCols":[],"aaSorting":null,"aaSortingFixed":[],"asStripeClasses":null,"asDestroyStripes":[],"sDestroyWidth":0,"aoRowCallback":[],"aoHeaderCallback":[],"aoFooterCallback":[],"aoDrawCallback":[],"aoRowCreatedCallback":[],"aoPreDrawCallback":[],"aoInitComplete":[],"aoStateSaveParams":[],"aoStateLoadParams":[],"aoStateLoaded":[],"sTableId":"","nTable":null,"nTHead":null,"nTFoot":null,"nTBody":null,"nTableWrapper":null,"bDeferLoading":false,"bInitialised":false,"aoOpenRows":[],"sDom":null,"searchDelay":null,"sPaginationType":"two_button","iStateDuration":0,"aoStateSave":[],"aoStateLoad":[],"oSavedState":null,"oLoadedState":null,"sAjaxSource":null,"sAjaxDataProp":null,"bAjaxDataGet":true,"jqXHR":null,"json":undefined,"oAjaxData":undefined,"fnServerData":null,"aoServerParams":[],"sServerMethod":null,"fnFormatNumber":null,"aLengthMenu":null,"iDraw":0,"bDrawing":false,"iDrawError":-1,"_iDisplayLength":10,"_iDisplayStart":0,"_iRecordsTotal":0,"_iRecordsDisplay":0,"bJUI":null,"oClasses":{},"bFiltered":false,"bSorted":false,"bSortCellsTop":null,"oInit":null,"aoDestroyCallback":[],"fnRecordsTotal":function()
{return _fnDataSource(this)=='ssp'?this._iRecordsTotal*1:this.aiDisplayMaster.length;},"fnRecordsDisplay":function()
{return _fnDataSource(this)=='ssp'?this._iRecordsDisplay*1:this.aiDisplay.length;},"fnDisplayEnd":function()
{var
len=this._iDisplayLength,start=this._iDisplayStart,calc=start+len,records=this.aiDisplay.length,features=this.oFeatures,paginate=features.bPaginate;if(features.bServerSide){return paginate===false||len===-1?start+records:Math.min(start+len,this._iRecordsDisplay);}
else{return!paginate||calc>records||len===-1?records:calc;}},"oInstance":null,"sInstance":null,"iTabIndex":0,"nScrollHead":null,"nScrollFoot":null,"aLastSort":[],"oPlugins":{},"rowIdFn":null,"rowId":null};DataTable.ext=_ext={buttons:{},classes:{},builder:"-source-",errMode:"alert",feature:[],search:[],selector:{cell:[],column:[],row:[]},internal:{},legacy:{ajax:null},pager:{},renderer:{pageButton:{},header:{}},order:{},type:{detect:[],search:{},order:{}},_unique:0,fnVersionCheck:DataTable.fnVersionCheck,iApiIndex:0,oJUIClasses:{},sVersion:DataTable.version};$.extend(_ext,{afnFiltering:_ext.search,aTypes:_ext.type.detect,ofnSearch:_ext.type.search,oSort:_ext.type.order,afnSortData:_ext.order,aoFeatures:_ext.feature,oApi:_ext.internal,oStdClasses:_ext.classes,oPagination:_ext.pager});$.extend(DataTable.ext.classes,{"sTable":"dataTable","sNoFooter":"no-footer","sPageButton":"paginate_button","sPageButtonActive":"current","sPageButtonDisabled":"disabled","sStripeOdd":"odd","sStripeEven":"even","sRowEmpty":"dataTables_empty","sWrapper":"dataTables_wrapper","sFilter":"dataTables_filter","sInfo":"dataTables_info","sPaging":"dataTables_paginate paging_","sLength":"dataTables_length","sProcessing":"dataTables_processing","sSortAsc":"sorting_asc","sSortDesc":"sorting_desc","sSortable":"sorting","sSortableAsc":"sorting_asc_disabled","sSortableDesc":"sorting_desc_disabled","sSortableNone":"sorting_disabled","sSortColumn":"sorting_","sFilterInput":"","sLengthSelect":"","sScrollWrapper":"dataTables_scroll","sScrollHead":"dataTables_scrollHead","sScrollHeadInner":"dataTables_scrollHeadInner","sScrollBody":"dataTables_scrollBody","sScrollFoot":"dataTables_scrollFoot","sScrollFootInner":"dataTables_scrollFootInner","sHeaderTH":"","sFooterTH":"","sSortJUIAsc":"","sSortJUIDesc":"","sSortJUI":"","sSortJUIAscAllowed":"","sSortJUIDescAllowed":"","sSortJUIWrapper":"","sSortIcon":"","sJUIHeader":"","sJUIFooter":""});(function(){var _empty='';_empty='';var _stateDefault=_empty+'ui-state-default';var _sortIcon=_empty+'css_right ui-icon ui-icon-';var _headerFooter=_empty+'fg-toolbar ui-toolbar ui-widget-header ui-helper-clearfix';$.extend(DataTable.ext.oJUIClasses,DataTable.ext.classes,{"sPageButton":"fg-button ui-button "+_stateDefault,"sPageButtonActive":"ui-state-disabled","sPageButtonDisabled":"ui-state-disabled","sPaging":"dataTables_paginate fg-buttonset ui-buttonset fg-buttonset-multi "+"ui-buttonset-multi paging_","sSortAsc":_stateDefault+" sorting_asc","sSortDesc":_stateDefault+" sorting_desc","sSortable":_stateDefault+" sorting","sSortableAsc":_stateDefault+" sorting_asc_disabled","sSortableDesc":_stateDefault+" sorting_desc_disabled","sSortableNone":_stateDefault+" sorting_disabled","sSortJUIAsc":_sortIcon+"triangle-1-n","sSortJUIDesc":_sortIcon+"triangle-1-s","sSortJUI":_sortIcon+"carat-2-n-s","sSortJUIAscAllowed":_sortIcon+"carat-1-n","sSortJUIDescAllowed":_sortIcon+"carat-1-s","sSortJUIWrapper":"DataTables_sort_wrapper","sSortIcon":"DataTables_sort_icon","sScrollHead":"dataTables_scrollHead "+_stateDefault,"sScrollFoot":"dataTables_scrollFoot "+_stateDefault,"sHeaderTH":_stateDefault,"sFooterTH":_stateDefault,"sJUIHeader":_headerFooter+" ui-corner-tl ui-corner-tr","sJUIFooter":_headerFooter+" ui-corner-bl ui-corner-br"});}());var extPagination=DataTable.ext.pager;function _numbers(page,pages){var
numbers=[],buttons=extPagination.numbers_length,half=Math.floor(buttons/2),i=1;if(pages<=buttons){numbers=_range(0,pages);}
else if(page<=half){numbers=_range(0,buttons-2);numbers.push('ellipsis');numbers.push(pages-1);}
else if(page>=pages-1-half){numbers=_range(pages-(buttons-2),pages);numbers.splice(0,0,'ellipsis');numbers.splice(0,0,0);}
else{numbers=_range(page-half+2,page+half-1);numbers.push('ellipsis');numbers.push(pages-1);numbers.splice(0,0,'ellipsis');numbers.splice(0,0,0);}
numbers.DT_el='span';return numbers;}
$.extend(extPagination,{simple:function(page,pages){return['previous','next'];},full:function(page,pages){return['first','previous','next','last'];},numbers:function(page,pages){return[_numbers(page,pages)];},simple_numbers:function(page,pages){return['previous',_numbers(page,pages),'next'];},full_numbers:function(page,pages){return['first','previous',_numbers(page,pages),'next','last'];},_numbers:_numbers,numbers_length:7});$.extend(true,DataTable.ext.renderer,{pageButton:{_:function(settings,host,idx,buttons,page,pages){var classes=settings.oClasses;var lang=settings.oLanguage.oPaginate;var aria=settings.oLanguage.oAria.paginate||{};var btnDisplay,btnClass,counter=0;var attach=function(container,buttons){var i,ien,node,button;var clickHandler=function(e){_fnPageChange(settings,e.data.action,true);};for(i=0,ien=buttons.length;i<ien;i++){button=buttons[i];if($.isArray(button)){var inner=$('<'+(button.DT_el||'div')+'/>').appendTo(container);attach(inner,button);}
else{btnDisplay=null;btnClass='';switch(button){case'ellipsis':container.append('<span class="ellipsis">&#x2026;</span>');break;case'first':btnDisplay=lang.sFirst;btnClass=button+(page>0?'':' '+classes.sPageButtonDisabled);break;case'previous':btnDisplay=lang.sPrevious;btnClass=button+(page>0?'':' '+classes.sPageButtonDisabled);break;case'next':btnDisplay=lang.sNext;btnClass=button+(page<pages-1?'':' '+classes.sPageButtonDisabled);break;case'last':btnDisplay=lang.sLast;btnClass=button+(page<pages-1?'':' '+classes.sPageButtonDisabled);break;default:btnDisplay=button+1;btnClass=page===button?classes.sPageButtonActive:'';break;}
if(btnDisplay!==null){node=$('<a>',{'class':classes.sPageButton+' '+btnClass,'aria-controls':settings.sTableId,'aria-label':aria[button],'data-dt-idx':counter,'tabindex':settings.iTabIndex,'id':idx===0&&typeof button==='string'?settings.sTableId+'_'+button:null}).html(btnDisplay).appendTo(container);_fnBindAction(node,{action:button},clickHandler);counter++;}}}};var activeEl;try{activeEl=$(host).find(document.activeElement).data('dt-idx');}
catch(e){}
attach($(host).empty(),buttons);if(activeEl){$(host).find('[data-dt-idx='+activeEl+']').focus();}}}});$.extend(DataTable.ext.type.detect,[function(d,settings)
{var decimal=settings.oLanguage.sDecimal;return _isNumber(d,decimal)?'num'+decimal:null;},function(d,settings)
{if(d&&!(d instanceof Date)&&(!_re_date_start.test(d)||!_re_date_end.test(d))){return null;}
var parsed=Date.parse(d);return(parsed!==null&&!isNaN(parsed))||_empty(d)?'date':null;},function(d,settings)
{var decimal=settings.oLanguage.sDecimal;return _isNumber(d,decimal,true)?'num-fmt'+decimal:null;},function(d,settings)
{var decimal=settings.oLanguage.sDecimal;return _htmlNumeric(d,decimal)?'html-num'+decimal:null;},function(d,settings)
{var decimal=settings.oLanguage.sDecimal;return _htmlNumeric(d,decimal,true)?'html-num-fmt'+decimal:null;},function(d,settings)
{return _empty(d)||(typeof d==='string'&&d.indexOf('<')!==-1)?'html':null;}]);$.extend(DataTable.ext.type.search,{html:function(data){return _empty(data)?data:typeof data==='string'?data.replace(_re_new_lines," ").replace(_re_html,""):'';},string:function(data){return _empty(data)?data:typeof data==='string'?data.replace(_re_new_lines," "):data;}});var __numericReplace=function(d,decimalPlace,re1,re2){if(d!==0&&(!d||d==='-')){return-Infinity;}
if(decimalPlace){d=_numToDecimal(d,decimalPlace);}
if(d.replace){if(re1){d=d.replace(re1,'');}
if(re2){d=d.replace(re2,'');}}
return d*1;};function _addNumericSort(decimalPlace){$.each({"num":function(d){return __numericReplace(d,decimalPlace);},"num-fmt":function(d){return __numericReplace(d,decimalPlace,_re_formatted_numeric);},"html-num":function(d){return __numericReplace(d,decimalPlace,_re_html);},"html-num-fmt":function(d){return __numericReplace(d,decimalPlace,_re_html,_re_formatted_numeric);}},function(key,fn){_ext.type.order[key+decimalPlace+'-pre']=fn;if(key.match(/^html\-/)){_ext.type.search[key+decimalPlace]=_ext.type.search.html;}});}
$.extend(_ext.type.order,{"date-pre":function(d){return Date.parse(d)||0;},"html-pre":function(a){return _empty(a)?'':a.replace?a.replace(/<.*?>/g,"").toLowerCase():a+'';},"string-pre":function(a){return _empty(a)?'':typeof a==='string'?a.toLowerCase():!a.toString?'':a.toString();},"string-asc":function(x,y){return((x<y)?-1:((x>y)?1:0));},"string-desc":function(x,y){return((x<y)?1:((x>y)?-1:0));}});_addNumericSort('');$.extend(true,DataTable.ext.renderer,{header:{_:function(settings,cell,column,classes){$(settings.nTable).on('order.dt.DT',function(e,ctx,sorting,columns){if(settings!==ctx){return;}
var colIdx=column.idx;cell.removeClass(column.sSortingClass+' '+
classes.sSortAsc+' '+
classes.sSortDesc).addClass(columns[colIdx]=='asc'?classes.sSortAsc:columns[colIdx]=='desc'?classes.sSortDesc:column.sSortingClass);});},jqueryui:function(settings,cell,column,classes){$('<div/>').addClass(classes.sSortJUIWrapper).append(cell.contents()).append($('<span/>').addClass(classes.sSortIcon+' '+column.sSortingClassJUI)).appendTo(cell);$(settings.nTable).on('order.dt.DT',function(e,ctx,sorting,columns){if(settings!==ctx){return;}
var colIdx=column.idx;cell.removeClass(classes.sSortAsc+" "+classes.sSortDesc).addClass(columns[colIdx]=='asc'?classes.sSortAsc:columns[colIdx]=='desc'?classes.sSortDesc:column.sSortingClass);cell.find('span.'+classes.sSortIcon).removeClass(classes.sSortJUIAsc+" "+
classes.sSortJUIDesc+" "+
classes.sSortJUI+" "+
classes.sSortJUIAscAllowed+" "+
classes.sSortJUIDescAllowed).addClass(columns[colIdx]=='asc'?classes.sSortJUIAsc:columns[colIdx]=='desc'?classes.sSortJUIDesc:column.sSortingClassJUI);});}}});DataTable.render={number:function(thousands,decimal,precision,prefix,postfix){return{display:function(d){if(typeof d!=='number'&&typeof d!=='string'){return d;}
var negative=d<0?'-':'';var flo=parseFloat(d);if(isNaN(flo)){return d;}
d=Math.abs(flo);var intPart=parseInt(d,10);var floatPart=precision?decimal+(d-intPart).toFixed(precision).substring(2):'';return negative+(prefix||'')+
intPart.toString().replace(/\B(?=(\d{3})+(?!\d))/g,thousands)+
floatPart+
(postfix||'');}};},text:function(){return{display:function(d){return typeof d==='string'?d.replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;'):d;}};}};function _fnExternApiFunc(fn)
{return function(){var args=[_fnSettingsFromNode(this[DataTable.ext.iApiIndex])].concat(Array.prototype.slice.call(arguments));return DataTable.ext.internal[fn].apply(this,args);};}
$.extend(DataTable.ext.internal,{_fnExternApiFunc:_fnExternApiFunc,_fnBuildAjax:_fnBuildAjax,_fnAjaxUpdate:_fnAjaxUpdate,_fnAjaxParameters:_fnAjaxParameters,_fnAjaxUpdateDraw:_fnAjaxUpdateDraw,_fnAjaxDataSrc:_fnAjaxDataSrc,_fnAddColumn:_fnAddColumn,_fnColumnOptions:_fnColumnOptions,_fnAdjustColumnSizing:_fnAdjustColumnSizing,_fnVisibleToColumnIndex:_fnVisibleToColumnIndex,_fnColumnIndexToVisible:_fnColumnIndexToVisible,_fnVisbleColumns:_fnVisbleColumns,_fnGetColumns:_fnGetColumns,_fnColumnTypes:_fnColumnTypes,_fnApplyColumnDefs:_fnApplyColumnDefs,_fnHungarianMap:_fnHungarianMap,_fnCamelToHungarian:_fnCamelToHungarian,_fnLanguageCompat:_fnLanguageCompat,_fnBrowserDetect:_fnBrowserDetect,_fnAddData:_fnAddData,_fnAddTr:_fnAddTr,_fnNodeToDataIndex:_fnNodeToDataIndex,_fnNodeToColumnIndex:_fnNodeToColumnIndex,_fnGetCellData:_fnGetCellData,_fnSetCellData:_fnSetCellData,_fnSplitObjNotation:_fnSplitObjNotation,_fnGetObjectDataFn:_fnGetObjectDataFn,_fnSetObjectDataFn:_fnSetObjectDataFn,_fnGetDataMaster:_fnGetDataMaster,_fnClearTable:_fnClearTable,_fnDeleteIndex:_fnDeleteIndex,_fnInvalidate:_fnInvalidate,_fnGetRowElements:_fnGetRowElements,_fnCreateTr:_fnCreateTr,_fnBuildHead:_fnBuildHead,_fnDrawHead:_fnDrawHead,_fnDraw:_fnDraw,_fnReDraw:_fnReDraw,_fnAddOptionsHtml:_fnAddOptionsHtml,_fnDetectHeader:_fnDetectHeader,_fnGetUniqueThs:_fnGetUniqueThs,_fnFeatureHtmlFilter:_fnFeatureHtmlFilter,_fnFilterComplete:_fnFilterComplete,_fnFilterCustom:_fnFilterCustom,_fnFilterColumn:_fnFilterColumn,_fnFilter:_fnFilter,_fnFilterCreateSearch:_fnFilterCreateSearch,_fnEscapeRegex:_fnEscapeRegex,_fnFilterData:_fnFilterData,_fnFeatureHtmlInfo:_fnFeatureHtmlInfo,_fnUpdateInfo:_fnUpdateInfo,_fnInfoMacros:_fnInfoMacros,_fnInitialise:_fnInitialise,_fnInitComplete:_fnInitComplete,_fnLengthChange:_fnLengthChange,_fnFeatureHtmlLength:_fnFeatureHtmlLength,_fnFeatureHtmlPaginate:_fnFeatureHtmlPaginate,_fnPageChange:_fnPageChange,_fnFeatureHtmlProcessing:_fnFeatureHtmlProcessing,_fnProcessingDisplay:_fnProcessingDisplay,_fnFeatureHtmlTable:_fnFeatureHtmlTable,_fnScrollDraw:_fnScrollDraw,_fnApplyToChildren:_fnApplyToChildren,_fnCalculateColumnWidths:_fnCalculateColumnWidths,_fnThrottle:_fnThrottle,_fnConvertToWidth:_fnConvertToWidth,_fnGetWidestNode:_fnGetWidestNode,_fnGetMaxLenString:_fnGetMaxLenString,_fnStringToCss:_fnStringToCss,_fnSortFlatten:_fnSortFlatten,_fnSort:_fnSort,_fnSortAria:_fnSortAria,_fnSortListener:_fnSortListener,_fnSortAttachListener:_fnSortAttachListener,_fnSortingClasses:_fnSortingClasses,_fnSortData:_fnSortData,_fnSaveState:_fnSaveState,_fnLoadState:_fnLoadState,_fnSettingsFromNode:_fnSettingsFromNode,_fnLog:_fnLog,_fnMap:_fnMap,_fnBindAction:_fnBindAction,_fnCallbackReg:_fnCallbackReg,_fnCallbackFire:_fnCallbackFire,_fnLengthOverflow:_fnLengthOverflow,_fnRenderer:_fnRenderer,_fnDataSource:_fnDataSource,_fnRowAttributes:_fnRowAttributes,_fnCalculateEnd:function(){}});$.fn.dataTable=DataTable;DataTable.$=$;$.fn.dataTableSettings=DataTable.settings;$.fn.dataTableExt=DataTable.ext;$.fn.DataTable=function(opts){return $(this).dataTable(opts).api();};$.each(DataTable,function(prop,val){$.fn.DataTable[prop]=val;});return $.fn.dataTable;}));/*! DataTables Bootstrap 3 integration
 * 2011-2015 SpryMedia Ltd - datatables.net/license
 */(function(factory){if(typeof define==='function'&&define.amd){define('dataTablesBootstrap',['jquery','datatables.net'],function($){return factory($,window,document);});}
else if(typeof exports==='object'){module.exports=function(root,$){if(!root){root=window;}
if(!$||!$.fn.dataTable){$=require('datatables.net')(root,$).$;}
return factory($,root,root.document);};}
else{factory(jQuery,window,document);}}(function($,window,document,undefined){'use strict';var DataTable=$.fn.dataTable;$.extend(true,DataTable.defaults,{dom:"<'row'<'col-sm-6'l><'col-sm-6'f>>"+"<'row'<'col-sm-12'tr>>"+"<'row'<'col-sm-5'i><'col-sm-7'p>>",renderer:'bootstrap'});$.extend(DataTable.ext.classes,{sWrapper:"dataTables_wrapper form-inline dt-bootstrap",sFilterInput:"form-control input-sm",sLengthSelect:"form-control input-sm",sProcessing:"dataTables_processing panel panel-default"});DataTable.ext.renderer.pageButton.bootstrap=function(settings,host,idx,buttons,page,pages){var api=new DataTable.Api(settings);var classes=settings.oClasses;var lang=settings.oLanguage.oPaginate;var aria=settings.oLanguage.oAria.paginate||{};var btnDisplay,btnClass,counter=0;var attach=function(container,buttons){var i,ien,node,button;var clickHandler=function(e){e.preventDefault();if(!$(e.currentTarget).hasClass('disabled')&&api.page()!=e.data.action){api.page(e.data.action).draw('page');}};for(i=0,ien=buttons.length;i<ien;i++){button=buttons[i];if($.isArray(button)){attach(container,button);}
else{btnDisplay='';btnClass='';switch(button){case'ellipsis':btnDisplay='&#x2026;';btnClass='disabled';break;case'first':btnDisplay=lang.sFirst;btnClass=button+(page>0?'':' disabled');break;case'previous':btnDisplay=lang.sPrevious;btnClass=button+(page>0?'':' disabled');break;case'next':btnDisplay=lang.sNext;btnClass=button+(page<pages-1?'':' disabled');break;case'last':btnDisplay=lang.sLast;btnClass=button+(page<pages-1?'':' disabled');break;default:btnDisplay=button+1;btnClass=page===button?'active':'';break;}
if(btnDisplay){node=$('<li>',{'class':classes.sPageButton+' '+btnClass,'id':idx===0&&typeof button==='string'?settings.sTableId+'_'+button:null}).append($('<a>',{'href':'#','aria-controls':settings.sTableId,'aria-label':aria[button],'data-dt-idx':counter,'tabindex':settings.iTabIndex}).html(btnDisplay)).appendTo(container);settings.oApi._fnBindAction(node,{action:button},clickHandler);counter++;}}}};var activeEl;try{activeEl=$(host).find(document.activeElement).data('dt-idx');}
catch(e){}
attach($(host).empty().html('<ul class="pagination"/>').children('ul'),buttons);if(activeEl){$(host).find('[data-dt-idx='+activeEl+']').focus();}};if(DataTable.TableTools){$.extend(true,DataTable.TableTools.classes,{"container":"DTTT btn-group","buttons":{"normal":"btn btn-default","disabled":"disabled"},"collection":{"container":"DTTT_dropdown dropdown-menu","buttons":{"normal":"","disabled":"disabled"}},"print":{"info":"DTTT_print_info"},"select":{"row":"active"}});$.extend(true,DataTable.TableTools.DEFAULTS.oTags,{"collection":{"container":"ul","button":"li","liner":"a"}});}
return DataTable;}));define('views/course_list_view',['jquery','backbone','underscore','underscore.string','moment','text!templates/course_list.html','dataTablesBootstrap'],function($,Backbone,_,_s,moment,courseListViewTemplate){'use strict';return Backbone.View.extend({className:'course-list-view',template:_.template(courseListViewTemplate),initialize:function(){this.listenTo(this.collection,'update',this.refreshTableData);},getRowData:function(course){return{id:course.get('id'),type:course.get('type'),name:course.get('name'),last_edited:moment(course.get('last_edited')).format('MMMM DD, YYYY, h:mm A')};},renderCourseTable:function(){var filterPlaceholder=gettext('Search...'),$emptyLabel='<label class="sr">'+filterPlaceholder+'</label>';if(!$.fn.dataTable.isDataTable('#courseTable')){this.$el.find('#courseTable').DataTable({autoWidth:false,info:true,paging:true,oLanguage:{oPaginate:{sNext:gettext('Next'),sPrevious:gettext('Previous')},sInfo:gettext('Displaying _START_ to _END_ of _TOTAL_ courses'),sInfoFiltered:gettext('(filtered from _MAX_ total courses)'),sLengthMenu:gettext('Display _MENU_ courses'),sSearch:''},order:[[0,'asc']],columns:[{title:gettext('Course'),data:'name',fnCreatedCell:function(nTd,sData,oData){$(nTd).html(_s.sprintf('<a href="/courses/%s/" class="course-name">%s</a>'+'<div class="course-id">%s</div>',oData.id,oData.name,oData.id));}},{title:gettext('Course Type'),data:'type',fnCreatedCell:function(nTd,sData,oData){$(nTd).html(_s.capitalize(oData.type));}},{title:gettext('Last Edited'),data:'last_edited'},{data:'id',visible:false,searchable:true}]});this.$el.find('#courseTable_filter label').prepend($emptyLabel);this.$el.find('#courseTable_filter input').attr('placeholder',filterPlaceholder).addClass('field-input input-text').removeClass('form-control input-sm');}},render:function(){this.$el.html(this.template);this.renderCourseTable();this.refreshTableData();return this;},refreshTableData:function(){var data=this.collection.map(this.getRowData,this),$table=this.$el.find('#courseTable').DataTable();$table.clear().rows.add(data).draw();return this;}});});define('pages/page',['backbone','backbone.super','underscore','utils/utils'],function(Backbone,BackboneSuper,_,Utils){'use strict';var Page=Backbone.View.extend({title:null,initialize:function(){},remove:function(){if(this.view){this.view.remove();this.view=null;}
return this._super();},renderTitle:function(){var title=_.result(this,'title');if(title){document.title=title;}},renderNestedView:function(){this.view.render();this.$el.html(this.view.el);},render:function(){Utils.toogleMobileMenuClickEvent();this.renderTitle();this.renderNestedView();return this;},refresh:function(){this.view.remove();this.render();}});return Page;});define('pages/course_list_page',['collections/course_collection','views/course_list_view','pages/page'],function(CourseCollection,CourseListView,Page){'use strict';return Page.extend({title:gettext('Courses'),initialize:function(){this.collection=new CourseCollection();this.view=new CourseListView({collection:this.collection});this.render();this.collection.fetch({remove:false,data:{page_size:50}});}});});define('text!templates/course_detail.html',[],function(){return'<div class="container">\n    <ol class="breadcrumb">\n        <li><a href="/courses/"><%= gettext(\'Courses\') %></a></li>\n        <li class="active"><%= course[\'name\'] %></li>\n    </ol>\n    <div class="page-header">\n        <h1 class="hd-1 emphasized">\n            <span class="course-name"><%= course[\'name\'] %></span>\n\n            <div class="pull-right">\n                <a class="btn btn-primary btn-small" href="/courses/<%= course[\'id\'] %>/edit/">\n                    <%= gettext(\'Edit Course\') %>\n                </a>\n            </div>\n        </h1>\n    </div>\n\n    <div class="course-information">\n        <h3 class="hd-3 de-emphasized"><%= gettext(\'Course Information\') %></h3>\n\n        <div class="info-item">\n            <div class="heading"><%= gettext(\'Course ID\') %></div>\n            <div class="course-id"><%= course[\'id\'] %></div>\n        </div>\n        <div class="info-item">\n            <div class="heading"><%= gettext(\'Course Type\') %></div>\n            <div class="course-type"><%= courseType %></div>\n            <span class="help-block">\n                <%- gettext(\'NOTE: Courses formerly of type "Honor" now display as "Audit", but continue to function as before so long as they have an "Honor Seat" below\') %>\n            </span>\n        </div>\n\n        <% if(verificationDeadline) { %>\n        <div class="info-item">\n            <div class="heading"><%= gettext(\'Verification Deadline\') %></div>\n            <div class="course-verification-deadline"><%= verificationDeadline %></div>\n        </div>\n        <% } %>\n    </div>\n\n    <h3 class="hd-3 de-emphasized"><%= gettext(\'Course Seats\') %></h3>\n\n    <div class="course-seats"></div>\n</div>\n';});define('text!templates/_course_seat.html',[],function(){return'<div class="row course-seat">\n    <div class="col-sm-12">\n        <div class="seat-type"><%= seat.getSeatTypeDisplayName() %></div>\n    </div>\n    <div class="col-sm-4">\n        <div class="seat-price"><%= gettext(\'Price:\') + \' $\' + Number(seat.get(\'price\')).toLocaleString() %></div>\n        <% var expires = seat.get(\'expires\');\n        if(expires) {\n        print(gettext(\'Upgrade Deadline:\') + \' \' + moment.utc(expires).format(\'lll z\'));\n        }\n        %>\n    </div>\n    <div class="col-sm-4 seat-certificate-type">\n        <%= seat.getCertificateDisplayName() %>\n    </div>\n    <div class="col-sm-4 seat-additional-info"></div>\n</div>\n';});define('text!templates/_course_credit_seats.html',[],function(){return'<div class="row">\n    <div class="col-sm-12">\n        <div class="seat-type"><%= creditSeats[0].getSeatTypeDisplayName() %></div>\n    </div>\n\n    <div class="col-sm-4 col-sm-offset-4 seat-certificate-type">\n        <%= creditSeats[0].getCertificateDisplayName() %>\n    </div>\n\n    <div class="col-md-8">\n        <table class="table table-striped credit-seats">\n            <thead>\n                <tr>\n                    <th><%= gettext(\'Credit Provider\') %></th>\n                    <th><%= gettext(\'Price (USD)\') %></th>\n                    <th><%= gettext(\'Credit Hours\') %></th>\n                    <th><%= gettext(\'Upgrade Deadline\') %></th>\n                </tr>\n            </thead>\n            <tbody>\n                <% _.each(creditSeats, function (seat) { %>\n                    <tr class="course-seat">\n                        <td class="seat-credit-provider"><%= seat.get(\'credit_provider_display_name\') %></td>\n                        <td class="seat-price"><%= \'$\' +  Number(seat.get(\'price\')).toLocaleString() %></td>\n                        <td class="seat-credit-hours"><%= seat.get(\'credit_hours\') %></td>\n                        <td class="seat-expires"><% var expires = seat.get(\'expires\');\n                            if (expires) {\n                                print(moment.utc(expires).format(\'lll z\'));\n                            }\n                        %></td>\n                    </tr>\n                <% }); %>\n            </tbody>\n        </table>\n    </div>\n\n    <div class="col-sm-4 seat-additional-info"></div>\n</div>\n';});define('views/course_detail_view',['jquery','backbone','underscore','underscore.string','moment','text!templates/course_detail.html','text!templates/_course_seat.html','text!templates/_course_credit_seats.html','utils/course_utils','ecommerce'],function($,Backbone,_,_s,moment,CourseDetailTemplate,CourseSeatTemplate,CourseCreditSeatsTemplate,CourseUtils,ecommerce){'use strict';return Backbone.View.extend({className:'course-detail-view',initialize:function(){this.listenTo(this.model,'change',this.render);},render:function(){var html,verificationDeadline=this.model.get('verification_deadline'),templateData;templateData={course:this.model.attributes,courseType:_s.capitalize(this.model.get('type')),verificationDeadline:verificationDeadline?moment.utc(verificationDeadline).format('lll z'):null};html=_.template(CourseDetailTemplate)(templateData);this.$el.html(html);this.renderSeats();return this;},renderSeats:function(){var creditProvider,html='',seats=CourseUtils.orderSeatsForDisplay(this.model.seats()),$seatHolder=$('.course-seats',this.$el);seats=CourseUtils.filterSeats(seats,'credit');_.each(seats.residual,function(seat){html+=_.template(CourseSeatTemplate)({seat:seat,moment:moment});});if(seats.filtered&&seats.filtered.length>0){_.each(seats.filtered,function(seat){creditProvider=ecommerce.credit.providers.get(seat.get('credit_provider'));if(creditProvider){seat.set('credit_provider_display_name',creditProvider.get('display_name'));}});html+=_.template(CourseCreditSeatsTemplate)({creditSeats:seats.filtered,moment:moment});}
$seatHolder.html(html);}});});define('pages/course_detail_page',['models/course_model','views/course_detail_view','pages/page'],function(Course,CourseDetailView,Page){'use strict';return Page.extend({title:function(){return this.model.get('name')+' - '+gettext('View Course');},initialize:function(options){this.model=Course.findOrCreate({id:options.id});this.view=new CourseDetailView({model:this.model});this.listenTo(this.model,'change sync',this.render);this.model.fetch({data:{include_products:true}});}});});(function(factory){if(typeof define==='function'&&define.amd)
define('backbone.stickit',['underscore','backbone','exports'],factory);else if(typeof exports==='object')
factory(require('underscore'),require('backbone'),exports);else
factory(_,Backbone,{});}(function(_,Backbone,Stickit){Backbone.Stickit=Stickit;Stickit._handlers=[];Stickit.addHandler=function(handlers){handlers=_.map(_.flatten([handlers]),function(handler){return _.defaults({},handler,{updateModel:true,updateView:true,updateMethod:'text'});});this._handlers=this._handlers.concat(handlers);};Stickit.ViewMixin={_modelBindings:null,unstickit:function(model,bindingSelector){if(_.isObject(bindingSelector)){_.each(bindingSelector,function(v,selector){this.unstickit(model,selector);},this);return;}
var models=[],destroyFns=[];this._modelBindings=_.reject(this._modelBindings,function(binding){if(model&&binding.model!==model)return;if(bindingSelector&&binding.config.selector!=bindingSelector)return;binding.model.off(binding.event,binding.fn);destroyFns.push(binding.config._destroy);models.push(binding.model);return true;});_.invoke(_.uniq(models),'trigger','stickit:unstuck',this.cid);_.each(_.uniq(destroyFns),function(fn){fn.call(this);},this);this.$el.off('.stickit'+(model?'.'+model.cid:''),bindingSelector);},stickit:function(optionalModel,optionalBindingsConfig){var model=optionalModel||this.model,bindings=optionalBindingsConfig||_.result(this,"bindings")||{};this._modelBindings||(this._modelBindings=[]);this.addBinding(model,bindings);var remove=this.remove;if(!remove.stickitWrapped){this.remove=function(){var ret=this;this.unstickit();if(remove)ret=remove.apply(this,arguments);return ret;};}
this.remove.stickitWrapped=true;return this;},addBinding:function(optionalModel,selector,binding){var model=optionalModel||this.model,namespace='.stickit.'+model.cid;binding=binding||{};if(_.isObject(selector)){var bindings=selector;_.each(bindings,function(val,key){this.addBinding(model,key,val);},this);return;}
var $el=selector===':el'?this.$el:this.$(selector);this.unstickit(model,selector);if(!$el.length)return;if(_.isString(binding))binding={observe:binding};if(_.isFunction(binding.observe))binding.observe=binding.observe.call(this);var config=getConfiguration($el,binding);var modelAttr=config.observe;config.selector=selector;config.view=this;var bindId=config.bindId=_.uniqueId();var options=_.extend({stickitChange:config},config.setOptions);config._destroy=function(){applyViewFn.call(this,config.destroy,$el,model,config);};initializeAttributes($el,config,model,modelAttr);initializeVisible($el,config,model,modelAttr);initializeClasses($el,config,model,modelAttr);if(modelAttr){_.each(config.events,function(type){var eventName=type+namespace;var listener=function(event){var val=applyViewFn.call(this,config.getVal,$el,event,config,slice.call(arguments,1));var currentVal=evaluateBoolean(config.updateModel,val,event,config);if(currentVal)setAttr(model,modelAttr,val,options,config);};var sel=selector===':el'?'':selector;this.$el.on(eventName,sel,_.bind(listener,this));},this);_.each(_.flatten([modelAttr]),function(attr){observeModelEvent(model,'change:'+attr,config,function(m,val,options){var changeId=options&&options.stickitChange&&options.stickitChange.bindId;if(changeId!==bindId){var currentVal=getAttr(model,modelAttr,config);updateViewBindEl($el,config,currentVal,model);}});});var currentVal=getAttr(model,modelAttr,config);updateViewBindEl($el,config,currentVal,model,true);}
applyViewFn.call(this,config.initialize,$el,model,config);}};_.extend(Backbone.View.prototype,Stickit.ViewMixin);var slice=[].slice;var evaluatePath=function(obj,path){var parts=(path||'').split('.');var result=_.reduce(parts,function(memo,i){return memo[i];},obj);return result==null?obj:result;};var applyViewFn=function(fn){fn=_.isString(fn)?evaluatePath(this,fn):fn;if(fn)return(fn).apply(this,slice.call(arguments,1));};var evaluateBoolean=function(reference,val,config){if(_.isBoolean(reference)){return reference;}else if(_.isFunction(reference)||_.isString(reference)){var view=_.last(arguments).view;return applyViewFn.apply(view,arguments);}
return false;};var observeModelEvent=function(model,event,config,fn){var view=config.view;model.on(event,fn,view);view._modelBindings.push({model:model,event:event,fn:fn,config:config});};var setAttr=function(model,attr,val,options,config){var value={},view=config.view;if(config.onSet){val=applyViewFn.call(view,config.onSet,val,config);}
if(config.set){applyViewFn.call(view,config.set,attr,val,options,config);}else{value[attr]=val;if(_.isArray(attr)&&_.isArray(val)){value=_.reduce(attr,function(memo,attribute,index){memo[attribute]=_.has(val,index)?val[index]:null;return memo;},{});}
model.set(value,options);}};var getAttr=function(model,attr,config){var view=config.view;var retrieveVal=function(field){return model[config.escape?'escape':'get'](field);};var sanitizeVal=function(val){return val==null?'':val;};var val=_.isArray(attr)?_.map(attr,retrieveVal):retrieveVal(attr);if(config.onGet)val=applyViewFn.call(view,config.onGet,val,config);return _.isArray(val)?_.map(val,sanitizeVal):sanitizeVal(val);};var getConfiguration=Stickit.getConfiguration=function($el,binding){var handlers=[{updateModel:false,updateMethod:'text',update:function($el,val,m,opts){if($el[opts.updateMethod])$el[opts.updateMethod](val);},getVal:function($el,e,opts){return $el[opts.updateMethod]();}}];handlers=handlers.concat(_.filter(Stickit._handlers,function(handler){return $el.is(handler.selector);}));handlers.push(binding);var config=_.extend.apply(_,handlers);if(!_.has(config,'updateView'))config.updateView=!config.visible;return config;};var initializeAttributes=function($el,config,model,modelAttr){var props=['autofocus','autoplay','async','checked','controls','defer','disabled','hidden','indeterminate','loop','multiple','open','readonly','required','scoped','selected'];var view=config.view;_.each(config.attributes||[],function(attrConfig){attrConfig=_.clone(attrConfig);attrConfig.view=view;var lastClass='';var observed=attrConfig.observe||(attrConfig.observe=modelAttr);var updateAttr=function(){var updateType=_.contains(props,attrConfig.name)?'prop':'attr',val=getAttr(model,observed,attrConfig);if(attrConfig.name==='class'){$el.removeClass(lastClass).addClass(val);lastClass=val;}else{$el[updateType](attrConfig.name,val);}};_.each(_.flatten([observed]),function(attr){observeModelEvent(model,'change:'+attr,config,updateAttr);});updateAttr();});};var initializeClasses=function($el,config,model,modelAttr){_.each(config.classes||[],function(classConfig,name){if(_.isString(classConfig))classConfig={observe:classConfig};classConfig.view=config.view;var observed=classConfig.observe;var updateClass=function(){var val=getAttr(model,observed,classConfig);$el.toggleClass(name,!!val);};_.each(_.flatten([observed]),function(attr){observeModelEvent(model,'change:'+attr,config,updateClass);});updateClass();});};var initializeVisible=function($el,config,model,modelAttr){if(config.visible==null)return;var view=config.view;var visibleCb=function(){var visible=config.visible,visibleFn=config.visibleFn,val=getAttr(model,modelAttr,config),isVisible=!!val;if(_.isFunction(visible)||_.isString(visible)){isVisible=!!applyViewFn.call(view,visible,val,config);}
if(visibleFn){applyViewFn.call(view,visibleFn,$el,isVisible,config);}else{$el.toggle(isVisible);}};_.each(_.flatten([modelAttr]),function(attr){observeModelEvent(model,'change:'+attr,config,visibleCb);});visibleCb();};var updateViewBindEl=function($el,config,val,model,isInitializing){var view=config.view;if(!evaluateBoolean(config.updateView,val,config))return;applyViewFn.call(view,config.update,$el,val,model,config);if(!isInitializing)applyViewFn.call(view,config.afterUpdate,$el,val,config);};Stickit.addHandler([{selector:'[contenteditable]',updateMethod:'html',events:['input','change']},{selector:'input',events:['propertychange','input','change'],update:function($el,val){$el.val(val);},getVal:function($el){return $el.val();}},{selector:'textarea',events:['propertychange','input','change'],update:function($el,val){$el.val(val);},getVal:function($el){return $el.val();}},{selector:'input[type="radio"]',events:['change'],update:function($el,val){$el.filter('[value="'+val+'"]').prop('checked',true);},getVal:function($el){return $el.filter(':checked').val();}},{selector:'input[type="checkbox"]',events:['change'],update:function($el,val,model,options){if($el.length>1){val||(val=[]);$el.each(function(i,el){var checkbox=Backbone.$(el);var checked=_.contains(val,checkbox.val());checkbox.prop('checked',checked);});}else{var checked=_.isBoolean(val)?val:val===$el.val();$el.prop('checked',checked);}},getVal:function($el){var val;if($el.length>1){val=_.reduce($el,function(memo,el){var checkbox=Backbone.$(el);if(checkbox.prop('checked'))memo.push(checkbox.val());return memo;},[]);}else{val=$el.prop('checked');var boxval=$el.val();if(boxval!=='on'&&boxval!=null){val=val?$el.val():null;}}
return val;}},{selector:'select',events:['change'],update:function($el,val,model,options){var optList,selectConfig=options.selectOptions,list=selectConfig&&selectConfig.collection||undefined,isMultiple=$el.prop('multiple');if(!selectConfig){selectConfig={};var getList=function($el){return $el.map(function(index,option){var dataVal=Backbone.$(option).data('stickit-bind-val');return{value:dataVal!==undefined?dataVal:option.value,label:option.text};}).get();};if($el.find('optgroup').length){list={opt_labels:[]};if($el.find('> option').length){list.opt_labels.push(undefined);_.each($el.find('> option'),function(el){list[undefined]=getList(Backbone.$(el));});}
_.each($el.find('optgroup'),function(el){var label=Backbone.$(el).attr('label');list.opt_labels.push(label);list[label]=getList(Backbone.$(el).find('option'));});}else{list=getList($el.find('option'));}}
selectConfig.valuePath=selectConfig.valuePath||'value';selectConfig.labelPath=selectConfig.labelPath||'label';selectConfig.disabledPath=selectConfig.disabledPath||'disabled';var addSelectOptions=function(optList,$el,fieldVal){_.each(optList,function(obj){var option=Backbone.$('<option/>'),optionVal=obj;var fillOption=function(text,val,disabled){option.text(text);optionVal=val;option.data('stickit-bind-val',optionVal);if(!_.isArray(optionVal)&&!_.isObject(optionVal))option.val(optionVal);if(disabled===true)option.prop('disabled','disabled');};var text,val,disabled;if(obj==='__default__'){text=fieldVal.label,val=fieldVal.value,disabled=fieldVal.disabled;}else{text=evaluatePath(obj,selectConfig.labelPath),val=evaluatePath(obj,selectConfig.valuePath),disabled=evaluatePath(obj,selectConfig.disabledPath);}
fillOption(text,val,disabled);var isSelected=function(){if(!isMultiple&&optionVal!=null&&fieldVal!=null&&optionVal===fieldVal){return true;}else if(_.isObject(fieldVal)&&_.isEqual(optionVal,fieldVal)){return true;}
return false;};if(isSelected()){option.prop('selected',true);}else if(isMultiple&&_.isArray(fieldVal)){_.each(fieldVal,function(val){if(_.isObject(val))val=evaluatePath(val,selectConfig.valuePath);if(val===optionVal||(_.isObject(val)&&_.isEqual(optionVal,val)))
option.prop('selected',true);});}
$el.append(option);});};$el.find('*').remove();if(_.isString(list)){var context=window;if(list.indexOf('this.')===0)context=this;list=list.replace(/^[a-z]*\.(.+)$/,'$1');optList=evaluatePath(context,list);}else if(_.isFunction(list)){optList=applyViewFn.call(this,list,$el,options);}else{optList=list;}
if(optList instanceof Backbone.Collection){var collection=optList;var refreshSelectOptions=function(){var currentVal=getAttr(model,options.observe,options);applyViewFn.call(this,options.update,$el,currentVal,model,options);};var removeCollectionListeners=function(){collection.off('add remove reset sort',refreshSelectOptions);};var removeAllListeners=function(){removeCollectionListeners();collection.off('stickit:selectRefresh');model.off('stickit:selectRefresh');};collection.trigger('stickit:selectRefresh');collection.once('stickit:selectRefresh',removeCollectionListeners,this);collection.on('add remove reset sort',refreshSelectOptions,this);model.trigger('stickit:selectRefresh');model.once('stickit:selectRefresh',function(){model.off('stickit:unstuck',removeAllListeners);});model.once('stickit:unstuck',removeAllListeners,this);optList=optList.toJSON();}
if(selectConfig.defaultOption){var option=_.isFunction(selectConfig.defaultOption)?selectConfig.defaultOption.call(this,$el,options):selectConfig.defaultOption;addSelectOptions(["__default__"],$el,option);}
if(_.isArray(optList)){addSelectOptions(optList,$el,val);}else if(optList.opt_labels){_.each(optList.opt_labels,function(label){var $group=Backbone.$('<optgroup/>').attr('label',label);addSelectOptions(optList[label],$group,val);$el.append($group);});}else{var opts=[],opt;for(var i in optList){opt={};opt[selectConfig.valuePath]=i;opt[selectConfig.labelPath]=optList[i];opts.push(opt);}
opts=_.sortBy(opts,selectConfig.comparator||selectConfig.labelPath);addSelectOptions(opts,$el,val);}},getVal:function($el){var selected=$el.find('option:selected');if($el.prop('multiple')){return _.map(selected,function(el){return Backbone.$(el).data('stickit-bind-val');});}else{return selected.data('stickit-bind-val');}}}]);return Stickit;}));define('text!templates/_alert_div.html',[],function(){return'<div class="alerts" tabindex="-1" aria-live="polite"></div>\n';});define('text!templates/course_form.html',[],function(){return'<div class="fields">\n    <div class="form-group">\n        <label class="hd-4" for="id"><%= gettext(\'Course ID\') %></label>\n        <% if(editing){ %>\n        <input type="hidden" name="id" value="<%= id %>">\n\n        <div class="course-id"><%= id %></div>\n        <% } else { %>\n        <input type="text" class="form-control" name="id" placeholder="e.g. course-v1:edX+DemoX+Demo_Course">\n\n        <p class="help-block"></p>\n        <% } %>\n    </div>\n\n    <!-- TODO: Hide this field and get the data from an API. -->\n    <div class="form-group">\n        <label class="hd-4" for="name"><%= gettext(\'Course Name\') %></label>\n        <input type="text" class="form-control" name="name" placeholder="e.g. edX Demonstration Course">\n\n        <p class="help-block"></p>\n    </div>\n\n    <div class="form-group">\n        <label class="hd-4" for="courseType"><%= gettext(\'Course Type\') %></label>\n\n        <p class="help-block"></p>\n        <!-- Radio fields will be appended here. -->\n        <div class="course-types"></div>\n    </div>\n</div>\n\n<div class="form-group course-seats">\n    <label class="hd-4"><%= gettext(\'Course Seats\') %></label>\n\n    <div class="course-seat empty"><em><%= gettext(\'Select a course type.\') %></em></div>\n</div>\n\n<div class="fields">\n    <div class="form-group verification-deadline hidden">\n        <label class="hd-4" for="verificationDeadline"><%= gettext(\'Verification Deadline\') %></label>\n\n        <div class="input-group">\n            <div class="input-group-addon"><i class="fa fa-calendar" aria-hidden="true"></i></div>\n            <input id="verificationDeadline" name="verification_deadline" class="form-control add-pikaday"\n                   aria-describedby="verificationDeadlineHelpBlock">\n        </div>\n        <!-- NOTE: This help-block is here for validation messages. -->\n        <span class="help-block"></span>\n        <span id="verificationDeadlineHelpBlock" class="help-block">\n            <%= gettext(\'After this date/time, students can no longer submit photos for ID verification.\') %>\n        </span>\n        <span class="help-block">\n            <em>(<%- gettext(\'Change the verification deadline for this course. The default deadline is the course end date and time.\') %>)</em>\n        </span>\n    </div>\n</div>\n\n<div class="fields">\n    <div class="form-group honor-mode hidden">\n        <label class="hd-4" for="honorMode"><%- gettext(\'Include Honor Seat\') %></label>\n\n        <div class="input-group">\n            <label class="radio-inline">\n                <input type="radio" name="honor_mode" value="true" aria-describedby="honorModeHelpBlock"> Yes\n            </label>\n            <label class="radio-inline">\n                <input type="radio" name="honor_mode" value="false" aria-describedby="honorModeHelpBlock"> No\n            </label>\n            <!-- NOTE: This help-block is here for validation messages. -->\n            <span class="help-block"></span>\n            <span id="honorModeHelpBlock" class="help-block">\n                <%- gettext(\'Include an Honor Seat with this course\') %>\n            </span>\n        </div>\n    </div>\n</div>\n\n<div class="form-actions">\n    <button type="submit" class="btn btn-primary"><%= gettext(editing ? \'Save Changes\' : \'Create Course\') %></button>\n    <a class="btn btn-default" href="/courses/<% if(id){ print(id + \'/\'); } %>"><%= gettext(\'Cancel\') %></a>\n</div>\n';});define('text!templates/_course_type_radio_field.html',[],function(){return'<div class="radio <% if(disabled) { %> disabled <% } %>" <% if(disabled) { %>aria-disabled="true" <% } %> >\n    <label>\n        <input type="radio" name="type" id="courseType<%= type %>" value="<%= type %>"\n               aria-describedby="courseType<%= type %>HelpBlock"\n               <% if(disabled) { print(\'disabled="disabled"\'); } %>\n               <% if(checked) { print(\'checked\'); } %>>\n        <div class="course-type-display-name"><%= displayName %></div>\n        <span id="courseType<%= type %>HelpBlock" class="help-block">\n            <%= helpText %>\n        </span>\n    </label>\n</div>\n';});define('views/course_seat_form_fields/course_seat_form_field_view',['jquery','backbone','backbone.validation','backbone.stickit','underscore','underscore.string','utils/utils'],function($,Backbone,BackboneValidation,BackboneStickit,_,_s,Utils){'use strict';return Backbone.View.extend({idVerificationRequired:false,seatType:null,template:null,bindings:{'input[name=certificate_type]':'certificate_type','input[name=price]':{observe:'price',setOptions:{validate:true}},'input[name=expires]':{observe:'expires',setOptions:{validate:true}},'input[name=id_verification_required]':{observe:'id_verification_required',onSet:'cleanIdVerificationRequired'}},className:function(){return'row '+this.seatType+' course-seat';},initialize:function(){Utils.bindValidation(this);},render:function(){this.$el.html(this.template(this.model.attributes));this.stickit();return this;},cleanIdVerificationRequired:function(val){return _s.toBoolean(val);}});});define('text!templates/audit_course_seat_form_field.html',[],function(){return'<div class="col-sm-12">\n    <div class="seat-type"><%= gettext(\'Audit\') %></div>\n</div>\n<div class="col-sm-4">\n    <span class="price-label"><%= gettext(\'Price (in USD)\') %>:</span> <span class="seat-price">$0.00</span>\n    <input type="hidden" name="price" value="0">\n    <input type="hidden" name="certificate_type">\n    <input type="hidden" name="id_verification_required" value="false">\n</div>\n<div class="col-sm-4 seat-certificate-type">\n    (<%= gettext(\'No Certificate\') %>)\n</div>\n<div class="col-sm-4 seat-additional-info"></div>\n';});define('views/course_seat_form_fields/audit_course_seat_form_field_view',['underscore','views/course_seat_form_fields/course_seat_form_field_view','text!templates/audit_course_seat_form_field.html'],function(_,CourseSeatFormFieldView,FieldTemplate){'use strict';return CourseSeatFormFieldView.extend({certificateType:null,idVerificationRequired:false,seatType:'audit',template:_.template(FieldTemplate)});});define('text!templates/verified_course_seat_form_field.html',[],function(){return'<div class="col-sm-12">\n    <div class="seat-type"><%= gettext(\'Verified\') %></div>\n</div>\n<div class="col-sm-4">\n    <input type="hidden" name="certificate_type" value="verified">\n    <input type="hidden" name="id_verification_required" value="true">\n\n    <div class="seat-price">\n        <div class="form-group">\n            <label for="price"><%= gettext(\'Price (in USD)\') %></label>\n\n            <div class="input-group">\n                <div class="input-group-addon">$</div>\n                <input type="number" class="form-control" name="price" id="price" min="5" step="1" pattern="\\d+"\n                       value="<%= price %>">\n            </div>\n            <!-- NOTE: This help-block is here for validation messages. -->\n            <span class="help-block"></span>\n        </div>\n    </div>\n\n    <div class="expires">\n        <div class="form-group">\n            <label for="expires"><%= gettext(\'Upgrade Deadline\') %></label>\n\n            <div class="input-group">\n                <div class="input-group-addon"><i class="fa fa-calendar" aria-hidden="true"></i></div>\n                <input id="expires" name="expires" class="form-control add-pikaday"\n                       aria-describedby="expiresHelpBlock">\n            </div>\n            <!-- NOTE: This help-block is here for validation messages. -->\n            <span class="help-block"></span>\n        <span id="expiresHelpBlock" class="help-block">\n            <%= gettext(\'After this date/time, students can no longer enroll in this track.\') %>\n        </span>\n        </div>\n    </div>\n</div>\n<div class="col-sm-4 seat-certificate-type">\n    <%= gettext(\'Verified Certificate\') %>\n</div>\n<div class="col-sm-4 seat-additional-info"></div>\n';});define('views/course_seat_form_fields/verified_course_seat_form_field_view',['underscore','views/course_seat_form_fields/course_seat_form_field_view','text!templates/verified_course_seat_form_field.html'],function(_,CourseSeatFormFieldView,FieldTemplate){'use strict';return CourseSeatFormFieldView.extend({certificateType:'verified',idVerificationRequired:true,seatType:'verified',template:_.template(FieldTemplate)});});define('text!templates/professional_course_seat_form_field.html',[],function(){return'<div class="col-sm-12">\n    <div class="seat-type"><%= gettext(\'Professional Education\') %></div>\n</div>\n<div class="col-sm-4">\n    <input type="hidden" name="certificate_type" value="professional">\n\n    <div class="seat-price">\n        <div class="form-group">\n            <label for="price"><%= gettext(\'Price (in USD)\') %></label>\n\n            <div class="input-group">\n                <div class="input-group-addon">$</div>\n                <input type="number" class="form-control" name="price" id="price" min="5" step="1" pattern="\\d+"\n                       value="<%= price %>">\n            </div>\n            <!-- NOTE: This help-block is here for validation messages. -->\n            <span class="help-block"></span>\n        </div>\n    </div>\n\n    <div class="expires">\n        <div class="form-group">\n            <label for="expires"><%= gettext(\'Upgrade Deadline\') %></label>\n\n            <div class="input-group" data-toggle="tooltip"\n                 title="<%= gettext(\'Professional education courses have no upgrade deadline.\') %>">\n                <div class="input-group-addon"><i class="fa fa-calendar" aria-hidden="true"></i></div>\n                <input id="expires" name="expires" class="form-control add-pikaday"\n                       aria-describedby="expiresHelpBlock" disabled="disabled">\n            </div>\n            <!-- NOTE: This help-block is here for validation messages. -->\n            <span class="help-block"></span>\n        <span id="expiresHelpBlock" class="help-block">\n            <%= gettext(\'After this date/time, students can no longer enroll in this track.\') %>\n        </span>\n        <span class="help-block">\n            <%- gettext(\'Change the upgrade deadline for this course. The default deadline is 10 days before the course end date and time.\') %>\n        </span>\n        </div>\n    </div>\n</div>\n<div class="col-sm-4 seat-certificate-type">\n    <%= gettext(\'Professional Education Certificate\') %>\n</div>\n<div class="col-sm-4 seat-additional-info">\n    <div class="form-group">\n        <label for="id_verification_required"><%= gettext(\'ID Verification Required?\') %></label>\n\n        <div class="input-group">\n            <label class="radio-inline">\n                <input type="radio" name="id_verification_required" value="true"> Yes\n            </label>\n            <label class="radio-inline">\n                <input type="radio" name="id_verification_required" value="false"> No\n            </label>\n        </div>\n    </div>\n</div>\n';});define('views/course_seat_form_fields/professional_course_seat_form_field_view',['underscore','views/course_seat_form_fields/verified_course_seat_form_field_view','text!templates/professional_course_seat_form_field.html'],function(_,VerifiedCourseSeatFormFieldView,FieldTemplate){'use strict';return VerifiedCourseSeatFormFieldView.extend({certificateType:'professional',idVerificationRequired:false,seatType:'professional',template:_.template(FieldTemplate)});});define('text!templates/credit_course_seat_form_field_row.html',[],function(){return'<td class="credit-provider">\n    <div class="input-group">\n        <div class="input-group-addon">\n            <i class="fa fa-building-o" aria-hidden="true"></i>\n        </div>\n        <select class="form-control" id="credit_provider" name="credit_provider"\n                aria-labelledby="credit-provider-label">\n        </select>\n    </div>\n</td>\n<td class="price">\n    <div class="input-group">\n        <div class="input-group-addon">$</div>\n        <input type="number" class="form-control" id="price" name="price" aria-labelledby="price-label"\n            min="5" step="1" pattern="\\d+" value="<%= price %>">\n    </div>\n</td>\n<td class="credit-hours">\n    <div class="input-group">\n        <div class="input-group-addon">\n            <i class="fa fa-clock-o" aria-hidden="true"></i>\n        </div>\n        <input type="number" class="form-control" id="credit_hours" name="credit_hours"\n            aria-labelledby="credit-hours-label" min="0" step="1" pattern="\\d+">\n    </div>\n</td>\n<td class="expires">\n    <div class="input-group">\n        <div class="input-group-addon">\n            <i class="fa fa-calendar" aria-hidden="true"></i>\n        </div>\n        <input class="form-control add-pikaday" id="expires" name="expires"\n            aria-labelledby="expires-label">\n    </div>\n</td>\n<% if (isRemovable) { %>\n<td>\n    <button class="remove-seat btn btn-danger">\n        <span class="sr"><%= gettext(\'Delete course seat\') %></span>\n        <i class="fa fa-trash" aria-hidden="true"></i>\n    </button>\n</td>\n<% } %>\n';});define('views/course_seat_form_fields/credit_course_seat_form_field_row_view',['underscore','backbone','backbone.stickit','text!templates/credit_course_seat_form_field_row.html','ecommerce'],function(_,Backbone,BackboneStickit,CreditSeatTableRowTemplate,ecommerce){'use strict';return Backbone.View.extend({tagName:'tr',className:'course-seat',template:_.template(CreditSeatTableRowTemplate),events:{'click .remove-seat':'removeSeatTableRow'},bindings:{'select[name=credit_provider]':{observe:'credit_provider',selectOptions:{collection:function(){return ecommerce.credit.providers;},labelPath:'display_name',valuePath:'id',defaultOption:{label:'----',value:null}},setOptions:{validate:true}},'input[name=price]':{observe:'price',setOptions:{validate:true}},'input[name=credit_hours]':{observe:'credit_hours',setOptions:{validate:true}},'input[name=expires]':{observe:'expires',setOptions:{validate:true}}},initialize:function(options){this.course=options.course;this.isRemovable=options.isRemovable;},render:function(){var context=_.extend({},this.model.attributes,{isRemovable:this.isRemovable});this.$el.html(this.template(context));this.stickit();return this;},removeSeatTableRow:function(){this.course.get('products').remove(this.model);this.remove();}});});define('text!templates/credit_course_seat_form_field.html',[],function(){return'<div class="col-sm-12">\n    <div class="seat-type"><%= gettext(\'Credit\') %></div>\n</div>\n\n<div class="col-sm-4 col-sm-offset-4 seat-certificate-type">\n    <%= gettext(\'Verified Certificate\') %>\n</div>\n\n<div class="col-md-10">\n    <input type="hidden" name="certificate_type" value="credit">\n    <input type="hidden" name="id_verification_required" value="true">\n\n    <div class="form-group">\n        <table class="table table-striped credit-seats">\n            <thead>\n                <tr>\n                    <th id="credit-provider-label"><%= gettext(\'Credit Provider\') %></th>\n                    <th id="price-label"><%= gettext(\'Price (USD)\') %></th>\n                    <th id="credit-hours-label"><%= gettext(\'Credit Hours\') %></th>\n                    <th id="expires-label"><%= gettext(\'Upgrade Deadline\') %></th>\n                    <th>\n                        <button class="add-seat btn btn-primary">\n                            <span class="sr"><%= gettext(\'Add course seat\') %></span>\n                            <i class="fa fa-plus" aria-hidden="true"></i>\n                        </button>\n                    </th>\n                </tr>\n            </thead>\n            <tbody></tbody>\n        </table>\n        <!-- NOTE: This help-block is here for validation messages. -->\n        <span class="help-block" aria-live="polite"></span>\n    </div>\n</div>\n\n<div class="col-sm-4 seat-additional-info"></div>\n';});define('views/course_seat_form_fields/credit_course_seat_form_field_view',['underscore','views/course_seat_form_fields/course_seat_form_field_view','views/course_seat_form_fields/credit_course_seat_form_field_row_view','text!templates/credit_course_seat_form_field.html','utils/course_utils','utils/utils'],function(_,CourseSeatFormFieldView,CreditCourseSeatFormFieldRowView,FieldTemplate,CourseUtils,Utils){'use strict';return CourseSeatFormFieldView.extend({certificateType:'credit',idVerificationRequired:true,seatType:'credit',template:_.template(FieldTemplate),rowView:CreditCourseSeatFormFieldRowView,events:{'click .add-seat':'addSeatTableRow'},className:function(){return'row '+this.seatType;},initialize:function(options){this.course=options.course;Utils.bindValidation(this);},render:function(){this.renderSeatTable();return this;},renderSeatTable:function(){var row,$tableBody,rows=[];this.$el.html(this.template());$tableBody=this.$el.find('tbody');this.collection.each(function(seat){row=new this.rowView({model:seat,isRemovable:false,course:this.course});row.render();rows.push(row.el);},this);$tableBody.append(rows);return this;},addSeatTableRow:function(){var seatClass=CourseUtils.getCourseSeatModel(this.seatType),seat=new seatClass(),row=new this.rowView({model:seat,isRemovable:true,course:this.course}),$tableBody=this.$el.find('tbody');row.render();$tableBody.append(row.el);this.course.get('products').add(seat);}});});define('views/alert_view',['jquery','backbone','underscore'],function($,Backbone,_){'use strict';return Backbone.View.extend({className:'alert',template:_.template('<strong><%= title %></strong> <%= message %>'),initialize:function(options){this.level=options.level||'info';this.title=options.title||'';this.message=options.message||'';},render:function(){var body=this.template({title:this.title,message:this.message});this.$el.addClass('alert-'+this.level).attr('role','alert').html(body);return this;}});});define('utils/alert_utils',['jquery','underscore','views/alert_view'],function($,_,AlertView){'use strict';return{clearAlerts:function(context){_.each(context.alertViews,function(view){view.remove();});context.alertViews=[];return context;},renderAlert:function(level,title,message,context){var view=new AlertView({level:level,title:title,message:message});view.render();context.$alerts.append(view.el);context.alertViews.push(view);$('body').animate({scrollTop:context.$alerts.offset().top},500);context.$alerts.focus();return context;}};});define('views/form_view',['jquery','backbone','backbone.super','backbone.validation','underscore','underscore.string','utils/alert_utils','utils/utils'],function($,Backbone,BackboneSuper,BackboneValidation,_,_s,AlertUtils,Utils){'use strict';var FormView=Backbone.View.extend({tagName:'form',events:{submit:'submit'},updateWithPatch:true,initialize:function(){this.alertViews=[];if(this.editing&&_.has(this,'editableAttributes')){this.modelServerState=this.model.pick(this.editableAttributes);}
Utils.bindValidation(this);},remove:function(){Backbone.Validation.unbind(this);AlertUtils.clearAlerts(this);return this._super();},render:function(){this.$alerts=this.$el.find('.alerts');return this;},validateCourseID:function(){var self=this;var courseIdInput=self.$('input[name=id]');courseIdInput.focusout(function(){var courseId=courseIdInput.val();self.checkCourseAlreadyExist(courseId);});},checkCourseAlreadyExist:function(courseId){var courseIDFound=false,self=this,url='/api/v2/courses/'+courseId,redirectedUrl='/courses/'+courseId,html='<a href="'+redirectedUrl+'"> Click here to view the existing course</a>',message=gettext('A course with the specified ID already exists.'+html);$.ajax({url:url,method:'get',contentType:'application/json',async:false,success:function(data){if(data.id===courseId){AlertUtils.clearAlerts(self);AlertUtils.renderAlert('danger',gettext('Error!'),message,self);courseIDFound=true;}},error:function(response){if(response.status===404){AlertUtils.clearAlerts(self);}}});return courseIDFound;},goTo:function(fragment){Backbone.history.navigate(fragment,{trigger:true});},saveSuccess:function(model){this.goTo(model.id);},submit:function(e){var changedAttributes,editableAttributes,$buttons,$submitButton,btnDefaultText,self=this,courseId=$('input[name=id]').val(),btnSavingContent='<i class="fa fa-spinner fa-spin" aria-hidden="true"></i> '+
gettext('Saving...'),onSaveComplete,onSaveError;e.preventDefault();if(!this.model.isValid(true)){AlertUtils.clearAlerts(self);AlertUtils.renderAlert('danger','',gettext('Please complete all required fields.'),self);return undefined;}else if(courseId&&!self.editing&&self.checkCourseAlreadyExist(courseId)){return undefined;}
$buttons=this.$el.find('.form-actions .btn');$submitButton=$buttons.filter('button[type=submit]');btnDefaultText=$submitButton.text();$submitButton.html(btnSavingContent);$buttons.attr('disabled','disabled').addClass('disabled');onSaveComplete=function(){$submitButton.text(btnDefaultText);$buttons.removeAttr('disabled').removeClass('disabled');};onSaveError=function(model,response){var message=gettext('An error occurred while saving the data.');if(response.responseJSON&&response.responseJSON.error){message=response.responseJSON.error;console.error(message);}else{console.error(response.responseText);}
AlertUtils.clearAlerts(self);AlertUtils.renderAlert('danger',gettext('Error!'),message,self);};if(this.editing&&_.has(this,'editableAttributes')){editableAttributes=this.model.pick(this.editableAttributes);changedAttributes=_.omit(editableAttributes,function(value,key){return value===this.modelServerState[key];},this);this.model.save(changedAttributes,{complete:onSaveComplete,error:onSaveError,patch:this.updateWithPatch,success:this.saveSuccess.bind(this)});}else{this.model.save(null,{complete:onSaveComplete,success:this.saveSuccess.bind(this),error:onSaveError});}
return this;}});FormView.extend=function(child){var view=Backbone.View.extend.apply(this,arguments);view.prototype.events=_.extend({},this.prototype.events,child.events);return view;};return FormView;});define('views/course_form_view',['jquery','backbone','backbone.super','backbone.validation','backbone.stickit','moment','underscore','underscore.string','collections/product_collection','text!templates/_alert_div.html','text!templates/course_form.html','text!templates/_course_type_radio_field.html','views/course_seat_form_fields/audit_course_seat_form_field_view','views/course_seat_form_fields/verified_course_seat_form_field_view','views/course_seat_form_fields/professional_course_seat_form_field_view','views/course_seat_form_fields/credit_course_seat_form_field_view','views/form_view','utils/course_utils','utils/utils'],function($,Backbone,BackboneSuper,BackboneValidation,BackboneStickit,moment,_,_s,ProductCollection,AlertDivTemplate,CourseFormTemplate,CourseTypeRadioTemplate,AuditCourseSeatFormFieldView,VerifiedCourseSeatFormFieldView,ProfessionalCourseSeatFormFieldView,CreditCourseSeatFormFieldView,FormView,CourseUtils,Utils){'use strict';return FormView.extend({tagName:'form',className:'course-form-view',template:_.template(CourseFormTemplate),courseTypeRadioTemplate:_.template(CourseTypeRadioTemplate),courseTypes:{audit:{type:'audit',displayName:gettext('Free (Audit)'),helpText:gettext('Free audit track. No certificate.')},verified:{type:'verified',displayName:gettext('Verified'),helpText:gettext('Paid certificate track with initial verification and Verified Certificate')},professional:{type:'professional',displayName:gettext('Professional Education'),helpText:gettext('Paid certificate track with initial verification and Professional '+'Education Certificate')},credit:{type:'credit',displayName:gettext('Credit'),helpText:gettext('Paid certificate track with initial verification and Verified Certificate, '+'and option to purchase credit')}},courseSeatViewMappings:{audit:AuditCourseSeatFormFieldView,verified:VerifiedCourseSeatFormFieldView,professional:ProfessionalCourseSeatFormFieldView,credit:CreditCourseSeatFormFieldView},events:{submit:'submit'},bindings:{'input[name=name]':{observe:'name',setOptions:{validate:true}},'input[name=id]':{observe:'id',setOptions:{validate:true}},'input[name=type]':{observe:'type',setOptions:{validate:true}},'input[name=verification_deadline]':{observe:'verification_deadline',setOptions:{validate:true}},'input[name=honor_mode]':{observe:'honor_mode',setOptions:{validate:true},onSet:'cleanBooleanValue'}},initialize:function(options){this.courseSeatViews={};this.editing=options.editing||false;this.listenTo(this.model,'change:type',this.renderCourseSeats);this.listenTo(this.model,'change:type change:id_verification_required',this.renderVerificationDeadline);this.listenTo(this.model,'change:type change:honor_mode',this.renderHonorMode);this.listenTo(this.model,'change:id',this.validateCourseID);if(this.editing){this.setLockedCourseType();}
this._super();},remove:function(){_.each(this.courseSeatViews,function(view){view.remove();},this);this.courseSeatViews={};return this._super();},getActiveCourseTypes:function(){var activeCourseTypes,courseType=this.editing?this.lockedCourseType:this.model.get('type');switch(courseType){case'audit':activeCourseTypes=['audit','verified','credit'];break;case'verified':activeCourseTypes=['verified','credit'];break;case'professional':activeCourseTypes=['professional'];break;case'credit':activeCourseTypes=['credit'];break;default:activeCourseTypes=['audit','verified','professional','credit'];break;}
return activeCourseTypes;},setLockedCourseType:function(){this.lockedCourseType=this.model.get('type');},cleanBooleanValue:function(val){return _s.toBoolean(val);},render:function(){this.$el.html(this.template(this.model.attributes));this.renderCourseTypes();this.renderCourseSeats();this.renderVerificationDeadline();this.renderHonorMode();this.disableHonorMode();this.$('.fields:first').before(AlertDivTemplate);this.stickit();this._super();return this;},renderCourseTypes:function(){var $courseTypesContainer,html='',activeCourseTypes=this.getActiveCourseTypes();$courseTypesContainer=this.$el.find('.course-types');_.each(this.courseTypes,function(data,courseType){data.disabled=!_.contains(activeCourseTypes,courseType);data.checked=(this.model.get('type')===courseType);html+=this.courseTypeRadioTemplate(data);},this);$courseTypesContainer.html(html);this.delegateEvents();return this;},renderVerificationDeadline:function(){var $verificationDeadline=this.$el.find('.verification-deadline');$verificationDeadline.toggleClass('hidden',!this.model.isIdVerified());return this;},renderHonorMode:function(){var $honorModeContainer=this.$el.find('.honor-mode');$honorModeContainer.toggleClass('hidden',!this.model.includeHonorMode());return this;},disableHonorMode:function(){var $honorModeRadioButtons=this.$el.find('input[name=honor_mode]');if(this.model.seats().length>0){$honorModeRadioButtons.attr('disabled',true);}},renderCourseSeats:function(){var $courseSeats,$courseSeatsContainer=this.$el.find('.course-seats'),activeSeats=this.model.activeSeatTypes();if(activeSeats.length<1){activeSeats=['empty'];}else{_.each(CourseUtils.orderSeatTypesForDisplay(activeSeats),function(seatType){var seats,viewClass,view=this.courseSeatViews[seatType];if(!view){seats=this.model.getOrCreateSeats(seatType);viewClass=this.courseSeatViewMappings[seatType];if(viewClass&&seats.length>0){if(_.isEqual(seatType,'credit')){seats=new ProductCollection(seats);view=new viewClass({collection:seats,course:this.model});}else{view=new viewClass({model:seats[0]});}
this.$el.find('.course-seat.empty').addClass('hidden');view.render();this.courseSeatViews[seatType]=view;$courseSeatsContainer.append(view.el);}}},this);}
$courseSeats=$courseSeatsContainer.find('.row');$courseSeats.hide();_.each(activeSeats,function(seat){$courseSeats.filter('.'+seat).show();});Utils.addDatePicker(this);return this;}});});define('text!templates/course_create_edit.html',[],function(){return'<div class="container">\n    <ol class="breadcrumb">\n        <li><a href="/courses/"><%= gettext(\'Courses\') %></a></li>\n        <% if(editing){ %>\n            <li><a href="/courses/<%= id %>/"><%= name %></a></li>\n            <li class="active"><%= gettext(\'Edit\') %></li>\n        <% } else { %>\n            <li class="active"><%= gettext(\'Create\') %></li>\n        <% } %>\n    </ol>\n    <div class="page-header">\n        <h1 class="hd-1 emphasized">\n            <%= gettext(editing ? \'Edit Course\' : \'Create New Course\') %>\n        </h1>\n    </div>\n\n    <div class="course-form-outer"></div>\n</div>\n';});define('views/course_create_edit_view',['jquery','backbone','backbone.super','underscore','views/course_form_view','text!templates/course_create_edit.html','bootstrap'],function($,Backbone,BackboneSuper,_,CourseFormView,CourseCreateEditTemplate){'use strict';return Backbone.View.extend({template:_.template(CourseCreateEditTemplate),className:'course-create-edit-view',initialize:function(options){this.editing=options.editing;},remove:function(){if(this.formView){this.formView.remove();this.formView=null;}
this._super();},render:function(){var $html,data=this.model.attributes;this.formView=this.formView||new CourseFormView({editing:this.editing,model:this.model});data.editing=this.editing;$html=$(this.template(data));this.formView.render();$html.find('.course-form-outer').html(this.formView.el);this.$el.html($html);this.$el.find('[data-toggle="tooltip"]').tooltip();return this;}});});define('pages/course_create_page',['models/course_model','views/course_create_edit_view','pages/page'],function(Course,CourseCreateEditView,Page){'use strict';return Page.extend({title:gettext('Create New Course'),initialize:function(){this.model=new Course({});this.view=new CourseCreateEditView({model:this.model});this.render();}});});define('pages/course_edit_page',['models/course_model','pages/page','views/course_create_edit_view'],function(Course,Page,CourseCreateEditView){'use strict';return Page.extend({title:function(){return this.model.get('name')+' - '+gettext('Edit Course');},initialize:function(options){this.model=Course.findOrCreate({id:options.id});this.view=new CourseCreateEditView({editing:true,model:this.model});this.listenTo(this.model,'sync',this.render);this.model.fetch({data:{include_products:true}});}});});define('routers/course_router',['backbone','routers/page_router','pages/course_list_page','pages/course_detail_page','pages/course_create_page','pages/course_edit_page','underscore'],function(Backbone,PageRouter,CourseListPage,CourseDetailPage,CourseCreatePage,CourseEditPage,_){'use strict';return PageRouter.extend({currentView:null,root:'/courses/',routes:{'(/)':'index','new(/)':'new','*path':'notFound'},initialize:function(options){var courseIdRegex=/([^/+]+(\/|\+)[^/+]+(\/|\+)[^/]+)/;this.$el=options.$el;this.route(new RegExp('^'+courseIdRegex.source+'(/)?$'),'show');this.route(new RegExp('^'+courseIdRegex.source+'/edit(/)?$'),'edit');},index:function(){var page=new CourseListPage();this.currentView=page;this.$el.html(page.el);},show:function(id){var page=new CourseDetailPage({id:id});this.currentView=page;this.$el.html(page.el);},new:function(){var page;_.each(Backbone.Relational.store._collections,function(collection){collection.reset();});page=new CourseCreatePage();this.currentView=page;this.$el.html(page.el);},edit:function(id){var page=new CourseEditPage({id:id});this.currentView=page;this.$el.html(page.el);}});});define('models/credit_provider',['backbone'],function(Backbone){'use strict';return Backbone.Model.extend({});});define('collections/credit_provider_collection',['backbone','underscore.string','models/credit_provider'],function(Backbone,_s,CreditProvider){'use strict';return Backbone.Collection.extend({model:CreditProvider,initialize:function(options){if(options){this.lmsRootUrl=options.lmsRootUrl;this.providerIds=options.providerIds;}},url:function(){var data={root:this.lmsRootUrl,providerIds:this.providerIds};return _s.sprintf('%(root)s/api/credit/v1/providers/?provider_ids=%(providerIds)s',data);}});});define('utils/navigate',['backbone'],function(Backbone){'use strict';return function(event){var url=$(this).attr('href').replace(Backbone.history.root,'');if(event.ctrlKey||event.shiftKey||event.metaKey||event.which===2){return true;}
event.preventDefault();if(url===Backbone.history.getFragment()&&url===''){Backbone.history.loadUrl(url);}else{Backbone.history.navigate(url,{trigger:true});}
return undefined;};});require(['backbone','routers/course_router','collections/credit_provider_collection','ecommerce','utils/navigate'],function(Backbone,CourseRouter,CreditProviderCollection,ecommerce,navigate){'use strict';$(function(){var $app=$('#app'),courseApp=new CourseRouter({$el:$app});ecommerce.credit=ecommerce.credit||{};ecommerce.credit.providers=new CreditProviderCollection($app.data('credit-providers'));courseApp.start();$('a.navbar-brand').on('click',navigate);$app.on('click','a',navigate);});});define("js/apps/course_admin_app",function(){});